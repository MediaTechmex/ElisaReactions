/*! @castlabs/prestoplay 5.1.2, 15-11-2017 Copyright (c) 2017 castLabs GmbH, All Rights reserved */

(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory(require("clpp"));else if(typeof define==="function"&&define.amd)define(["clpp"],factory);else if(typeof exports==="object")exports["clpp_conviva"]=factory(require("clpp"));else root["clpp_conviva"]=factory(root["clpp"])})(this,function(__WEBPACK_EXTERNAL_MODULE_1__){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="/";return __webpack_require__(0)}([function(module,exports,__webpack_require__){__webpack_require__(1);var G=__webpack_require__(3);if(!G.w.Conviva){G.w.Conviva=__webpack_require__(19)}module.exports=__webpack_require__(20)},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_1__},,function(module,exports,__webpack_require__){var name="__castlabs";if(typeof window[name]==="undefined"){window[name]={};window[name].w=window;window[name].shaka=window.shaka;window[name].videojs=window.videojs;window[name].error=__webpack_require__(4);var Errors=__webpack_require__(18);window[name].errors=new Errors;var plugins=window[name].plugins={};window[name].definePlugin=function(namespace,plugin){plugins[namespace]=plugin}}module.exports=window[name]},function(module,exports,__webpack_require__){var severities=__webpack_require__(5);var utilGeneral=__webpack_require__(6);var logger=__webpack_require__(8);exports.convert=function convert(error,techName){var G,convertErrorFromHLSPlugin,convertErrorFromShaka,convertErrorFromSLPlugin,convertErrorFromUnknown,convertErrorFromXMLHttpRequest;if(error&&error.instanceof!=="CLPPError"){G=__webpack_require__(3);convertErrorFromHLSPlugin=__webpack_require__(9);convertErrorFromShaka=__webpack_require__(14);convertErrorFromSLPlugin=__webpack_require__(15);convertErrorFromUnknown=__webpack_require__(16);convertErrorFromXMLHttpRequest=__webpack_require__(17);if(utilGeneral.getSafeValue(error,"detail")instanceof G.shaka.util.Error){error=error.detail}if(error instanceof G.shaka.util.Error){error=convertErrorFromShaka(error,techName)}else if(typeof error.sl_type!=="undefined"){error=convertErrorFromSLPlugin(error,techName)}else if(error.type&&G.hlsjs&&Object.values(G.hlsjs.ErrorTypes).indexOf(error.type>=0)){error=convertErrorFromHLSPlugin(error,techName)}else if(G.w.XMLHttpRequestProgressEvent&&error instanceof G.w.XMLHttpRequestProgressEvent){error=convertErrorFromXMLHttpRequest(error,techName)}else{error=convertErrorFromUnknown(error,techName)}}return error};exports.markProcess=function markProcess(error){error.processed=true;return error};exports.process=function process(proxyPlayerOrTech,error,eventBus){if(error.severity===severities.FATAL){eventBus.trigger(eventBus.EVENTS.ANALYTICS.FORCE_DESTROY)}else{eventBus.trigger(eventBus.EVENTS.ANALYTICS.VIDEO_ERROR,error)}if(proxyPlayerOrTech&&proxyPlayerOrTech.el_){proxyPlayerOrTech.trigger("error",error)}else{logger.error(error.message,error)}};exports.raise=function raise(tech,error,params,originalError,replaceParams){var errors,msg;if(arguments.length<4){throw"wrong number of arguments"}errors=__webpack_require__(11);params=params||{};msg=params.msg;if(typeof error==="number"){error=errors.findErrorByCode(error)}else if(typeof error==="string"){error=errors.findErrorByName(error)}if(!error){if(false){console.error("Specified error not found",error,msg)}error=errors.getDefaultError()}error=error.clone();if(typeof msg!=="undefined"){error.message=msg}if(typeof params.url==="string"){error.setUrl(params.url)}if(typeof originalError!=="undefined"){error.setOriginalError(originalError)}if(replaceParams){msg=error.message_;for(var key in replaceParams){if(replaceParams.hasOwnProperty(key)){var reg=new RegExp("{"+key+"}","g");msg=msg.replace(reg,replaceParams[key])}}error.message=msg}if(error.severity===severities.FATAL){throw error}else if(!tech){throw error}else{tech.error(error)}};exports.severities=severities},function(module,exports){var severities=Object.freeze({ERROR:"ERROR",FATAL:"FATAL",WARNING:"WARNING"});module.exports=severities},function(module,exports,__webpack_require__){var G=__webpack_require__(3);var buildLocationFromString=__webpack_require__(7)._buildLocationFromString;var MAX_MERGE_LEVEL=5;var THROTTLIFY_COUNTER=0;function calculatePercentPosition(value,min,max){var percentPosition=(value-min)/(max-min);percentPosition=Math.max(0,Math.min(1,percentPosition));return percentPosition}function cloneJson(json){var newJson={};var copiedTypes=["string","number","boolean"];var typeOf;for(var key in json){typeOf=typeof json[key];if(copiedTypes.indexOf(typeOf)>=0){newJson[key]=json[key]}}return newJson}function cloneItem(item){var clonedItem;if(typeof item!=="undefined"&&item!==null&&typeof item!=="string"&&typeof item!=="number"&&typeof item!=="boolean"){clonedItem=merge(item)}else{clonedItem=item}return clonedItem}function errorThatCannotBeRecovered(err,manifestUri){var url1,url2;err=err||{};if(err.instanceof==="CLPPError"){url1=buildLocationFromString(err.url);url2=buildLocationFromString(manifestUri);if(url1.href===url2.href){return true}return false}var data=err.data||[];if(err.canBeRecovered){return false}if(data.length>0){url1=buildLocationFromString(data[0]);url2=buildLocationFromString(manifestUri);if(url1.href===url2.href){return true}}return false}function formatTime(seconds){seconds=seconds<0?0:seconds;var s=Math.floor(seconds%60);var m=Math.floor(seconds/60%60);var h=Math.floor(seconds/3600);if(isNaN(seconds)||seconds===Infinity){h=m=s="-"}else{h=h<10?"0"+h:h;m=m<10?"0"+m:m;s=s<10?"0"+s:s}return h+":"+m+":"+s}function getValue(valueName){var value,returnedValue;function extractValue(obj,name){if(typeof obj==="object"){return obj[name]}return obj}for(var i=1,j=arguments.length;i<j;i++){value=extractValue(arguments[i],valueName);if(typeof value!=="undefined"&&value!==null&&value!==""){if(typeof value!=="object"){returnedValue=value;break}else{returnedValue=G.videojs.mergeOptions({},returnedValue,value)}}else if(value===""){returnedValue=value}else if(typeof returnedValue!=="undefined"&&value===null){returnedValue=null}}return returnedValue}function getSafeValue(obj,values){var arr=[];if(values){arr=values.split(".")}function extractValue(obj,arr){var el=arr.shift();if(typeof obj!=="undefined"&&obj!==null&&typeof el!=="undefined"&&el!==null){return extractValue(obj[el],arr)}return obj}return extractValue(obj,arr)}function merge(){var i,j,merged;merged={};for(i=0,j=arguments.length;i<j;i++){merged=_mergeOptionsBetweenTwoItems(merged,{merging:arguments[i]})}return merged.merging}function _mergeOptionsBetweenTwoItems(firstItem,secondItem,level){var item;level=level||0;level++;if(typeof firstItem==="undefined"||firstItem===null||typeof firstItem!=="object"){firstItem={}}for(var key in secondItem){if(secondItem.hasOwnProperty(key)){item=secondItem[key];if(typeof item==="string"||typeof item==="number"||typeof item==="boolean"||item===null||typeof item==="function"){firstItem[key]=item}else if(typeof item==="object"&&item.buffer&&item.buffer instanceof ArrayBuffer&&typeof item.subarray==="function"){firstItem[key]=item.subarray(0)}else if(item instanceof Array){firstItem[key]=_mergeOptionsBetweenTwoItems([],item)}else if(typeof item!=="undefined"&&typeof item==="object"&&item!==null){if(level>=MAX_MERGE_LEVEL){firstItem[key]=G.videojs.mergeOptions({},firstItem[key],item)}else{if(item.constructor&&item.constructor.name&&(item.constructor.name==="Object"||!item.constructor.name)){firstItem[key]=_mergeOptionsBetweenTwoItems(firstItem[key],item,level)}else{firstItem[key]=G.videojs.mergeOptions({},firstItem[key],item)}}}}}return firstItem}function objectsAreDifferentByKeys(keys,obj1,obj2){obj1=obj1||{};obj2=obj2||{};if(arguments.length===2){obj2=obj1;obj1=keys;obj1=obj1||{};keys=Object.keys(obj1);if(keys.length!==Object.keys(obj2).length){return true}}return keys.some(function(key){if(obj1[key]!==obj2[key]){return true}})}function setValue(values,valueName){values[valueName]=getValue.apply(null,Array.apply(null,arguments).slice(1))}function uniqueArrayOfObjectsByKeys(array,keys){array=(array||[]).slice();if(typeof keys==="undefined"){keys=Object.keys(array[0]).sort()}else if(typeof keys==="string"){keys=[keys]}function sortByValue(obj,keys){var value="";keys.forEach(function(key){value+=String(typeof obj[key]!=="undefined"?obj[key]:"")+"_"});return value}array.sort(function(a,b){var valA=sortByValue(a,keys);var valB=sortByValue(b,keys);if(valA>valB){return 1}else if(valA<valB){return-1}return 0});for(var i=array.length-1;i>0;i--){if(!objectsAreDifferentByKeys(keys,array[i],array[i-1])){array.splice(i,1)}}return array}function isAutoPlayBlocked(err){err=err||{};if(isActionNotAllowedWithoutUserClick(err)){if(err.stack&&err.stack.indexOf("play")===0){return true}}return false}function isActionNotAllowedWithoutUserClick(err){err=err||{};return err.name==="NotAllowedError"}function silencePromise(playPromise){if(playPromise&&typeof Promise!=="undefined"&&playPromise instanceof Promise&&typeof playPromise.catch==="function"){playPromise.catch(function(err){if(false){console.log("Caught promise exception - continuing",err,'You see this message only in "DEV" mode')}})}return playPromise}function throttlify(scope,originalCallback,timeMS){THROTTLIFY_COUNTER++;var originalCallbackKey=originalCallback.name;var hashTimer=originalCallbackKey+"_bvzmakjsdah87392adjakhskdja_"+THROTTLIFY_COUNTER;scope[originalCallbackKey]=function(){var args=arguments;if(scope[hashTimer]){clearTimeout(scope[hashTimer])}scope[hashTimer]=setTimeout(function(){scope[hashTimer]=null;originalCallback.apply(scope,args)},timeMS)}}function throttlifyAll(scope,originalCallback,timeMS){if(originalCallback instanceof Array){var i,j;for(i=0,j=originalCallback.length;i<j;i++){throttlify(scope,originalCallback[i],timeMS)}}else{throttlify(scope,originalCallback,timeMS)}}exports.calculatePercentPosition=calculatePercentPosition;exports.errorThatCannotBeRecovered=errorThatCannotBeRecovered;exports.cloneItem=cloneItem;exports.cloneJson=cloneJson;exports.formatTime=formatTime;exports.getValue=getValue;exports.getSafeValue=getSafeValue;exports.isAutoPlayBlocked=isAutoPlayBlocked;exports.merge=merge;exports.objectsAreDifferentByKeys=objectsAreDifferentByKeys;exports.setValue=setValue;exports.silencePromise=silencePromise;exports.throttlify=throttlifyAll;exports.uniqueArrayOfObjectsByKeys=uniqueArrayOfObjectsByKeys},function(module,exports){var anchor=document.createElement("a");exports._buildLocationFromString=function(uri){anchor.href=uri;return{href:anchor.href,protocol:anchor.protocol,host:anchor.host,hostname:anchor.hostname,port:anchor.port,pathname:anchor.pathname,search:anchor.search,hash:anchor.hash,origin:anchor.origin}}},function(module,exports,__webpack_require__){var Level={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4};var globalLogLevel=Level.INFO;if(false){globalLogLevel=Level.DEBUG}var REGISTRY={};function registerTag(tag){if(!REGISTRY.hasOwnProperty(tag)){REGISTRY[tag]=-1}}function getTagLevel(tag){if(tag){var current=tag;while(current){if(REGISTRY.hasOwnProperty(current)){if(REGISTRY[current]>=0){return REGISTRY[current]}}var idx=current.lastIndexOf(".");if(idx<0){current=null}else{current=current.substr(0,idx)}}}return globalLogLevel}function setTagLevel(tag,level){if(tag){REGISTRY[tag]=level}}function setLogLevel(level){globalLogLevel=level}function getLogLevel(){return globalLogLevel}function Logger(tag){this.tag=tag;if(tag){registerTag(tag)}}Logger.prototype.log=function(level,message){if(!window.console){return}var logLevel=level;if(arguments.length>1){logLevel=arguments[0];Array.prototype.shift.call(arguments)}else{logLevel=Level.INFO}var localLevel=getTagLevel(this.tag);if(localLevel>=0){if(localLevel<logLevel){return}}else{if(globalLogLevel<logLevel){return}}if(this.tag){Array.prototype.unshift.call(arguments,"["+this.tag+"]")}if(logLevel===Level.DEBUG){console.log.apply(console,arguments)}else if(logLevel===Level.INFO){console.info.apply(console,arguments)}else if(logLevel===Level.WARNING){console.warn.apply(console,arguments)}else if(logLevel===Level.ERROR){console.error.apply(console,arguments)}else{console.log.apply(console,arguments)}};Logger.prototype.info=function(message){Array.prototype.unshift.call(arguments,Level.INFO);this.log.apply(this,arguments)};Logger.prototype.debug=function(message){Array.prototype.unshift.call(arguments,Level.DEBUG);this.log.apply(this,arguments)};Logger.prototype.warn=function(message){Array.prototype.unshift.call(arguments,Level.WARNING);this.log.apply(this,arguments)};Logger.prototype.error=function(message){Array.prototype.unshift.call(arguments,Level.ERROR);this.log.apply(this,arguments)};Logger.prototype.createChild=function(tag){if(!tag){return this}if(!this.tag){return new Logger(tag)}else{return new Logger(this.tag+"."+tag)}};var globalLogger=new Logger("clpp");module.exports={Level:Level,Logger:Logger,setTagLevel:setTagLevel,getTagLevel:getTagLevel,setLogLevel:setLogLevel,getLogLevel:getLogLevel,info:globalLogger.info.bind(globalLogger),debug:globalLogger.debug.bind(globalLogger),warn:globalLogger.warn.bind(globalLogger),error:globalLogger.error.bind(globalLogger)}},function(module,exports,__webpack_require__){var defaultConverter=__webpack_require__(10);var G=__webpack_require__(3);var buildLocation=__webpack_require__(7)._buildLocationFromString;var utilGeneral=__webpack_require__(6);function convert(hlsError,namespace){hlsError=hlsError||{};var params={tech:namespace};var hlsType=hlsError.type;var details=hlsError.details;var error;var errorName;params.url=utilGeneral.getSafeValue(hlsError,"context.url");if(!params.url){params.url=utilGeneral.getSafeValue(hlsError,"frag._url")}if(params.url){params.url=buildLocation(params.url).href}params.httpStatusCode=utilGeneral.getSafeValue(hlsError,"response.code");var mappings={};mappings[G.hlsjs.ErrorDetails.MANIFEST_LOAD_TIMEOUT]="NETWORK.TIMEOUT";mappings[G.hlsjs.ErrorDetails.MANIFEST_LOAD_ERROR]="MANIFEST.LOAD_ERROR";mappings[G.hlsjs.ErrorDetails.MANIFEST_PARSING_ERROR]="MANIFEST.PARSING_ERROR";errorName=mappings[details];if(!errorName){mappings={};mappings[G.hlsjs.ErrorTypes.NETWORK_ERROR]="NETWORK.HTTP_ERROR";mappings[G.hlsjs.ErrorTypes.MEDIA_ERROR]="MEDIA.VIDEO_ERROR";errorName=mappings[hlsType]}error=defaultConverter(errorName,hlsError,params);if(hlsType===G.hlsjs.ErrorTypes.MEDIA_ERROR){if(details===G.hlsjs.ErrorDetails.BUFFER_STALLED_ERROR||details===G.hlsjs.ErrorDetails.BUFFER_SEEK_OVER_HOLE){if(false){console.log("ignoring error",error)}error=undefined}}return error}module.exports=convert},function(module,exports,__webpack_require__){var errors=__webpack_require__(11);function defaultConverter(errorName,originalError,params){var error;params=params||{};if(typeof errorName==="number"){error=errors.findErrorByCode(errorName)}else if(errorName){error=errors.findErrorByName(errorName)}if(!error){error=errors.getDefaultError()}var newError=error.clone();newError.setOriginalError(originalError);if(params.msg){newError.setParentError(params.msg)}if(params.url){newError.setUrl(params.url)}if(params.httpStatusCode){newError.setHttpStatusCode(params.httpStatusCode)}if(params.tech){newError.setTech(params.tech)}return newError}module.exports=defaultConverter},function(module,exports,__webpack_require__){var Group=__webpack_require__(12);var CLPPError=__webpack_require__(13);var G=__webpack_require__(3);var utilGeneral=__webpack_require__(6);exports.DEFAULT_ERROR_CODE=-1;exports.DEFAULT_ERROR_NAME="UNKNOWN.UNKNOWN";exports.addError=function(name,errCode,msg,severity){var group=exports.getGroup(errCode);if(!group){throw"group for this error doesn't exists "+errCode}var error=new CLPPError(group,name,errCode,msg,severity);var errorName=group.name+"."+error.name;G.errors[group.name][error.name]=error;G.errors.errorsByCode[error.errCode]=errorName;return error};exports.addGroup=function(name,from,to){var group=new Group(name,from,to);var errors=hasErrors(group);if(!errors){G.errors[group.name]={};G.errors.groups[group.name]=group}else{throw errors}return group};exports.findErrorByCode=function(errCode){var errorName=G.errors.errorsByCode[errCode];return exports.findErrorByName(errorName)};exports.findErrorByName=function(errorName){var error=errorName&&utilGeneral.getSafeValue(G.errors,errorName);return error};exports.getDefaultError=function(){return exports.findErrorByName(exports.DEFAULT_ERROR_NAME)};exports.getGroup=function(errCode){var group,key;for(key in G.errors.groups){if(G.errors.groups.hasOwnProperty(key)){group=G.errors.groups[key];if(errCode>=group.from&&errCode<=group.to){return group}}}};function hasErrors(newGroup){var key,group;if(G.errors.groups[newGroup.name]){return"group error already exists"}for(key in G.errors.groups){if(G.errors.groups.hasOwnProperty(key)){group=G.errors.groups[key];if(newGroup.from>=group.from&&newGroup.from<=group.to){return"group with this codes already exists"}if(newGroup.to>=group.from&&newGroup.from<=group.to){return"group with this codes already exists"}if(newGroup.to>=group.from&&newGroup.to<=group.to){return"group with this codes already exists"}}}return false}},function(module,exports){function Group(name,from,to){this.name=name;this.from=from;this.to=to}module.exports=Group},function(module,exports,__webpack_require__){var severities=__webpack_require__(5);var mediaErrors={MEDIA_ERR_ABORTED:1,MEDIA_ERR_CUSTOM:0,MEDIA_ERR_DECODE:3,MEDIA_ERR_ENCRYPTED:5,MEDIA_ERR_NETWORK:2,MEDIA_ERR_SRC_NOT_SUPPORTED:4};function CLPPError(group,name,errCode,msg,severity){var code=mediaErrors.MEDIA_ERR_CUSTOM;if(group.name==="NETWORK"||group.name==="MANIFEST"&&name==="LOAD_ERROR"||group.name==="STREAMING"){code=mediaErrors.MEDIA_ERR_NETWORK}else if(name==="ENCRYPTED_CONTENT_WITHOUT_DRM_INFO"){code=mediaErrors.MEDIA_ERR_ENCRYPTED}else if(name==="UNABLE_TO_GUESS_MANIFEST_TYPE"){code=mediaErrors.MEDIA_ERR_SRC_NOT_SUPPORTED}this.code=code;this.instanceof="CLPPError";if(!severity){severity=severities.ERROR}this.message_="";this.group=group;this.name=name;this.errCode=errCode;this.message=msg;this.severity=severity;this.parentError={};this.ts=null;this.processed=false}CLPPError.prototype._getHelpUrl=function(){var baseUrl="https://prestodoc.castlabs.com";return baseUrl+"?errCode="+this.errCode};Object.defineProperty(CLPPError.prototype,"message",{get:function(){var msg="player error: category "+this.group.name+", errCode: "+this.errCode;if(this.url){msg+=", url: "+this.url}if(this.message_){msg+=", with message: "+this.message_}return msg},set:function(message){if(typeof message==="undefined"){message=""}this.message_=message}});CLPPError.prototype.clone=function(){var error=new CLPPError(this.group,this.name,this.errCode,this.message_,this.severity);error.ts=(new Date).getTime();return error};CLPPError.prototype.setOriginalError=function(originalError){this.originalError=originalError};CLPPError.prototype.setParentError=function(msg){var parentError={columnNumber:null,lineNumber:null,fileName:null};Error.call(parentError,msg);this.parentError=parentError};CLPPError.prototype.setTech=function(tech){this.tech=tech};CLPPError.prototype.setUrl=function(url){this.url=url};CLPPError.prototype.setHttpStatusCode=function(httpStatusCode){this.httpStatusCode=httpStatusCode};CLPPError.constructor=CLPPError;module.exports=CLPPError},function(module,exports,__webpack_require__){var defaultConverter=__webpack_require__(10);var buildLocation=__webpack_require__(7)._buildLocationFromString;var BAD_HTTP_STATUS_ERROR=1001;var URI_INDEX=0;var STATUS_CODE_INDEX=1;function convert(shakaError,namespace){shakaError=shakaError||{};var params={tech:namespace};var error;var errorName=shakaError.code;var shakaData=shakaError.data||[];var url=shakaData[URI_INDEX];if(typeof url==="string"){params.url=buildLocation(url).href}if(errorName===BAD_HTTP_STATUS_ERROR){params.httpStatusCode=shakaData[STATUS_CODE_INDEX]}error=defaultConverter(errorName,shakaError,params);return error}module.exports=convert},function(module,exports,__webpack_require__){var defaultConverter=__webpack_require__(10);var buildLocation=__webpack_require__(7)._buildLocationFromString;var slTypes={TYPE_UNKNOWN:0,TYPE_WEB_EXCEPTION:100,TYPE_DRM_EXCEPTION:200};function convert(silverlightError,namespace){silverlightError=silverlightError||{};var params={tech:namespace};var sl_type=silverlightError.sl_type;var sl_message=silverlightError.sl_message;var errorName;var sl_code;var mappings={};if(sl_type===slTypes.TYPE_UNKNOWN){sl_code=/(\d+)/g.exec(sl_message)[1];mappings={};mappings[3222]="MANIFEST.LOAD_ERROR";mappings[3050]="STREAMING.FAILED_TO_DOWNLOAD";errorName=mappings[sl_code]}else if(sl_type===slTypes.TYPE_WEB_EXCEPTION){errorName="NETWORK.HTTP_ERROR";params.httpStatusCode=silverlightError.sl_status_code}else if(sl_type===slTypes.TYPE_DRM_EXCEPTION){errorName="DRM.LICENSE_REQUEST_FAILED";params.httpStatusCode=silverlightError.sl_status_code}var error;params.url=silverlightError.url;if(params.url){params.url=buildLocation(params.url).href}error=defaultConverter(errorName,silverlightError,params);return error}module.exports=convert},function(module,exports,__webpack_require__){var defaultConverter=__webpack_require__(10);function convert(unknownError,namespace){unknownError=unknownError||{};var params={tech:namespace};var error;var errorName;params.msg=unknownError.message||unknownError.description;error=defaultConverter(errorName,unknownError,params);return error}module.exports=convert},function(module,exports,__webpack_require__){var defaultConverter=__webpack_require__(10);var buildLocation=__webpack_require__(7)._buildLocationFromString;function convert(xmlHttpRequestProgressEvent,namespace){var params={tech:namespace};var error;var errorName;error=xmlHttpRequestProgressEvent.currentTarget||xmlHttpRequestProgressEvent.target;errorName="NETWORK.HTTP_ERROR";params.httpStatusCode=error.status;params.msg=error.statusText;params.url=buildLocation(error.responseURL).href;error=defaultConverter(errorName,xmlHttpRequestProgressEvent,params);return error}module.exports=convert},function(module,exports){module.exports=function Errors(){this.groups={};this.errorsByCode={}}},function(module,exports){/*! (C) 2016 Conviva, Inc. All rights reserved. Confidential and proprietary. */
var Conviva=Conviva||{};(Conviva.r=function(){"use strict";if("undefined"==typeof Conviva.PrivateLoader){var a=Conviva.PrivateLoader={};!function(){var b=a.Client=function(a,f){function h(a,b){if(!(a instanceof c))throw new Error("clientSettings parameter should be an instance of ClientSettings.");if(!(b instanceof e))throw new Error("systemFactory parameter should be an instance of SystemFactory.");this._settings=a.clone(),this._systemFactory=b,this._systemFactory.configure("SDK",this._settings),this._exceptionCatcher=this._systemFactory.buildExceptionCatcher(),this._exceptionCatcher.runProtected("Client.init",function(){i._id=E.uinteger32(),i._logger=i._systemFactory.buildLogger(),i._logger.setModuleName("Client"),i._logger.info("init(): url="+i._settings.gatewayUrl+" customerKey="+i._settings.customerKey),i._config=i._systemFactory.buildConfig(),i._config.load(),i._sessionFactory=i._systemFactory.buildSessionFactory(i,i._settings,i._config),i._logger.info("init(): done.")},function(a){throw new Error("Client constructor failed: "+a.message)})}var i=this;this._logger=null,this._sessionFactory=null,this._systemFactory=null,this._globalSessionKey=-1,this._settings=null,this._systemSettings=null,this._exceptionCatcher=null,this._config=null,this._id=-1,this._released=!1,h.apply(this,arguments),this.release=function(){this._released||this._exceptionCatcher.runProtected("Client.release",function(){i._logger.info("release()"),i._sessionFactory.cleanup(),i._sessionFactory=null,i._globalSessionKey=-1,i._logger=null,i._id=-1,i._exceptionCatcher=null,i._settings=null,i._systemSettings=null,i._systemFactory=null,i._released=!0})},this.createSession=function(a){var c=b.NO_SESSION_KEY;return this._released?c:null==a||a instanceof d?(this._exceptionCatcher.runProtected("Client.createSession",function(){c=i._sessionFactory.makeVideoSession(a)}),c):(i._logger.error("createSession(): expecting an instance of ContentMetadata for contentMetadata parameter"),c)},this.reportError=function(a,b,c){return this._released?void 0:B.isValidString(b)?c!==Conviva.Client.ErrorSeverity.FATAL&&c!==Conviva.Client.ErrorSeverity.WARNING?void this._logger.error("reportError(): invalid error severity: "+c):void this._exceptionCatcher.runProtected("Client.reportError",function(){var d=i._sessionFactory.getVideoSession(a);null!=d&&d.reportError(b,c)}):void this._logger.error("reportError(): invalid error message string: "+b)},this.updateContentMetadata=function(a,b){return this._released?void 0:b instanceof d?void this._exceptionCatcher.runProtected("Client.updateContentMetadata",function(){var c=i._sessionFactory.getVideoSession(a);if(null!=c){var d=b.clone();c.updateContentMetadata(d)}}):void i._logger.error("updateContentMetadata(): expecting an instance of ContentMetadata for contentMetadata parameter")},this.detachPlayer=function(a){this._released||this._exceptionCatcher.runProtected("Client.detachPlayer",function(){var b=i._sessionFactory.getVideoSession(a);null!=b&&b.detachPlayer()})},this.attachPlayer=function(a,b){return this._released?void 0:b instanceof g?void this._exceptionCatcher.runProtected("Client.attachPlayer",function(){var c=i._sessionFactory.getVideoSession(a);null!=c&&c.attachPlayer(b)}):void i._logger.error("attachPlayer(): expecting an instance of PlayerStateManager for playerStateManager parameter")},this.contentPreload=function(a){this._released||this._exceptionCatcher.runProtected("Client.contentPreload",function(){var b=i._sessionFactory.getVideoSession(a);null!=b&&b.contentPreload()})},this.contentStart=function(a){this._released||this._exceptionCatcher.runProtected("Client.contentStart",function(){var b=i._sessionFactory.getVideoSession(a);null!=b&&b.contentStart()})},this.sendCustomEvent=function(a,c,e){return this._released?void 0:B.isValidString(c)?void this._exceptionCatcher.runProtected("Client.sendCustomEvent",function(){if(a==b.NO_SESSION_KEY){if(i._globalSessionKey<0){var f=new d;i._globalSessionKey=i._sessionFactory.makeGlobalSession(f,null)}a=i._globalSessionKey}var g=B.ObjectShallowCopy(e),h=i._sessionFactory.getSession(a);null!=h&&h.sendCustomEvent(c,g)}):void i._logger.error("sendCustomEvent(): eventName parameter must be a valid string.")},this.adStart=function(a,c,d,e){return this._released?void 0:c!==b.AdStream.CONTENT&&c!==b.AdStream.SEPARATE?void this._logger.error("adStart(): ignored, invalid value for adStream parameter: "+c):d!==b.AdPlayer.CONTENT&&d!==b.AdPlayer.SEPARATE?void this._logger.error("adStart(): ignored, invalid value for adPlayer parameter: "+d):e!==b.AdPosition.PREROLL&&e!==b.AdPosition.MIDROLL&&e!==b.AdPosition.POSTROLL?void this._logger.error("adStart(): ignored, invalid value for adPosition parameter: "+e):void this._exceptionCatcher.runProtected("Client.adStart",function(){var b=i._sessionFactory.getVideoSession(a);null!=b&&b.adStart(c,d,e)})},this.adEnd=function(a){this._released||this._exceptionCatcher.runProtected("Client.adEnd",function(){var b=i._sessionFactory.getVideoSession(a);null!=b&&b.adEnd()})},this.cleanupSession=function(a){return this._released?void 0:a===b.NO_SESSION_KEY?void this._logger.warning("cleanupSession(): ignored, can't cleanup Client.NO_SESSION_KEY"):void this._exceptionCatcher.runProtected("Client.cleanupSession",function(){var b=i._sessionFactory.getVideoSession(a);null!=b&&i._sessionFactory.cleanupSession(a)})},this.getPlayerStateManager=function(){if(this._released)throw new Error("This instance of Conviva.Client has been released.");return new g(this._systemFactory)},this.releasePlayerStateManager=function(a){if(this._released)throw new Error("This instance of Conviva.Client has been released.");this._exceptionCatcher.runProtected("Client.releasePlayerStateManager",function(){a instanceof g&&a.release()})},this.getSettings=function(){return this._settings},this.getId=function(){return this._id}};b.version="2.119.0.32091",b.NO_SESSION_KEY=-2,b.AdPosition={PREROLL:"PREROLL",MIDROLL:"MIDROLL",POSTROLL:"POSTROLL"},b.AdStream={CONTENT:"CONTENT",SEPARATE:"SEPARATE"},b.AdPlayer={CONTENT:"CONTENT",SEPARATE:"SEPARATE"},b.ErrorSeverity={FATAL:0,WARNING:1},b.DeviceType={DESKTOP:"DESKTOP",CONSOLE:"Console",SETTOP:"Settop",MOBILE:"Mobile",TABLET:"Tablet",SMARTTV:"SmartTV",UNKNOWN:"Unknown"};var c=a.ClientSettings=function(a){function b(a){if(!B.isValidString(a))throw new Error("customerKey must be valid");this.customerKey=a}this._customerKey=null,B.defGet(this,"customerKey",function(){return this._customerKey}),B.defSet(this,"customerKey",function(a){B.isValidString(a)&&(this._customerKey=a)}),this._heartbeatInterval=c.defaultProductionHeartbeatInterval,B.defGet(this,"heartbeatInterval",function(){return this._heartbeatInterval}),B.defSet(this,"heartbeatInterval",function(a){if("number"==typeof a){var b=B.NumberToUnsignedInt(a);b===a&&(this._heartbeatInterval=b)}}),this._gatewayUrl=c.defaultProductionGatewayUrl,B.defGet(this,"gatewayUrl",function(){return this._gatewayUrl}),B.defSet(this,"gatewayUrl",function(a){B.isValidString(a)&&(this._gatewayUrl=a)}),b.apply(this,arguments),this.equals=function(a){return this.customerKey===a.customerKey&&this.gatewayUrl===a.gatewayUrl&&this.heartbeatInterval===a.heartbeatInterval},this.clone=function(){var a=new c(this.customerKey);return a.gatewayUrl=this.gatewayUrl,a.heartbeatInterval=this.heartbeatInterval,a}};c.defaultDevelopmentGatewayUrl="https://conviva.testonly.conviva.com",c.defaultProductionGatewayUrl="https://cws.conviva.com",c.defaultDevelopmentHeartbeatInterval=5,c.defaultProductionHeartbeatInterval=20;var d=a.ContentMetadata=function(){function a(){return this._custom}function b(a){return null!=a&&"undefined"!=a&&"null"!=a&&""!=a}function c(a){if("object"==typeof a){var c={};for(var d in a)if(b(d)){var e=a[d];b(e)&&(c[d]=e)}this._custom=c}}function e(){return this._defaultBitrateKbps}function f(a){this._defaultBitrateKbps=F.sanitizeSpecialIntegerValue(a)}function g(){return this._streamType}function h(a){(a===d.StreamType.UNKNOWN||a===d.StreamType.VOD||a===d.StreamType.LIVE)&&(this._streamType=a)}function i(){return this._duration}function j(a){this._duration=F.sanitizeSpecialIntegerValue(a)}function k(){return this._encodedFrameRate}function l(a){this._encodedFrameRate=F.sanitizeSpecialIntegerValue(a)}function m(){}this.assetName=null,this._custom={},B.defGet(this,"custom",a),B.defSet(this,"custom",c),this._defaultBitrateKbps=-2,B.defGet(this,"defaultBitrateKbps",e),B.defSet(this,"defaultBitrateKbps",f),this.defaultResource=null,this.viewerId=null,this.applicationName=null,this.streamUrl=null,this._streamType=d.StreamType.UNKNOWN,B.defGet(this,"streamType",g),B.defSet(this,"streamType",h),this._duration=-1,B.defGet(this,"duration",i),B.defSet(this,"duration",j),this._encodedFrameRate=-1,B.defGet(this,"encodedFrameRate",k),B.defSet(this,"encodedFrameRate",l),m.apply(this,arguments),this.clone=function(){var a=new d;a.assetName=this.assetName,a.applicationName=this.applicationName,a.streamUrl=this.streamUrl,a.viewerId=this.viewerId,a.defaultBitrateKbps=this.defaultBitrateKbps,a.defaultResource=this.defaultResource,a.streamType=this.streamType,a.duration=this.duration,a.encodedFrameRate=this.encodedFrameRate;for(var b in this.custom)a.custom[b]=this.custom[b];return a}};d.StreamType={UNKNOWN:"UNKNOWN",LIVE:"LIVE",VOD:"VOD"};var e=a.SystemFactory=function(a,b){function c(a,b){if(!(a instanceof l))throw new Error("systemInterface parameter should be an instance of SystemInterface.");this._systemInterface=a,this._timeInterface=this._systemInterface._timeInterface,this._timerInterface=this._systemInterface._timerInterface,this._httpInterface=this._systemInterface._httpInterface,this._storageInterface=this._systemInterface._storageInterface,this._metadataInterface=this._systemInterface._metadataInterface,this._loggingInterface=this._systemInterface._loggingInterface,b instanceof f?this._settings=b.clone():this._settings=new f}var d=this;c.apply(this,arguments),this.configure=function(a,b){this._packageName=a,this._clientSettings=b},this.release=function(){this._systemInterface.release(),this._systemInterface=null,this._packageName=null,this._settings=null,this._logBuffer=null};var e={build:function(){return new H(d._loggingInterface,d._timeInterface,d.getSettings(),d._logBuffer,d._packageName)}};this.buildLogger=function(){return e.build()},this.buildSessionFactory=function(a,b,c){return new v(a,b,c,this)},this.buildPing=function(){return new D(this.buildLogger(),this.buildHttpClient(),this._clientSettings)},this.buildCallbackWithTimeout=function(){return new w(this.buildTimer())},this.buildCallbackWithTimeoutNoPing=function(){var a=null,b=new z(this.buildLogger(),a,this.getSettings()),c=new L(this.buildLogger(),this._timerInterface,b);return new w(c)},this.buildHttpClient=function(){return new G(this.buildLogger(),this._httpInterface,this.buildCallbackWithTimeoutNoPing(),this.getSettings())},this.buildExceptionCatcher=function(){return new z(this.buildLogger(),this.buildPing(),this.getSettings())},this.buildTime=function(){return new K(this._timeInterface,this.buildLogger())},this.buildTimer=function(){return new L(this.buildLogger(),this._timerInterface,this.buildExceptionCatcher())},this.buildStorage=function(){return new I(this.buildLogger(),this._storageInterface,this.buildCallbackWithTimeout(),this.getSettings())},this.buildConfig=function(){return new x(this.buildLogger(),this.buildStorage(),this.buildJsonInterface())},this.buildSystemMetadata=function(){return new J(this.buildLogger(),this._metadataInterface,this.buildExceptionCatcher())},this.buildCwsProtocol=function(){return new q},this.buildGatewayControl=function(a){return new A(a,this.buildLogger(),this.buildHttpClient(),this.buildJsonInterface())},this.buildCwsSession=function(a,b,c){var d=this.buildGatewayControl(b);return new t(this.buildEventQueue(),a,b,this.buildLogger(),this.buildExceptionCatcher(),this.buildTimer(),d,this.buildCwsProtocol(),this.buildTime(),this.getLogBuffer(),c)},this.buildSession=function(a,b,c,d,e,f){var g=this.buildExceptionCatcher(),h=this.buildLogger(),i=this.buildCwsSession(a,b,c);return new u(d,e,f,c,this.buildSystemMetadata(),i,g,h)},this.buildEventQueue=function(){return new y},this.buildJsonInterface=function(){return new r},this.getLogBuffer=function(){return this._logBuffer},this.getSettings=function(){return this._settings},this._logBuffer=new C},f=a.SystemSettings=function(){function a(){}this._logLevel=f.defaultProductionLogLevel,B.defGet(this,"logLevel",function(){return this._logLevel}),B.defSet(this,"logLevel",function(a){if("number"==typeof a){var b=B.NumberToUnsignedInt(a);b===a&&b>=f.LogLevel.DEBUG&&b<=f.LogLevel.ERROR&&(this._logLevel=b)}}),this._allowUncaughtExceptions=f.defaultProductionAllowUncaughtExceptions,B.defGet(this,"allowUncaughtExceptions",function(){return this._allowUncaughtExceptions}),B.defSet(this,"allowUncaughtExceptions",function(a){B.isBoolean(a)&&(this._allowUncaughtExceptions=a)}),this._storageTimeout=f.defaultStorageTimeout,B.defGet(this,"storageTimeout",function(){return this._storageTimeout}),B.defSet(this,"storageTimeout",function(a){if("number"==typeof a){var b=B.NumberToUnsignedInt(a);b===a&&(this._storageTimeout=b)}}),this._httpTimeout=f.defaultHttpTimeout,B.defGet(this,"httpTimeout",function(){return this._httpTimeout}),B.defSet(this,"httpTimeout",function(a){if("number"==typeof a){var b=B.NumberToUnsignedInt(a);b===a&&(this._httpTimeout=b)}}),a.apply(this,arguments),this.equals=function(a){return this.logLevel===a.logLevel&&this.allowUncaughtExceptions===a.allowUncaughtExceptions&&this.storageTimeout===a.storageTimeout&&this.httpTimeout===a.httpTimeout},this.clone=function(){var a=new f;return a.logLevel=this.logLevel,a.allowUncaughtExceptions=this.allowUncaughtExceptions,a.storageTimeout=this.storageTimeout,a.httpTimeout=this.httpTimeout,a}};f.LogLevel={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},f.defaultDevelopmentLogLevel=f.LogLevel.DEBUG,f.defaultProductionLogLevel=f.LogLevel.ERROR,f.defaultDevelopmentAllowUncaughtExceptions=!0,f.defaultProductionAllowUncaughtExceptions=!1,f.defaultStorageTimeout=10,f.defaultHttpTimeout=10;var g=a.PlayerStateManager=function(a){function b(a){c._systemFactory=a,c._logger=c._systemFactory.buildLogger(),c._logger.setModuleName("PlayerStateManager"),c._exceptionCatcher=c._systemFactory.buildExceptionCatcher()}var c=this;c._monitorNotifier=null,c._bitrateKbps=-2,c._playerState=g.PlayerState.UNKNOWN,c._currentMetadata={},c._renderedFrameRate=-2,c._encodedFrameRate=-2,c._duration=-2,c._playheadTimeMs=-1,c._bufferLengthMs=-1,c._playerVersion=null,c._playerType=null,c._streamUrl=null,c._lastError=null,c._pendingErrors=[],c._released=!1,this.release=function(){c._released||c._exceptionCatcher.runProtected("PlayerStateManager.release",function(){null!=c._monitorNotifier&&c._monitorNotifier.onRelease(),c.removeMonitoringNotifier(),c._systemFactory=null,c._logger=null,c._exceptionCatcher=null,c._released=!0})},this.getPlayheadTime=function(){return c._playheadTimeMs},this.setPlayheadTime=function(a){c._released||c._exceptionCatcher.runProtected("PlayerStateManager.setPlayheadTime",function(){c._playheadTimeMs=F.Integer(a,-1,null,-1),null!=c._monitorNotifier&&c._monitorNotifier.onPlayheadTimeChange(c._playheadTimeMs)})},this.getBufferLength=function(){return c._bufferLengthMs},this.setBufferLength=function(a){c._released||c._exceptionCatcher.runProtected("PlayerStateManager.setBufferLength",function(){c._bufferLengthMs=F.Integer(a,-1,null,-1),null!=c._monitorNotifier&&c._monitorNotifier.onBufferLengthChange(c._bufferLengthMs)})},this.getRenderedFrameRate=function(){return c._renderedFrameRate},this.setRenderedFrameRate=function(a){c._released||c._exceptionCatcher.runProtected("PlayerStateManager.setRenderedFrameRate",function(){c._renderedFrameRate=F.Integer(a,-1,null,-1),null!=c._monitorNotifier&&c._monitorNotifier.onRenderedFrameRateChange(c._renderedFrameRate)})},this.getEncodedFrameRate=function(){return c._encodedFrameRate},this.setEncodedFrameRate=function(a){c._released||c._exceptionCatcher.runProtected("PlayerStateManager.setEncodedFrameRate",function(){var b=F.sanitizeSpecialIntegerValue(a);b>=-1&&(c._encodedFrameRate=b,null!=c._monitorNotifier&&c._monitorNotifier.onEncodedFrameRateChange(c._encodedFrameRate))})},this.getDuration=function(){return c._duration},this.setDuration=function(a){c._released||c._exceptionCatcher.runProtected("PlayerStateManager.setDuration",function(){var b=F.sanitizeSpecialIntegerValue(a);b>=-1&&(c._duration=b,null!=c._monitorNotifier&&c._monitorNotifier.onContentLengthChange(c._duration))})},this.getStreamUrl=function(){return c._streamUrl},this.setStreamUrl=function(a){c._released||c._exceptionCatcher.runProtected("PlayerStateManager.setStreamUrl",function(){c._streamUrl=a,null!=c._monitorNotifier&&c._monitorNotifier.onStreamUrlChange(c._streamUrl)})},this.getPlayerType=function(){return c._playerType},this.setPlayerType=function(a){c._released||c._exceptionCatcher.runProtected("PlayerStateManager.setPlayerType",function(){c._playerType=a,null!=c._monitorNotifier&&c._monitorNotifier.onPlayerTypeChange(c._playerType)})},this.getPlayerVersion=function(){return c._playerVersion},this.setPlayerVersion=function(a){c._released||c._exceptionCatcher.runProtected("PlayerStateManager.setPlayerVersion",function(){c._playerVersion=a,null!=c._monitorNotifier&&c._monitorNotifier.onPlayerVersionChange(c._playerVersion)})},this.setMonitoringNotifier=function(a,b){return c._released?void 0:null!=c._monitorNotifier?!1:(c._monitorNotifier=a,c._logger.setSessionId(b),!0)},this.removeMonitoringNotifier=function(){c._released||(c._monitorNotifier=null,c._logger.setSessionId(null))},this.pushCurrentState=function(){c.setPlayerState(c.getPlayerState()),c.setBitrateKbps(c.getBitrateKbps()),c.setDuration(c.getDuration()),c.setEncodedFrameRate(c.getEncodedFrameRate()),c.setPlayheadTime(c.getPlayheadTime()),c.setBufferLength(c.getBufferLength()),c.setStreamUrl(c.getStreamUrl()),c.setPlayerType(c.getPlayerType()),c.setPlayerVersion(c.getPlayerVersion());for(var a=0;a<c._pendingErrors.length;a++){var b=c._pendingErrors[a];c.setError(b)}c._pendingErrors=[]},this.getPlayerState=function(){return c._playerState},this.setPlayerState=function(a){c._released||c._exceptionCatcher.runProtected("PlayerStateManager.setPlayerState",function(){g.isValidPlayerState(a)?(c._playerState=a,null!=c._monitorNotifier&&c._monitorNotifier.onPlayerStateChange(c._playerState)):c._logger.error("PlayerStateManager.SetPlayerState(): invalid state: "+a)})},this.getBitrateKbps=function(){return c._bitrateKbps},this.setBitrateKbps=function(a){c._released||c._exceptionCatcher.runProtected("PlayerStateManager.setBitrateKbps",function(){var b=F.sanitizeSpecialIntegerValue(a);b>=-1&&(c._bitrateKbps=b,null!=c._monitorNotifier&&c._monitorNotifier.onBitrateChange(c._bitrateKbps))})},this.setPlayerSeekStart=function(a){c._released||c._exceptionCatcher.runProtected("PlayerStateManager.setPlayerSeekStart()",function(){null!=c._monitorNotifier&&c._monitorNotifier.onSeekEvent(g.SEEK_ACTIONS_TYPE.SEEK_START,a)})},this.setPlayerSeekEnd=function(){c._released||c._exceptionCatcher.runProtected("PlayerStateManager.setPlayerSeekEnd()",function(){null!=c._monitorNotifier&&c._monitorNotifier.onSeekEvent(g.SEEK_ACTIONS_TYPE.SEEK_END,-1)})},this.setUserSeekButtonUp=function(){c._released||c._exceptionCatcher.runProtected("PlayerStateManager.setUserSeekButtonUp()",function(){null!=c._monitorNotifier&&c._monitorNotifier.onSeekEvent(g.SEEK_ACTIONS_TYPE.BUTTON_UP,-1)})},this.setUserSeekButtonDown=function(){c._released||c._exceptionCatcher.runProtected("PlayerStateManager.setUserSeekButtonDown()",function(){null!=c._monitorNotifier&&c._monitorNotifier.onSeekEvent(g.SEEK_ACTIONS_TYPE.BUTTON_DOWN,-1)})},this.setError=function(a){if(c._lastError=a,null!=c._monitorNotifier){var b=a.errorCode,d=a.severity;c._monitorNotifier.onError(b,d)}else c._pendingErrors.push(a)},this.sendError=function(a,b){c._released||c._exceptionCatcher.runProtected("PlayerStateManager.sendError",function(){var d=new Conviva.PrivateLoader.StreamerError(a,b);c.setError(d)})},this.reset=function(){c._released||c._exceptionCatcher.runProtected("PlayerStateManager.reset",function(){c._bitrateKbps=-2,c._playerState=g.PlayerState.UNKNOWN,c._currentMetadata={},c._renderedFrameRate=-1,c._encodedFrameRate=-1,c._duration=-1,c._playheadTimeMs=-1,c._bufferLengthMs=-1,c._playerVersion=null,c._playerType=null,c._streamUrl=null,c._lastError=null,c._pendingErrors=[]})},this.getError=function(){return c._lastError},b.apply(c,arguments)};g.PlayerState={STOPPED:"STOPPED",PLAYING:"PLAYING",BUFFERING:"BUFFERING",PAUSED:"PAUSED",UNKNOWN:"UNKNOWN",NOT_MONITORED:"NOT_MONITORED"},g.isValidPlayerState=function(a){return a===g.PlayerState.STOPPED||a===g.PlayerState.PLAYING||a===g.PlayerState.BUFFERING||a===g.PlayerState.PAUSED||a===g.PlayerState.UNKNOWN||a===g.PlayerState.NOT_MONITORED?!0:!1},g.SEEK_ACTIONS_TYPE={SEEK_START:"pss",SEEK_END:"pse",BUTTON_UP:"bu",BUTTON_DOWN:"bd"};var h=a.HttpInterface=function(){this.makeRequest=function(a,b,c,d,e,f){},this.release=function(){}},i=a.LoggingInterface=function(){this.consoleLog=function(a,b){},this.release=function(){}},j=a.MetadataInterface=function(){this.getBrowserName=function(){},this.getBrowserVersion=function(){},this.getDeviceBrand=function(){},this.getDeviceManufacturer=function(){},this.getDeviceModel=function(){},this.getDeviceType=function(){},this.getDeviceVersion=function(){},this.getFrameworkName=function(){},this.getFrameworkVersion=function(){},this.getOperatingSystemName=function(){},this.getOperatingSystemVersion=function(){},this.release=function(){}},k=a.StorageInterface=function(){this.saveData=function(a,b,c,d){},this.loadData=function(a,b,c){},this.release=function(){}},l=a.SystemInterface=function(a,b,c,d,e,f){function g(a,b,c,d,e,f){B.validateInterface(a,new m,"TimeInterface"),B.validateInterface(b,new n,"TimerInterface"),B.validateInterface(c,new h,"HttpInterface"),B.validateInterface(d,new k,"StorageInterface"),B.validateInterface(e,new j,"MetadataInterface"),B.validateInterface(f,new i,"LoggingInterface"),this._timeInterface=a,this._timerInterface=b,this._httpInterface=c,this._storageInterface=d,this._metadataInterface=e,this._loggingInterface=f}g.apply(this,arguments),this.release=function(){this._timeInterface.release(),this._timeInterface=null,this._timerInterface.release(),this._timerInterface=null,this._httpInterface.release(),this._httpInterface=null,this._storageInterface.release(),this._storageInterface=null,this._metadataInterface.release(),this._metadataInterface=null,this._loggingInterface.release(),this._loggingInterface=null}},m=a.TimeInterface=function(){this.getEpochTimeMs=function(){},this.release=function(){}},n=a.TimerInterface=function(){this.createTimer=function(a,b,c){},this.release=function(){}},o=a.JSON2={};!function(){function a(a){return 10>a?"0"+a:a}function b(a){return d.lastIndex=0,d.test(a)?'"'+a.replace(d,function(a){var b=g[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,d){var g,i,j,k,l,m=e,n=d[a];switch(n&&"object"==typeof n&&"function"==typeof n.toJSON&&(n=n.toJSON(a)),"function"==typeof h&&(n=h.call(d,a,n)),typeof n){case"string":return b(n);case"number":return isFinite(n)?String(n):"null";case"boolean":case"null":return String(n);case"object":if(!n)return"null";if(e+=f,l=[],Object.prototype.toString.apply(n)===Object.prototype.toString.apply([])){for(k=n.length,g=0;k>g;g+=1)l[g]=c(g,n)||"null";return j=0===l.length?"[]":e?"[\n"+e+l.join(",\n"+e)+"\n"+m+"]":"["+l.join(",")+"]",e=m,j}if(h&&"object"==typeof h)for(k=h.length,g=0;k>g;g+=1)"string"==typeof h[g]&&(i=h[g],j=c(i,n),j&&l.push(b(i)+(e?": ":":")+j));else for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(j=c(i,n),j&&l.push(b(i)+(e?": ":":")+j));return j=0===l.length?"{}":e?"{\n"+e+l.join(",\n"+e)+"\n"+m+"}":"{"+l.join(",")+"}",e=m,j}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var d,e,f,g,h;"function"!=typeof o.stringify&&(d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},o.stringify=function(a,b,d){var g;if(e="",f="","number"==typeof d)for(g=0;d>g;g+=1)f+=" ";else"string"==typeof d&&(f=d);if(h=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON2.stringify");return c("",{"":a})})}();var p=a.JsonParse=function(){var a,b,c,d,e={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},f=function(b){throw{name:"SyntaxError",message:b,at:a,text:c}},g=function(d){return d&&d!==b&&f("Expected '"+d+"' instead of '"+b+"'"),b=c.charAt(a),a+=1,b},h=function(){var a,c="";for("-"===b&&(c="-",g("-"));b>="0"&&"9">=b;)c+=b,g();if("."===b)for(c+=".";g()&&b>="0"&&"9">=b;)c+=b;if("e"===b||"E"===b)for(c+=b,g(),("-"===b||"+"===b)&&(c+=b,g());b>="0"&&"9">=b;)c+=b,g();return a=+c,isNaN(a)?void f("Bad number"):a},i=function(){var a,c,d,h="";if('"'===b)for(;g();){if('"'===b)return g(),h;if("\\"===b)if(g(),"u"===b){for(d=0,c=0;4>c&&(a=parseInt(g(),16),isFinite(a));c+=1)d=16*d+a;h+=String.fromCharCode(d)}else{if("string"!=typeof e[b])break;h+=e[b]}else h+=b}f("Bad string")},j=function(){for(;b&&" ">=b;)g()},k=function(){switch(b){case"t":return g("t"),g("r"),g("u"),g("e"),!0;case"f":return g("f"),g("a"),g("l"),g("s"),g("e"),!1;case"n":return g("n"),g("u"),g("l"),g("l"),null}f("Unexpected '"+b+"'")},l=function(){var a=[];if("["===b){if(g("["),j(),"]"===b)return g("]"),a;for(;b;){if(a.push(d()),j(),"]"===b)return g("]"),a;g(","),j()}}f("Bad array")},m=function(){var a,c={};if("{"===b){if(g("{"),j(),"}"===b)return g("}"),c;for(;b;){if(a=i(),j(),g(":"),Object.hasOwnProperty.call(c,a)&&f('Duplicate key "'+a+'"'),c[a]=d(),j(),"}"===b)return g("}"),c;g(","),j()}}f("Bad object")};return d=function(){switch(j(),b){case"{":return m();case"[":return l();case'"':return i();case"-":return h();default:return b>="0"&&"9">=b?h():k()}},function(e,g){var h;return c=e,a=0,b=" ",h=d(),j(),b&&f("Syntax error"),"function"==typeof g?function i(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.hasOwnProperty.call(e,c)&&(d=i(e,c),void 0!==d?e[c]=d:delete e[c]);return g.call(a,b,e)}({"":h},""):h}}(),q=a.CwsProtocol=function(){this.generateEvent=function(a,b,c,d){return d.seq=a,d.st=b,d.t=c,d},this.generateSessionEndEvent=function(a,b){var c=q.EVENT_TYPE_SESSION_END,d={};return this.generateEvent(a,b,c,d)}};q.version="2.2",q.gatewayPath="/0/wsg",q.DEFAULT_CLIENT_ID="0",q.DEFAULT_MAX_HEARTBEAT_INFOS=0,q.DEFAULT_PLAYHEAD_TIME=-1,q.DEFAULT_BUFFER_LENGTH=-1,q.SDK_METADATA_SCHEMA="sdk.js.1",q.EVENT_TYPE_STATE_CHANGE="CwsStateChangeEvent",q.EVENT_TYPE_ERROR="CwsErrorEvent",q.EVENT_TYPE_SESSION_END="CwsSessionEndEvent",q.EVENT_TYPE_CUSTOM="CwsCustomEvent",q.EVENT_TYPE_SEEK="CwsSeekEvent",q.RESPONSE_STATUS_NO_ERRORS="ok",q.RESPONSE_KEY_STATUS="err",q.RESPONSE_KEY_CLIENT_ID="clid",q.RESPONSE_KEY_CONFIG="cfg",q.RESPONSE_KEY_EVENTS="evs",q.RESPONSE_CONFIG_KEY_MAX_HEARTBEAT_INFOS="maxhbinfos",q.RESPONSE_CONFIG_KEY_SEND_LOGS="slg",q.RESPONSE_CONFIG_KEY_HEARTBEAT_INTERVAL="hbi",q.RESPONSE_CONFIG_KEY_GATEWAY_URL="gw",q.MESSAGE_TYPE_SESSION_HEARTBEAT="CwsSessionHb",q.REQUEST_KEY_MESSAGE_TYPE="t",q.REQUEST_KEY_SESSION_TIME="st",q.REQUEST_KEY_SESSION_START_TIME="sst",q.REQUEST_KEY_IS_LIVE="lv",q.REQUEST_KEY_SEQUENCE_NUMBER="seq",q.REQUEST_KEY_CUSTOMER_KEY="cid",q.REQUEST_KEY_CLIENT_ID="clid",q.REQUEST_KEY_CLIENT_VERSION="clv",q.REQUEST_KEY_PROTOCOL_VERSION="pver",q.REQUEST_KEY_INSTANCE_ID="iid",q.REQUEST_KEY_SESSION_ID="sid",q.REQUEST_KEY_VIEWER_ID="vid",q.REQUEST_KEY_ASSET_NAME="an",q.REQUEST_KEY_PLAYER_NAME="pn",q.REQUEST_KEY_TAGS="tags",q.REQUEST_KEY_SESSION_FLAGS="sf",q.REQUEST_KEY_EVENTS="evs",q.REQUEST_KEY_LOGS="lg",q.REQUEST_KEY_HEARTBEAT_INFOS="hbinfos",q.REQUEST_KEY_IS_SDK_CLIENT="sdk",q.REQUEST_KEY_PAUSE_JOIN="pj",q.REQUEST_KEY_PLAYER_STATE="ps",q.REQUEST_KEY_BITRATE="br",q.REQUEST_KEY_CONTENT_LENGTH="cl",q.REQUEST_KEY_ENCODED_FRAME_RATE="efps",q.REQUEST_KEY_AVERAGE_FRAME_RATE="afps",q.REQUEST_KEY_RESOURCE="rs",q.REQUEST_KEY_PLAYHEAD_TIME="pht",q.REQUEST_KEY_BUFFER_LENGTH="bl",q.REQUEST_KEY_STREAM_URL="url",q.REQUEST_KEY_CAPABILITIES="caps",q.REQUEST_KEY_PLATFORM_METADATA="pm",q.REQUEST_PLATFORM_METADATA_KEY_SCHEMA="sch",q.REQUEST_PLATFORM_METADATA_KEY_BROWSER_NAME="br",q.REQUEST_PLATFORM_METADATA_KEY_BROWSER_VERSION="brv",q.REQUEST_PLATFORM_METADATA_KEY_DEVICE_BRAND="dvb",q.REQUEST_PLATFORM_METADATA_KEY_DEVICE_MANUFACTURER="dvma",q.REQUEST_PLATFORM_METADATA_KEY_DEVICE_MODEL="dvm",q.REQUEST_PLATFORM_METADATA_KEY_DEVICE_TYPE="dvt",q.REQUEST_PLATFORM_METADATA_KEY_DEVICE_VERSION="dvv",q.REQUEST_PLATFORM_METADATA_KEY_FRAMEWORK_NAME="fw",q.REQUEST_PLATFORM_METADATA_KEY_FRAMEWORK_VERSION="fwv",q.REQUEST_PLATFORM_METADATA_KEY_OPERATING_SYSTEM_NAME="os",q.REQUEST_PLATFORM_METADATA_KEY_OPERATING_SYSTEM_VERSION="osv",q.REQUEST_KEY_PROTOCOL_CAPP="caps",q.REQUEST_EVENT_KEY_TYPE="t",q.REQUEST_EVENT_KEY_SEQUENCE_NUMBER="seq",q.REQUEST_EVENT_KEY_SESSION_TIME="st",q.REQUEST_EVENT_KEY_SEEK_ACT_TYPE="act",q.REQUEST_EVENT_KEY_SEEK_TO_POS="skto",q.REQUEST_ERROR_EVENT_KEY_MESSAGE="err",q.REQUEST_ERROR_EVENT_KEY_FATAL="ft",q.REQUEST_STATE_CHANGE_EVENT_KEY_NEW="new",q.REQUEST_STATE_CHANGE_EVENT_KEY_OLD="old",q.REQUEST_CUSTOM_EVENT_KEY_NAME="name",q.REQUEST_CUSTOM_EVENT_KEY_ATTRIBUTES="attr",q.REQUEST_HEARTBEAT_INFO_KEY_SEQUENCE_NUMBER="seq",q.REQUEST_HEARTBEAT_INFO_KEY_STATUS="err",q.REQUEST_HEARTBEAT_INFO_KEY_ROUNDTRIP_TIME="rtt",q.convertPlayerState=function(a){switch(a){case g.PlayerState.STOPPED:return q.eStopped;case g.PlayerState.PLAYING:return q.ePlaying;case g.PlayerState.BUFFERING:return q.eBuffering;case g.PlayerState.PAUSED:return q.ePaused;case g.PlayerState.NOT_MONITORED:return q.eNotMonitored;default:return q.eUnknown}},q.eStopped=1,q.ePlaying=3,q.eBuffering=6,q.ePaused=12,q.eNotMonitored=98,q.eUnknown=100,q.SessionFlags={GLOBAL:0,VIDEO:1,QUALITY_METRICS:2,BITRATE_METRICS:4},q.Capabilities={INSIGHTS:0};var r=(a.JSONInterface=function(){this.encode=function(a){},this.decode=function(a){}},a.LibJSONInterface=function(){this.encode=function(a){var b=null;try{b=o.stringify(a)}catch(c){}return b},this.decode=function(a){var b=null;try{b=p(a)}catch(c){}return B.isObject(b)||(b=null),b}}),s=a.CwsHeartbeat=function(){function a(){}this._data={},a.apply(this,arguments),this.get=function(){return this._data},this.setField=function(a,b){this._data[a]=b},this.setInnerField=function(a,b,c){this._data[a]||(this._data[a]={}),this._data[a][b]=c},this.setMessageType=function(a){this.setField(q.REQUEST_KEY_MESSAGE_TYPE,a)},this.setSessionTime=function(a){this.setField(q.REQUEST_KEY_SESSION_TIME,a)},this.setSessionStartTime=function(a){this.setField(q.REQUEST_KEY_SESSION_START_TIME,a)},this.setIsLive=function(a){this.setField(q.REQUEST_KEY_IS_LIVE,a)},this.setSequenceNumber=function(a){this.setField(q.REQUEST_KEY_SEQUENCE_NUMBER,a)},this.setCustomerKey=function(a){this.setField(q.REQUEST_KEY_CUSTOMER_KEY,a)},this.setClientId=function(a){this.setField(q.REQUEST_KEY_CLIENT_ID,a)},this.setClientVersion=function(a){this.setField(q.REQUEST_KEY_CLIENT_VERSION,a)},this.setProtocolVersion=function(a){this.setField(q.REQUEST_KEY_PROTOCOL_VERSION,a)},this.setCapfield=function(a){this.setField(q.REQUEST_KEY_PROTOCOL_CAPP,a)},this.setSessionId=function(a){this.setField(q.REQUEST_KEY_SESSION_ID,a)},this.setInstanceId=function(a){this.setField(q.REQUEST_KEY_INSTANCE_ID,a)},this.setViewerId=function(a){this.setField(q.REQUEST_KEY_VIEWER_ID,a)},this.setAssetName=function(a){
this.setField(q.REQUEST_KEY_ASSET_NAME,a)},this.setPlayerName=function(a){this.setField(q.REQUEST_KEY_PLAYER_NAME,a)},this.setTags=function(a){this.setField(q.REQUEST_KEY_TAGS,a)},this.setSessionFlags=function(a){this.setField(q.REQUEST_KEY_SESSION_FLAGS,a)},this.setCapabilities=function(a){this.setField(q.REQUEST_KEY_CAPABILITIES,a)},this.setEvents=function(a){this.setField(q.REQUEST_KEY_EVENTS,a)},this.setIsSdkClient=function(a){this.setField(q.REQUEST_KEY_IS_SDK_CLIENT,a)},this.setLogs=function(a){this.setField(q.REQUEST_KEY_LOGS,a)},this.setHeartbeatInfos=function(a){this.setField(q.REQUEST_KEY_HEARTBEAT_INFOS,a)},this.setPlayerState=function(a){this.setField(q.REQUEST_KEY_PLAYER_STATE,a)},this.setPauseJoin=function(a){this.setField(q.REQUEST_KEY_PAUSE_JOIN,a)},this.setContentLength=function(a){this.setField(q.REQUEST_KEY_CONTENT_LENGTH,a)},this.setBitrate=function(a){this.setField(q.REQUEST_KEY_BITRATE,a)},this.setResource=function(a){this.setField(q.REQUEST_KEY_RESOURCE,a)},this.setEncodedFrameRate=function(a){this.setField(q.REQUEST_KEY_ENCODED_FRAME_RATE,a)},this.setAverageFrameRate=function(a){this.setField(q.REQUEST_KEY_AVERAGE_FRAME_RATE,a)},this.setPlatformMetadataSchema=function(a){this.setInnerField(q.REQUEST_KEY_PLATFORM_METADATA,q.REQUEST_PLATFORM_METADATA_KEY_SCHEMA,a)},this.setBrowserName=function(a){this.setInnerField(q.REQUEST_KEY_PLATFORM_METADATA,q.REQUEST_PLATFORM_METADATA_KEY_BROWSER_NAME,a)},this.setBrowserVersion=function(a){this.setInnerField(q.REQUEST_KEY_PLATFORM_METADATA,q.REQUEST_PLATFORM_METADATA_KEY_BROWSER_VERSION,a)},this.setDeviceBrand=function(a){this.setInnerField(q.REQUEST_KEY_PLATFORM_METADATA,q.REQUEST_PLATFORM_METADATA_KEY_DEVICE_BRAND,a)},this.setDeviceManufacturer=function(a){this.setInnerField(q.REQUEST_KEY_PLATFORM_METADATA,q.REQUEST_PLATFORM_METADATA_KEY_DEVICE_MANUFACTURER,a)},this.setDeviceModel=function(a){this.setInnerField(q.REQUEST_KEY_PLATFORM_METADATA,q.REQUEST_PLATFORM_METADATA_KEY_DEVICE_MODEL,a)},this.setDeviceType=function(a){this.setInnerField(q.REQUEST_KEY_PLATFORM_METADATA,q.REQUEST_PLATFORM_METADATA_KEY_DEVICE_TYPE,a)},this.setDeviceVersion=function(a){this.setInnerField(q.REQUEST_KEY_PLATFORM_METADATA,q.REQUEST_PLATFORM_METADATA_KEY_DEVICE_VERSION,a)},this.setFrameworkName=function(a){this.setInnerField(q.REQUEST_KEY_PLATFORM_METADATA,q.REQUEST_PLATFORM_METADATA_KEY_FRAMEWORK_NAME,a)},this.setFrameworkVersion=function(a){this.setInnerField(q.REQUEST_KEY_PLATFORM_METADATA,q.REQUEST_PLATFORM_METADATA_KEY_FRAMEWORK_VERSION,a)},this.setOperatingSystemName=function(a){this.setInnerField(q.REQUEST_KEY_PLATFORM_METADATA,q.REQUEST_PLATFORM_METADATA_KEY_OPERATING_SYSTEM_NAME,a)},this.setOperatingSystemVersion=function(a){this.setInnerField(q.REQUEST_KEY_PLATFORM_METADATA,q.REQUEST_PLATFORM_METADATA_KEY_OPERATING_SYSTEM_VERSION,a)},this.setPlayheadTime=function(a){this.setField(q.REQUEST_KEY_PLAYHEAD_TIME,a)},this.setBufferLength=function(a){this.setField(q.REQUEST_KEY_BUFFER_LENGTH,a)},this.setStreamUrl=function(a){this.setField(q.REQUEST_KEY_STREAM_URL,a)}},t=a.CwsSession=function(a,c,d,e,f,h,i,j,k,l,m){function n(a,b,c,d,e,f,g,h,i,j,k){this._eventQueue=a,this._client=b,this._clientSettings=c,this._logger=d,this._logger.setModuleName("CwsSession"),this._exceptionCatcher=e,this._timer=f,this._gatewayControl=g,this._cwsProtocol=h,this._time=i,this._logBuffer=j,this._clientConfig=k}var o=this;o._heartbeatTimerCancel=null,o._startTimeMs=0,o._heartbeatSequenceNumber=0,o._sessionFlags=q.SessionFlags.GLOBAL,o._capabilities=q.Capabilities.INSIGHTS,o._heartbeatInfos=[],o._lastRequestSentMs=-1,o._bitrateKbps=-2,o._resource=null,o._playerState=g.PlayerState.NOT_MONITORED,o._encodedFrameRate=-1,o._contentLengthSec=-1,o._bufferLengthMs=q.DEFAULT_BUFFER_LENGTH,o._playheadTimeMs=q.DEFAULT_PLAYHEAD_TIME,o._streamUrl=null,o._averageFrameRate=-1,o._assetName=null,o._viewerId=null,o._playerName=null,o._isLive=null,o._tags={},o._browserName=null,o._browserVersion=null,o._deviceBrand=null,o._deviceManufacturer=null,o._deviceModel=null,o._deviceType=null,o._deviceVersion=null,o._frameworkName=null,o._frameworkVersion=null,o._operatingSystemName=null,o._operatingSystemVersion=null,o._pauseJoin=!1,o._hasJoined=!1,o._cleanedUp=!1,o._willEndSoon=!1,n.apply(this,arguments),this.cleanup=function(){this._clientConfig=null,this._logBuffer=null,this._systemSettings=null,this._time=null,this._cwsProtocol=null,this._gatewayControl=null,this._timer=null,this._exceptionCatcher=null,this._logger=null,this._clientSettings=null,this._client=null,this._eventQueue.flush(),this._eventQueue=null,this._cleanedUp=!0},this.start=function(a){this._session=a,this._global=this._session._global,this._logger.setSessionId(this._session._id),this._startTimeMs=this._time.current(),this.isVideoSession()&&(this._sessionFlags+=t.DEFAULT_VIDEO_SESSION_FLAGS)},this.willEndSoon=function(){this._willEndSoon=!0},this.initialize=function(){this._logger.debug("initialize()")},this.end=function(){this.isVideoSession()&&(this._logger.debug("end(): schedule the last hb before session cleanup"+o.sessionTypeTag()),this.enqueueSessionEndEvent()),this.cancelHeartbeatTimer(),this.sendHeartbeat()},this.startSendingHeartbeats=function(){this._willEndSoon||(this.sendHeartbeat(),this.resetHeartbeatTimer())},this.setBrowserName=function(a){o._logger.debug("setBrowserName(): "+a);var b=o._browserName;b!==a&&null!=a&&(o._logger.debug("Change browserName from "+b+" to "+a),o._browserName=a)},this.setBrowserVersion=function(a){o._logger.debug("setBrowserVersion(): "+a);var b=o._browserVersion;b!==a&&null!=a&&(o._logger.debug("Change browserVersion from "+b+" to "+a),o._browserVersion=a)},this.setDeviceBrand=function(a){o._logger.debug("setDeviceBrand(): "+a);var b=o._deviceBrand;b!==a&&null!=a&&(o._logger.debug("Change deviceBrand from "+b+" to "+a),o._deviceBrand=a)},this.setDeviceManufacturer=function(a){o._logger.debug("setDeviceManufacturer(): "+a);var b=o._deviceManufacturer;b!==a&&null!=a&&(o._logger.debug("Change deviceManufacturer from "+b+" to "+a),o._deviceManufacturer=a)},this.setDeviceModel=function(a){o._logger.debug("setDeviceModel(): "+a);var b=o._deviceModel;b!==a&&null!=a&&(o._logger.debug("Change deviceModel from "+b+" to "+a),o._deviceModel=a)},this.setDeviceType=function(a){o._logger.debug("setDeviceBrand(): "+a);var b=o._deviceType;b!==a&&null!=a&&(o._logger.debug("Change deviceType from "+b+" to "+a),o._deviceType=a)},this.setDeviceVersion=function(a){o._logger.debug("setDeviceVersion(): "+a);var b=o._deviceVersion;b!==a&&null!=a&&(o._logger.debug("Change deviceVersion from "+b+" to "+a),o._deviceVersion=a)},this.setOperatingSystemName=function(a){o._logger.debug("setOperatingSystemName(): "+a);var b=o._operatingSystemName;b!==a&&null!=a&&(o._logger.debug("Change operatingSystemName from "+b+" to "+a),o._operatingSystemName=a)},this.setOperatingSystemVersion=function(a){o._logger.debug("setOperatingSystemVersion(): "+a);var b=o._operatingSystemVersion;b!==a&&null!=a&&(o._logger.debug("Change operatingSystemVersion from "+b+" to "+a),o._operatingSystemVersion=a)},this.setBufferLengthMs=function(a){var b=o._bufferLengthMs;b!==a&&a>=-1&&(o._logger.debug("Change buffer length from "+b+" to "+a),o._bufferLengthMs=a)},this.getFrameworkName=function(){return o._frameworkName},this.setFrameworkName=function(a){o._logger.debug("setFrameworkName(): "+a);var b=o._frameworkName;b!==a&&null!=a&&(o._logger.debug("Change frameworkName from "+b+" to "+a),o._frameworkName=a)},this.getFrameworkVersion=function(){return o._frameworkVersion},this.setFrameworkVersion=function(a){o._logger.debug("setFrameworkVersion(): "+a);var b=o._frameworkVersion;b!==a&&null!=a&&(o._logger.debug("Change frameworkVersion from "+b+" to "+a),o._frameworkVersion=a)},this.setPlayheadTimeMs=function(a){var b=o._playheadTimeMs;b!==a&&a>=-1&&(o._logger.debug("Change playhead time from "+b+" to "+a),o._playheadTimeMs=a)},this.setStreamUrl=function(a){o._logger.debug("setStreamUrl(): "+a);var b=o._streamUrl;b!==a&&null!=a&&(o._logger.debug("Change stream url from "+b+" to "+a),o.enqueueStreamUrlChangeEvent(b,a),o._streamUrl=a)},this.setBitrateKbps=function(a){o._logger.debug("setBitrateKbps(): "+a);var b=o._bitrateKbps;b!==a&&a>=-1&&(o._logger.info("Change bitrate from "+b+" to "+a),o.enqueueBitrateChangeEvent(b,a),o._bitrateKbps=a)},this.setResource=function(a){o._logger.debug("setResource(): "+a);var b=o._resource;b!==a&&null!=a&&(o._logger.info("Change resource from "+b+" to "+a),o.enqueueResourceChangeEvent(b,a),o._resource=a)},this.setAssetName=function(a){o._logger.debug("setAssetName(): "+a);var b=o._assetName;b!==a&&null!=a&&(o._logger.info("Change assetName from "+b+" to "+a),o.enqueueAssetNameChangeEvent(b,a),o._assetName=a)},this.setIsLive=function(a){o._logger.debug("setIsLive(): "+a);var b=o._isLive;b!==a&&null!=a&&(o._logger.info("Change isLive from "+b+" to "+a),o._isLive=a)},this.setViewerId=function(a){o._logger.debug("setViewerId(): "+a);var b=o._viewerId;b!==a&&null!=a&&(o._logger.info("Change viewerId from "+b+" to "+a),o._viewerId=a)},this.setPlayerName=function(a){o._logger.debug("setPlayerName(): "+a);var b=o._playerName;b!==a&&null!=a&&(o._logger.info("Change playerName from "+b+" to "+a),o._playerName=a)},this.setTags=function(a){o._logger.debug("setTags()");var b=o._tags;B.ObjectShallowEquals(b,a)||null==a||(o._logger.info("Change tags from "+B.ObjectToString(b)+" to "+B.ObjectToString(a)),o.enqueueTagsChangeEvent(b,a),o._tags=a)},this.setEncodedFrameRate=function(a){o._logger.debug("setEncodedFrameRate(): "+a),o._encodedFrameRate=a},this.setAverageFrameRate=function(a){o._logger.debug("setAverageFrameRate(): "+a),o._averageFrameRate=a},this.setContentLength=function(a){o._logger.debug("setContentLength(): "+a),o._contentLengthSec=a},this.setPlayerState=function(a){o._logger.debug("setPlayerState(): "+a),o._hasJoined||a!=g.PlayerState.PLAYING||(o.togglePauseJoin(!1),o._hasJoined=!0);var b=o._playerState;o._logger.info("setPlayerState(): changing player state from "+b+" to "+a),o.enqueuePlayerStateChangeEvent(b,a),o._playerState=a},this.togglePauseJoin=function(a){if(o._logger.debug("togglePauseJoin()"),o._pauseJoin===a)return void o._logger.debug("togglePauseJoin(): same value, ignoring");var b=o._pauseJoin,c=!o._pauseJoin;o.enqueuePauseJoinChangeEvent(b,c),o._pauseJoin=!o._pauseJoin},this.sendError=function(a,b){o.enqueueErrorEvent(a,b)},this.enqueueEvent=function(a,b){b[q.REQUEST_EVENT_KEY_TYPE]=a,b[q.REQUEST_EVENT_KEY_SESSION_TIME]=this.getSessionTime(),b[q.REQUEST_EVENT_KEY_SEQUENCE_NUMBER]=this._eventQueue.getNumber(),this._eventQueue.enqueue(b)},this.enqueueSessionEndEvent=function(){var a=this.getSessionTime(),b=this.getNextEventNumber(),c=this._cwsProtocol.generateSessionEndEvent(b,a);this._eventQueue.enqueue(c)},this.enqueueTagsChangeEvent=function(a,b){var c=null;B.dictCount(a)>0&&(c={},c[q.REQUEST_KEY_TAGS]=a);var d={};d[q.REQUEST_KEY_TAGS]=b,this.declareStateChange(d,c)},this.enqueueAssetNameChangeEvent=function(a,b){var c={};c[q.REQUEST_KEY_ASSET_NAME]=b,this.declareStateChange(c,null)},this.enqueueErrorEvent=function(a,b){var c={};c[q.REQUEST_ERROR_EVENT_KEY_MESSAGE]=a,c[q.REQUEST_ERROR_EVENT_KEY_FATAL]=b,this.enqueueEvent(q.EVENT_TYPE_ERROR,c)},this.enqueueBitrateChangeEvent=function(a,b){var c={},d={};-1>a&&(a=-1),d[q.REQUEST_KEY_BITRATE]=a,c[q.REQUEST_KEY_BITRATE]=b,this.declareStateChange(c,d)},this.enqueueSeekEvent=function(a,b){var c={};c[q.REQUEST_EVENT_KEY_SEEK_ACT_TYPE]=a,b>=0&&(c[q.REQUEST_EVENT_KEY_SEEK_TO_POS]=b),this.enqueueEvent(q.EVENT_TYPE_SEEK,c)},this.enqueueResourceChangeEvent=function(a,b){var c={},d={};null!==a&&(d[q.REQUEST_KEY_RESOURCE]=a),c[q.REQUEST_KEY_RESOURCE]=b,this.declareStateChange(c,d)},this.enqueueStreamUrlChangeEvent=function(a,b){var c={},d={};null!==a&&(d[q.REQUEST_KEY_STREAM_URL]=a),c[q.REQUEST_KEY_STREAM_URL]=b,this.declareStateChange(c,d)},this.enqueuePauseJoinChangeEvent=function(a,b){var c={},d={};d[q.REQUEST_KEY_PAUSE_JOIN]=a,c[q.REQUEST_KEY_PAUSE_JOIN]=b,this.declareStateChange(c,d)},this.enqueuePlayerStateChangeEvent=function(a,b){var c={},d={};c[q.REQUEST_KEY_PLAYER_STATE]=q.convertPlayerState(b),d[q.REQUEST_KEY_PLAYER_STATE]=q.convertPlayerState(a),this.declareStateChange(c,d)},this.declareStateChange=function(a,b){var c={};c[q.REQUEST_STATE_CHANGE_EVENT_KEY_NEW]=a,null!=b&&B.dictCount(b)>0&&(c[q.REQUEST_STATE_CHANGE_EVENT_KEY_OLD]=b),this.enqueueEvent(q.EVENT_TYPE_STATE_CHANGE,c)},this.enqueueCustomEvent=function(a,b){var c={};c[q.REQUEST_CUSTOM_EVENT_KEY_NAME]=a,c[q.REQUEST_CUSTOM_EVENT_KEY_ATTRIBUTES]=b,this.enqueueEvent(q.EVENT_TYPE_CUSTOM,c)},this.cancelHeartbeatTimer=function(){null!=o._heartbeatTimerCancel&&(o._heartbeatTimerCancel(),o._heartbeatTimerCancel=null)},this.resetHeartbeatTimer=function(){o.cancelHeartbeatTimer();var a=1e3*o._clientSettings.heartbeatInterval;o._heartbeatTimerCancel=o._timer.create(o.sendHeartbeat,a,"Session.sendHeartbeat")},this.createHeartbeatInfo=function(){var a={};a.err="pending",a.seq=o._heartbeatSequenceNumber-1,a.sentAt=o.getSessionTime(),a.rtt=-1,o._heartbeatInfos.push(a)},this.updateHeartbeatInfoOnFailure=function(a,b){for(var c=0;c<o._heartbeatInfos.length;c++){var d=o._heartbeatInfos[c],e=d.seq;e===a&&(d.rtt=o.getSessionTime()-d.sentAt,d.err=b)}},this.updateHeartbeatInfoOnSuccess=function(a){for(var b=0;b<o._heartbeatInfos.length;b++){var c=o._heartbeatInfos[b],d=c.seq;d===a&&(c.rtt=o.getSessionTime()-c.sentAt,c.err="ok")}},this.removeOutdatedHeartbeatInfos=function(){for(var a,b,c=o._clientConfig.get(x.CONFIG_KEY_MAX_HEARTBEAT_INFOS),d=[],e=0;e<o._heartbeatInfos.length;e++)b=o._heartbeatInfos[e],a=b.seq,a<o._heartbeatSequenceNumber-c&&d.push(e);for(var f=[],g=0;g<o._heartbeatInfos.length;g++)b=o._heartbeatInfos[g],a=b.seq,d.indexOf(g)<0&&f.push(o._heartbeatInfos[g]);o._heartbeatInfos=f},this.compileHeartbeatInfos=function(){o.removeOutdatedHeartbeatInfos();for(var a=[],b=0;b<o._heartbeatInfos.length;b++){var c=o._heartbeatInfos[b],d={};d[q.REQUEST_HEARTBEAT_INFO_KEY_SEQUENCE_NUMBER]=c.seq,d[q.REQUEST_HEARTBEAT_INFO_KEY_ROUNDTRIP_TIME]=c.rtt,d[q.REQUEST_HEARTBEAT_INFO_KEY_STATUS]=c.err,a.push(d)}return a},this.makeHeartbeat=function(){var a=new s;if(a.setMessageType(q.MESSAGE_TYPE_SESSION_HEARTBEAT),a.setCustomerKey(o._clientSettings.customerKey),a.setClientId(o._clientConfig.get(x.CONFIG_KEY_CLIENT_ID)),a.setSessionId(o._session._id),a.setSequenceNumber(o._heartbeatSequenceNumber),a.setProtocolVersion(q.version),a.setClientVersion(b.version),a.setInstanceId(o._client.getId()),a.setCapfield(0),a.setPlatformMetadataSchema(q.SDK_METADATA_SCHEMA),null!=o._browserName&&a.setBrowserName(o._browserName),null!=o._browserVersion&&a.setBrowserVersion(o._browserVersion),null!=o._deviceBrand&&a.setDeviceBrand(o._deviceBrand),null!=o._deviceManufacturer&&a.setDeviceManufacturer(o._deviceManufacturer),null!=o._deviceModel&&a.setDeviceModel(o._deviceModel),null!=o._deviceType&&a.setDeviceType(o._deviceType),null!=o._deviceVersion&&a.setDeviceVersion(o._deviceVersion),null!=o._frameworkName&&a.setFrameworkName(o._frameworkName),null!=o._frameworkVersion&&a.setFrameworkVersion(o._frameworkVersion),null!=o._operatingSystemName&&a.setOperatingSystemName(o._operatingSystemName),null!=o._operatingSystemVersion&&a.setOperatingSystemVersion(o._operatingSystemVersion),null!=o._viewerId&&a.setViewerId(o._viewerId),null!=o._playerName&&a.setPlayerName(o._playerName),B.dictCount(o._tags)>0&&a.setTags(o._tags),o.isVideoSession()){null!=o._assetName&&a.setAssetName(o._assetName),null!=o._isLive&&a.setIsLive(o._isLive),a.setSessionFlags(o._sessionFlags);var c=q.convertPlayerState(o._playerState);a.setPlayerState(c),a.setPauseJoin(o._pauseJoin),o._contentLengthSec>0&&a.setContentLength(o._contentLengthSec),o._bitrateKbps>0&&a.setBitrate(o._bitrateKbps),null!==o._resource&&a.setResource(o._resource),o._encodedFrameRate>0&&a.setEncodedFrameRate(o._encodedFrameRate),o._averageFrameRate>=0&&a.setAverageFrameRate(o._averageFrameRate),a.setPlayheadTime(o._playheadTimeMs),a.setBufferLength(o._bufferLengthMs),null!=o._streamUrl&&a.setStreamUrl(o._streamUrl)}else a.setSessionFlags(q.SessionFlags.GLOBAL);a.setCapabilities(o._capabilities);var d=o._eventQueue.flush();if(o.isGlobalSession()&&0===d.length)return null;if(a.setEvents(d),a.setIsSdkClient(!0),o._clientConfig.get(x.CONFIG_KEY_SEND_LOGS)&&a.setLogs(o._logBuffer.flush()),o._clientConfig.get(x.CONFIG_KEY_MAX_HEARTBEAT_INFOS)>0){var e=o.compileHeartbeatInfos();e.length>0&&a.setHeartbeatInfos(e)}return a.setSessionStartTime(o._startTimeMs),a.setSessionTime(o.getSessionTime()),o._heartbeatSequenceNumber++,a.get()},this.sendHeartbeat=function(){if(!o._cleanedUp){var a=o.makeHeartbeat();null!=a&&o.postHeartbeat(a)}},this.postHeartbeat=function(a){o.createHeartbeatInfo();var b=o._heartbeatSequenceNumber-1;o._logger.info("postHeartbeat(): Send HB["+b+"]"+o.sessionTypeTag());var c=function(a,c){o.onHeartbeatResponse(a,c,b)};o._gatewayControl.send(a,c)},this.onHeartbeatResponse=function(a,b,c){o._cleanedUp||o._exceptionCatcher.runProtected("onHeartbeatResponse",function(){if(a){var d=b;if(null!=d){o._logger.debug("onHeartbeatResponse(): received valid response for HB["+c+"]"),o.updateHeartbeatInfoOnSuccess(c);var e=d[q.RESPONSE_KEY_CLIENT_ID];null!=e&&e!=o._clientConfig.get(x.CONFIG_KEY_CLIENT_ID)&&(o._logger.debug("onHeartbeatResponse(): setting the client id to "+e+" (from gateway)"),o._clientConfig.set(x.CONFIG_KEY_CLIENT_ID,e),o._clientConfig.save());var f=d[q.RESPONSE_KEY_STATUS];null!=f&&f!=q.RESPONSE_STATUS_NO_ERRORS&&o._logger.error("onHeartbeatResponse(): error from gateway: "+f);var g=d[q.RESPONSE_KEY_CONFIG];if("object"==typeof g){var h=g[q.RESPONSE_CONFIG_KEY_MAX_HEARTBEAT_INFOS];null!=h&&o._clientConfig.get(x.CONFIG_KEY_MAX_HEARTBEAT_INFOS)!==h&&(o._logger.debug("onHeartbeatResponse(): setting Maximum Heartbeat Infos to "+h+" (from gateway)"),o._clientConfig.set(x.CONFIG_KEY_MAX_HEARTBEAT_INFOS,h));var i=g[q.RESPONSE_CONFIG_KEY_SEND_LOGS],j=null!=i?B.AsBoolean(i):!1;j!==o._clientConfig.get(x.CONFIG_KEY_SEND_LOGS)&&(o._logger.debug("onHeartbeatResponse(): turning "+(j?"on":"off")+" sending of logs"),o._clientConfig.set(x.CONFIG_KEY_SEND_LOGS,j));var k=g[q.RESPONSE_CONFIG_KEY_HEARTBEAT_INTERVAL];if(null!=k){var l=B.Int32.Cast(k),m=l;m!=o._clientSettings.heartbeatInterval&&(o._logger.debug("onHeartbeatResponse(): received hbIntervalMs from gateway: "+m),o._clientSettings.heartbeatInterval=m,null!=o._heartbeatTimerCancel&&o.resetHeartbeatTimer())}var n=g[q.RESPONSE_CONFIG_KEY_GATEWAY_URL];null!=n&&n!=o._clientSettings.gatewayUrl&&(o._logger.debug("onHeartbeatResponse(): received gatewayUrl from gateway: "+n),o._clientSettings.gatewayUrl=n)}}else o._logger.warning("onHeartbeatResponse(): decoded heartbeat response is null.")}else{var p=b;B.isValidString(p)?B.stringStartsWith(p,"HTTP timeout")?o._logger.warning("onHeartbeatResponse(): "+p):o._logger.error("onHeartbeatResponse(): failed to send heartbeat: "+p):(p=u.DEFAULT_HEARTBEAT_ERROR_MESSAGE,o._logger.error("onHeartbeatResponse(): "+p)),o.updateHeartbeatInfoOnFailure(c,p)}})},this.getSessionTime=function(){var a=B.Int32.Cast(o._time.current()-o._startTimeMs);return a},this.getNextEventNumber=function(){return this._eventQueue.getNumber()},this.sessionTypeTag=function(){return this.isGlobalSession()?" (global session)":""},this.isGlobalSession=function(){return this._global},this.isVideoSession=function(){return!this._global}};t.DEFAULT_VIDEO_SESSION_FLAGS=q.SessionFlags.VIDEO+q.SessionFlags.QUALITY_METRICS+q.SessionFlags.BITRATE_METRICS;var u=(a.IMonitor=function(){this.onPlayerStateChange=function(a){},this.onBitrateChange=function(a){},this.onSeekEvent=function(a,b){},this.onEncodedFrameRateChange=function(a){},this.onRenderedFrameRateChange=function(a){},this.onContentLengthChange=function(a){},this.onPlayheadTimeChange=function(a){},this.onStreamUrlChange=function(a){},this.onBufferLengthChange=function(a){},this.onPlayerTypeChange=function(a){},this.onPlayerVersionChange=function(a){},this.onError=function(a,b){},this.onRelease=function(){}},a.Session=function(){function a(a,b,c,d,e,f,g,h){this._id=a,this._global=b,this._contentMetadata=c,this._clientConfig=d,this._systemMetadata=e,this._cwsSession=f,this._exceptionCatcher=g,this._logger=h,this._logger.setModuleName("Session"),this._logger.setSessionId(B.ToString(this._id))}var b=this;b._contentMetadata=null,b._playerStateManager=null,b._id=0,b._global=!1,b._cleaningUp=!1,b._cleanedUp=!1,b._adPlaying=!1,b._adStream=null,b._adPlayer=null,b._adPosition=null,b._ignorePlayerState=!1,b._pooledPlayerState=g.PlayerState.NOT_MONITORED,b._ignoreBitrateAndResource=!1,b._ignorePlayheadTimeandBufferLength=!1,b._ignoreEncodedFrameRateAndDuration=!1,b._ignoreError=!1,b._playingFpsObservationCount=0,b._playingFpsTotal=0,a.apply(b,arguments),this.start=function(){if(b.isVideoSession()?b._logger.info("start(): assetName="+b._contentMetadata.assetName):b._logger.info("start()"+b.sessionTypeTag()),b._cwsSession.start(this),b._clientConfig.isReady())b.initiateSession();else{var a=function(){b.initiateSession()};b._clientConfig.register(a)}},this.cleanup=function(){if(b._logger.info("cleanup()"+b.sessionTypeTag()),b._cleaningUp=!0,b._cwsSession.willEndSoon(),b._clientConfig.isReady())b.endCwsSessionAndCleanupAll();else{var a=function(){b.endCwsSessionAndCleanupAll()};b._clientConfig.register(a)}},this.cleanupAll=function(){b._logger.debug("cleanupAll()"+b.sessionTypeTag()),b.isVideoSession()&&null!=b._playerStateManager&&b.detachPlayer(),b._contentMetadata=null,b._logger.setSessionId(null),b._logger=null,b._exceptionCatcher=null,b._client=null,b._clientConfig=null,b._systemMetadata=null,b._cwsSession.cleanup(),b._cwsSession=null,b._cleanedUp=!0},this.endCwsSessionAndCleanupAll=function(){b._cwsSession.end(),b.cleanupAll()},this.initiateSession=function(){b._cwsSession.initialize(),b.setStatesFromSystemMetadata(),b.isVideoSession()&&b.setStatesFromContentMetadata(),b._cwsSession.startSendingHeartbeats()},this.setStatesFromSystemMetadata=function(){b._logger.debug("setStatesFromSystemMetadata()");var a=b._systemMetadata.get(),c=a[J.BROWSER_NAME];null!=c&&b._cwsSession.setBrowserName(c);var d=a[J.BROWSER_VERSION];null!=d&&b._cwsSession.setBrowserVersion(d);var e=a[J.DEVICE_BRAND];null!=e&&b._cwsSession.setDeviceBrand(e);var f=a[J.DEVICE_MANUFACTURER];null!=f&&b._cwsSession.setDeviceManufacturer(f);var g=a[J.DEVICE_MODEL];null!=g&&b._cwsSession.setDeviceModel(g);var h=a[J.DEVICE_TYPE];null!=h&&b._cwsSession.setDeviceType(h);var i=a[J.DEVICE_VERSION];null!=i&&b._cwsSession.setDeviceVersion(i);var j=a[J.FRAMEWORK_NAME];null!=j&&b._cwsSession.setFrameworkName(j);var k=a[J.FRAMEWORK_VERSION];null!=k&&b._cwsSession.setFrameworkVersion(k);var l=a[J.OPERATING_SYSTEM_NAME];null!=l&&b._cwsSession.setOperatingSystemName(l);var m=a[J.OPERATING_SYSTEM_VERSION];null!=m&&b._cwsSession.setOperatingSystemVersion(m)},this.setStatesFromContentMetadata=function(){if(b._logger.debug("setStatesFromContentMetadata()"),b._contentMetadata.defaultBitrateKbps>0&&b._cwsSession._bitrateKbps<0&&b._cwsSession.setBitrateKbps(b._contentMetadata.defaultBitrateKbps),null!=b._contentMetadata.defaultResource&&null==b._cwsSession._resource&&b._cwsSession.setResource(b._contentMetadata.defaultResource),null!=b._contentMetadata.streamUrl&&null==b._cwsSession._streamUrl&&b._cwsSession.setStreamUrl(b._contentMetadata.streamUrl),b._contentMetadata.duration>0&&b._cwsSession.setContentLength(b._contentMetadata.duration),b._contentMetadata.encodedFrameRate>0&&b._cwsSession.setEncodedFrameRate(b._contentMetadata.encodedFrameRate),b._contentMetadata.streamType!==d.StreamType.UNKNOWN){var a=b._contentMetadata.streamType===d.StreamType.LIVE;b._cwsSession.setIsLive(a)}null!=b._contentMetadata.assetName&&b._cwsSession.setAssetName(b._contentMetadata.assetName),null!=b._contentMetadata.viewerId&&b._cwsSession.setViewerId(b._contentMetadata.viewerId),null!=b._contentMetadata.applicationName&&b._cwsSession.setPlayerName(b._contentMetadata.applicationName),B.dictCount(b._contentMetadata.custom)>0&&b._cwsSession.setTags(b._contentMetadata.custom)},this.setRenderedFrameRate=function(a){b._renderedFrameRate=a,b.updateAverageFrameRate()},this.updateAverageFrameRate=function(){if(b._cwsSession._playerState===g.PlayerState.PLAYING){var a=b._renderedFrameRate;if(a>=0){b._playingFpsTotal+=a,b._playingFpsObservationCount++;var c=B.Int32.Cast(1*b._playingFpsTotal/b._playingFpsObservationCount);b._cwsSession.setAverageFrameRate(c)}}},this.onPlayerStateChange=function(a){return b._logger.debug("onPlayerStateChange(): "+a),b._cwsSession._playerState!=a?(b._cwsSession._playerState==g.PlayerState.NOT_MONITORED&&a!=g.PlayerState.NOT_MONITORED&&(b._pooledPlayerState=a),b._ignorePlayerState?void b._logger.debug("onPlayerStateChange(): "+a+" (pooled, "+(b._adPlaying?"ad playing":"preloading")+")"):void b._cwsSession.setPlayerState(a)):void 0},this.onBitrateChange=function(a){return b._logger.debug("onBitrateChange(): "+a),b._ignoreBitrateAndResource?void b._logger.info("onBitrateChange(): ignored"):void b._cwsSession.setBitrateKbps(a)},this.onSeekEvent=function(a,c){b._cwsSession.enqueueSeekEvent(a,c)},this.onRenderedFrameRateChange=function(a){b._logger.debug("onRenderedFrameRateChange(): "+a),b._ignoreEncodedFrameRateAndDuration?b._logger.info("onRenderedFrameRateChange(): Ignored rendered frame rate data: "+a+" (ads)"):(b.setRenderedFrameRate(a),b._logger.info("onRenderedFrameRateChange(): Received rendered frame rate data: "+a))},this.onEncodedFrameRateChange=function(a){b._logger.debug("onEncodedFrameRateChange(): "+a),b._contentMetadata.encodedFrameRate>0||(a>0?b._ignoreEncodedFrameRateAndDuration?b._logger.info("onEncodedFrameRateChange(): Ignored encoded frame rate data: "+a+" (ads)"):(b._cwsSession.setEncodedFrameRate(a),b._logger.info("onEncodedFrameRateChange(): Received encoded frame rate data: "+a)):b._logger.warning("onEncodedFrameRateChange(): Ignored invalid encoded frame rate data: "+a))},this.onContentLengthChange=function(a){b._logger.debug("onContentLengthChange(): "+a),b._contentMetadata.duration>0||(a>0?b._ignoreEncodedFrameRateAndDuration?b._logger.info("setContentLength(): Ignored content length data: "+a+" (ads)"):(b._cwsSession.setContentLength(a),b._logger.info("setContentLength(): Received content length data: "+a)):b._logger.warning("setContentLength(): Ignored invalid content length data: "+a))},this.onStreamUrlChange=function(a){b._logger.debug("onStreamUrlChange(): "+a),b._cwsSession.setStreamUrl(a)},this.onPlayheadTimeChange=function(a){b._ignorePlayheadTimeandBufferLength||b._cwsSession.setPlayheadTimeMs(a)},this.onBufferLengthChange=function(a){b._ignorePlayheadTimeandBufferLength||b._cwsSession.setBufferLengthMs(a)},this.onPlayerTypeChange=function(a){b._logger.debug("onPlayerTypeChange(): "+a),null==b._cwsSession.getFrameworkName()&&b._cwsSession.setFrameworkName(a)},this.onPlayerVersionChange=function(a){b._logger.debug("onPlayerVersionChange(): "+a),null==b._cwsSession.getFrameworkVersion()&&b._cwsSession.setFrameworkVersion(a)},this.onError=function(a,c){b._logger.debug("onError(): "+a+" ("+c+")"),b.reportError(a,c)},this.onRelease=function(){b._logger.debug("onRelease()"),b.detachPlayer()},this.adStart=function(a,c,d){return b._logger.debug("adStart(): adStream="+a+" adPlayer="+c+" adPosition="+d),b._adPlaying?void b._logger.warning("adStart(): multiple adStart calls, ignoring"):(b._adPlaying=!0,b._adStream=a,b._adPlayer=c,b._adPosition=d,b._cwsSession._hasJoined||b._cwsSession.togglePauseJoin(!0),void(b._adStream==Conviva.Client.AdStream.CONTENT||b._adPlayer==Conviva.Client.AdPlayer.SEPARATE?(b._cwsSession._playerState!==g.PlayerState.NOT_MONITORED&&(b._pooledPlayerState=b._cwsSession._playerState),b._cwsSession.setPlayerState(g.PlayerState.NOT_MONITORED),b._ignorePlayerState=!0):b._adStream==Conviva.Client.AdStream.SEPARATE&&b._adPlayer==Conviva.Client.AdPlayer.CONTENT&&(b._cwsSession._playerState!==g.PlayerState.NOT_MONITORED&&(b._pooledPlayerState=b._cwsSession._playerState),b._cwsSession.setPlayerState(g.PlayerState.NOT_MONITORED),b._ignorePlayerState=!0,b._ignoreBitrateAndResource=!0,b._ignoreEncodedFrameRateAndDuration=!0,b._ignorePlayheadTimeandBufferLength=!0,b._ignoreError=!0)))},this.adEnd=function(){return b._logger.debug("adEnd()"),b._adPlaying?(b._cwsSession._hasJoined||b._cwsSession.togglePauseJoin(!1),b._adStream==Conviva.Client.AdStream.CONTENT||b._adPlayer==Conviva.Client.AdPlayer.SEPARATE?b._preloading||(b._ignorePlayerState=!1,b._cwsSession.setPlayerState(b._pooledPlayerState)):b._adStream==Conviva.Client.AdStream.SEPARATE&&b._adPlayer==Conviva.Client.AdPlayer.CONTENT&&(b._ignoreBitrateAndResource=!1,b._ignoreEncodedFrameRateAndDuration=!1,b._ignorePlayheadTimeandBufferLength=!1,b._ignoreError=!1,b._preloading||(b._ignorePlayerState=!1,b._cwsSession.setPlayerState(b._pooledPlayerState))),b._adPlaying=!1,void(b._adStream=b._adPlayer=b._adPosition=null)):void b._logger.debug("adEnd(): called before adStart, ignoring")},this.detachPlayer=function(){b._logger.debug("detachPlayer()"),null!==b._playerStateManager&&(b._exceptionCatcher.runProtected("Session.detachPlayer",function(){b._playerStateManager.removeMonitoringNotifier()}),b._playerStateManager=null,b._cwsSession.setPlayerState(g.PlayerState.NOT_MONITORED))},this.attachPlayer=function(a){return b._logger.debug("attachPlayer()"),null!=b._playerStateManager?void b._logger.error("attachPlayer(): detach current PlayerStateManager first"):void b._exceptionCatcher.runProtected("Session.attachPlayer()",function(){a.setMonitoringNotifier(b,b._id)?(a.pushCurrentState(),b._playerStateManager=a):b._logger.error("attachPlayer(): instance of PlayerStateManager is already attached to a session")})},this.contentPreload=function(){return b._logger.debug("contentPreload()"),b._preloading?void b._logger.debug("contentPreload(): called twice, ignoring"):(b._preloading=!0,void(b._ignorePlayerState=!0))},this.contentStart=function(){return b._logger.debug("contentStart()"),b._preloading?(b._preloading=!1,void(b._adPlaying||(b._ignorePlayerState=!1,b._cwsSession.setPlayerState(b._pooledPlayerState)))):void b._logger.warning("contentStart(): called without contentPreload, ignoring")},this.reportError=function(a,c){if(b._logger.info("reportError(): "+a),!B.isValidString(a))return void b._logger.error("reportError(): invalid error message string: "+a);if(c!==Conviva.Client.ErrorSeverity.FATAL&&c!==Conviva.Client.ErrorSeverity.WARNING)return void b._logger.error("reportError(): invalid error severity: "+c);if(b._ignoreError)return void b._logger.debug("reportError(): ignored");var d=c===Conviva.Client.ErrorSeverity.FATAL;b._cwsSession.sendError(a,d)},this.updateContentMetadata=function(a){b._logger.debug("updateContentMetadata(): enter"),b._exceptionCatcher.runProtected("Session.updateContentMetadata",function(){b.mergeContentMetadata(a),b.setStatesFromContentMetadata()})},this.sendCustomEvent=function(a,c){b._logger.info("sendEvent(): eventName="+a+b.sessionTypeTag()),b._cwsSession.enqueueCustomEvent(a,c)},this.mergeContentMetadata=function(a){null==b._contentMetadata.assetName?B.isValidString(a.assetName)&&(b._contentMetadata.assetName=a.assetName,b._cwsSession.enqueueAssetNameChangeEvent(b._contentMetadata.assetName)):b._logger.warning("mergeContentMetadata(): assetName was already set."),null==b._contentMetadata.applicationName?B.isValidString(a.applicationName)&&(b._contentMetadata.applicationName=a.applicationName):b._logger.warning("mergeContentMetadata(): applicationName was already set."),null==b._contentMetadata.streamUrl?B.isValidString(a.streamUrl)&&(b._contentMetadata.streamUrl=a.streamUrl):b._logger.warning("mergeContentMetadata(): streamUrl was already set."),null==b._contentMetadata.viewerId?B.isValidString(a.viewerId)&&(b._contentMetadata.viewerId=a.viewerId):b._logger.warning("mergeContentMetadata(): viewerId was already set."),b._contentMetadata.defaultBitrateKbps<=0?a.defaultBitrateKbps>0&&(b._contentMetadata.defaultBitrateKbps=a.defaultBitrateKbps):b._logger.warning("mergeContentMetadata(): defaultBitrateKbps was already set."),
null==b._contentMetadata.defaultResource?B.isValidString(a.defaultResource)&&(b._contentMetadata.defaultResource=a.defaultResource):b._logger.warning("mergeContentMetadata(): defaultResource was already set."),b._contentMetadata.duration<=0?a.duration>0&&(b._contentMetadata.duration=a.duration):b._logger.warning("mergeContentMetadata(): duration was already set."),b._contentMetadata.encodedFrameRate<=0?a.encodedFrameRate>0&&(b._contentMetadata.encodedFrameRate=a.encodedFrameRate):b._logger.warning("mergeContentMetadata(): encodedFrameRate was already set."),b._contentMetadata.streamType==d.StreamType.UNKNOWN?a.streamType!=d.StreamType.UNKNOWN&&(b._contentMetadata.streamType=a.streamType):b._logger.warning("mergeContentMetadata(): streamType was already set.");var c={};for(var e in a.custom){var f=b._contentMetadata.custom[e];null==f?c[e]=a.custom[e]:b._logger.warning("mergeContentMetadata(): custom."+e+" was already set.")}if(B.dictCount(c)>0){var g={};for(e in b._contentMetadata.custom)g[e]=b._contentMetadata.custom[e];for(e in c)g[e]=c[e];b._contentMetadata.custom=g}},this.isGlobalSession=function(){return b._global},this.isVideoSession=function(){return!b._global},this.sessionTypeTag=function(){return b.isGlobalSession()?" (global session)":""}});u.DEFAULT_HEARTBEAT_ERROR_MESSAGE="received no response (or a bad response) to heartbeat POST request";var v=a.SessionFactory=function(){function a(a,c,d,e){b._client=a,b._clientSettings=c,b._clientConfig=d,b._systemFactory=e,b._logger=b._systemFactory.buildLogger(),b._logger.setModuleName("SessionFactory"),b._nextSessionKey=0,b._sessionsByKey={}}var b=this;b._logger=null,b._logBuffer=null,b._nextSessionKey=0,b._sessionsByKey=null,a.apply(b,arguments),this.cleanup=function(){b._logger=null,b._logBuffer=null;for(var a in b._sessionsByKey){var c=b._sessionsByKey[a];c.cleanup()}b._sessionsByKey=null,b._nextSessionKey=0},this.newSessionKey=function(){var a=b._nextSessionKey;return b._nextSessionKey++,a},this.makeVideoSession=function(a){return null==a&&(a=new d),b.makeSession(a,!1)},this.makeGlobalSession=function(a){return b.makeSession(a,!0)},this.generateSessionId=function(){return E.integer32()},this.makeSession=function(a,c){var d=a.clone(a),e=b.generateSessionId(),f=b._systemFactory.buildSession(b._client,b._clientSettings,b._clientConfig,e,c,d),g=b.newSessionKey();return b.addSession(g,f),f.start(),g},this.getSession=function(a){var c=b._sessionsByKey[a];return null==c&&b._logger.error("Client: invalid sessionKey. Did you cleanup that session previously?"),c},this.getVideoSession=function(a){var c=this.getSession(a);return null!=c&&(c.isVideoSession()||(b._logger.error("Client: invalid sessionKey. Did you cleanup that session previously?"),c=null)),c},this.addSession=function(a,c){b._sessionsByKey[a]=c},this.removeSession=function(a){delete b._sessionsByKey[a]},this.cleanupSession=function(a){var c=b.getSession(a);b.removeSession(a),c.cleanup()}},w=a.CallbackWithTimeout=function(a){this._timer=a,this.getWrapperCallback=function(a,b,c){var d=!1,e=function(){d||(d=!0,a(!1,c+" ("+b+" ms)"))};this._timer.createOnce(e,b,"CallbackWithTimeout.wrap");var f=function(b,c){d||(d=!0,a(b,c))};return f}},x=a.Config=function(a,b,c){var d=this;this._logger=a,this._logger.setModuleName("Config"),this._storage=b,this._jsonInterface=c,this._defaultConfig={clientId:q.DEFAULT_CLIENT_ID,sendLogs:!1,maxHbInfos:q.DEFAULT_MAX_HEARTBEAT_INFOS},this._config=B.ObjectShallowCopy(this._defaultConfig),this._loaded=!1,this._loadedEmpty=!1,this._waitingConsumers=[],this.isReady=function(){return this._loaded},this.load=function(){var a=function(a,b){a?(d._parse(b),d._logger.debug("load(): configuration successfully loaded from local storage"+(d._loadedEmpty?" (was empty)":"")+".")):d._logger.error("load(): error loading configuration from local storage: "+b),d._loaded=!0,d._notify()};this._storage.load(x.STORAGE_KEY,a)},this._parse=function(a){var b=this._jsonInterface.decode(a);if(null==b)return void(this._loadedEmpty=!0);var c=b[x.CONFIG_STORAGE_KEY_CLIENT_ID];null!=c&&c!=q.DEFAULT_CLIENT_ID&&""!=c&&"null"!=c&&(this._config[x.CONFIG_KEY_CLIENT_ID]=c,this._logger.debug("parse(): loaded clientId="+c+" (from local storage)"))},this._marshall=function(){var a={};return a[x.CONFIG_STORAGE_KEY_CLIENT_ID]=this._config.clientId,this._logger.debug("_marshall(): saving clientId="+this._config.clientId+" (to local storage)"),this._jsonInterface.encode(a)},this.save=function(){var a=function(a,b){a?d._logger.debug("save(): configuration successfully saved to local storage."):d._logger.error("save(): error saving configuration to local storage: "+b)};this._storage.save(x.STORAGE_KEY,this._marshall(),a)},this.register=function(a){return this.isReady()?void a():void this._waitingConsumers.push(a)},this.get=function(a){return this._loaded?this._config[a]:null},this.set=function(a,b){this._loaded&&(this._config[a]=b)},this._notify=function(){for(var a;null!=(a=this._waitingConsumers.shift());)a()}};x.STORAGE_KEY="sdkConfig",x.CONFIG_STORAGE_KEY_CLIENT_ID="clId",x.CONFIG_KEY_CLIENT_ID="clientId",x.CONFIG_KEY_SEND_LOGS="sendLogs",x.CONFIG_KEY_MAX_HEARTBEAT_INFOS="maxHbInfos";var y=a.EventQueue=function(){this._events=[],this._nextEventNumber=0,this.enqueue=function(a){this._events.push(a)},this.getNumber=function(){var a=this._nextEventNumber;return this._nextEventNumber++,a},this.flush=function(){var a=this._events;return this._events=[],a}},z=a.ExceptionCatcher=function(a,b,c){this._logger=a,this._logger.setModuleName("ExceptionCatcher"),this._ping=b,this._systemSettings=c,this.runProtected=function(a,b,c){try{b()}catch(d){if(null!=c)c(d);else{if(this._systemSettings.allowUncaughtExceptions)throw d;this.onUncaughtException(a,d)}}},this.onUncaughtException=function(a,b){var c="Uncaught exception: "+a+": "+b.toString();if(null!=this._ping)try{this._ping.send(c)}catch(d){this._logger.error("Caught exception while sending ping: "+d.toString())}this._logger.error(c)}},A=a.GatewayControl=function(a,b,c,d){var e=this;this._clientSettings=a,this._logger=b,this._logger.setModuleName("GatewayControl"),this._httpClient=c,this._jsonInterface=d,this.send=function(a,b){var c=this._jsonInterface.encode(a),d=this._clientSettings.gatewayUrl+q.gatewayPath,f=function(a,c){if(a){var d=e._jsonInterface.decode(c);b(a,d)}else{var f=c;b(a,f)}};this._httpClient.request("POST",d,c,"application/json",f)}},B=a.Lang={};B.validateInterface=function(a,b,c){if(null==a)throw new Error("Expected "+c+" implementation is null.");for(var d in b)if("function"!=typeof a[d])throw new Error("Expected method "+d+" in "+c+" implementation.")},B.dictCount=function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},B.ToString=function(a){return""+a},B.NumberToInt=function(a){return Math.floor(a)},B.NumberToUnsignedInt=function(a){return Math.abs(B.NumberToInt(a))},B.AsBoolean=function(a){return Boolean(a)},B.isValidString=function(a){return"string"==typeof a&&""!==a},B.stringStartsWith=function(a,b){return"string"!=typeof a||"string"!=typeof b?!1:"function"==typeof a.indexOf?0===a.indexOf(b):!1},B.isBoolean=function(a){return"boolean"==typeof a},B.UrlEncodeString=function(a){return escape(a)},B.isObject=function(a){return"object"==typeof a},B.ObjectToString=function(a){var b="";for(var c in a){var d=a[c],e=d;b+=c+"="+e}return"Object{"+b+"}"},B.ObjectShallowCopyOmitNull=function(a){var b=B.ObjectShallowCopy(a);for(var c in b)null==b[c]&&delete b[c];return b},B.ObjectShallowCopy=function(a){var b={};for(var c in a)b[c]=a[c];return b},B.ObjectShallowEquals=function(a,b){if(typeof a!=typeof b)return!1;if(a instanceof Object&&b instanceof Object){if(B.dictCount(a)!==B.dictCount(b))return!1;var c=!0;for(var d in a)if(c=a[d]===b[d],!c)return!1;return!0}return a===b},B.isInteger=function(a){if("number"!=typeof a)return!1;var b=Math.round(a);return b===a},B.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},B.ArrayEquals=function(a,b){if(a===b)return!0;if(null==a||null==b)return!1;if(a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(B.isArray(a[c])&&B.isArray(b[c])){if(!B.ArrayEquals(a[c],b[c]))return!1}else if(a[c]!==b[c])return!1;return!0},B.isObjectDefinePropertyPresent=function(){return"undefined"!=typeof Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(a){return!1}}()},B.defGet=function(a,b,c){if(B.isObjectDefinePropertyPresent())Object.defineProperty(a,b,{configurable:!0,enumerable:!0,get:c});else{if("undefined"==typeof a.__defineGetter__)throw new Error("JavaScript runtime must support either Object.defineProperty or __defineGetter__");a.__defineGetter__(b,c)}},B.defSet=function(a,b,c){if(B.isObjectDefinePropertyPresent())Object.defineProperty(a,b,{configurable:!0,set:c});else{if("undefined"==typeof a.__defineSetter__)throw new Error("JavaScript runtime must support either Object.defineProperty or __defineSetter__");a.__defineSetter__(b,c)}},function(){var a={};a.two32=4294967296,a.MaxValue=a.two32-1,a.MinValue=0,B.UInt32=a,B.UInt32.Cast=function(b){var c=parseInt(b,10);return c>a.MaxValue?c%=a.two32:c<a.MinValue&&(c=-c%a.two32,c=a.two32-c),c},B.UInt32.InRange=function(b){var c=parseInt(b,10);return c<=a.MaxValue&&c>=a.MinValue};var b={};b.MaxValue=2147483647,b.MinValue=-2147483648,B.Int32=b,B.Int32.Cast=function(a){var c=parseInt(a,10);return c>b.MaxValue?c%=b.MaxValue:c<b.MinValue&&(c=-c%b.MaxValue,c=b.MaxValue-c),c},B.Int32.InRange=function(a){var c=parseInt(a,10);return c<=b.MaxValue&&c>=b.MinValue}}();var C=a.LogBuffer=function(){var a=32;this._buffer=[],this.add=function(b){this._buffer.length>=a&&this._buffer.shift(),this._buffer.push(b)},this.flush=function(){var a=this._buffer;return this._buffer=[],a}},D=a.Ping=function(a,c,d){this._isSendingPing=!1,this._cachedBasePingUrl=null,this._logger=a,this._logger.setModuleName("Ping"),this._httpClient=c,this._clientSettings=d,this.send=function(a){if(!this._isSendingPing){this._isSendingPing=!0;var b=this.getBasePingUrl()+"&d="+B.UrlEncodeString(a.toString());this._logger.error("send(): "+b),this._httpClient.request("GET",b,null,null,null),this._isSendingPing=!1}},this.getBasePingUrl=function(){if(!this._cachedBasePingUrl){var a=D.SERVICE_URL+"?comp="+D.COMPONENT_NAME+"&clv="+b.version;if(this._clientSettings&&(a+="&cid="+this._clientSettings.customerKey),a+="&sch="+q.SDK_METADATA_SCHEMA,!this._clientSettings)return a;this._cachedBasePingUrl=a}return this._cachedBasePingUrl}};D.COMPONENT_NAME="sdkjs",D.SERVICE_URL="https://pings.conviva.com/ping.ping";var E=a.Random={};E.maxUInt32=4294967295,E.maxInt32=2147483647,E.minInt32=-2147483648,E.integer32=function(){return Math.floor(Math.random()*E.maxUInt32)+E.minInt32},E.uinteger32=function(){return Math.floor(Math.random()*E.maxUInt32)};var F=a.Sanitize={};F.Integer=function(a,b,c,d){if(isNaN(a))return d;if("number"!=typeof a)return d;if(a==d)return d;var e=B.NumberToInt(a);return F.EnforceBoundaries(e,b,c)},F.EnforceBoundaries=function(a,b,c){return null!=c&&a>c?a=c:null!=b&&b>a&&(a=b),a},F.sanitizeSpecialIntegerValue=function(a){return-1==a||-2==a?a:a=F.Integer(a,0,null,-1)};var G=(a.StreamerError=function(){function a(a,b){c.errorCode=a,c.severity=b}var c=this;c.errorCode=null,c.severity=b.ErrorSeverity.FATAL,a.apply(c,arguments)},a.HttpClient=function(a,b,c,d){this._logger=a,this._logger.setModuleName("HttpClient"),this._httpInterface=b,this._callbackWithTimeout=c,this._systemSettings=d,this.request=function(a,b,c,d,e){var f=1e3*this._systemSettings.httpTimeout,g=this._callbackWithTimeout.getWrapperCallback(e,f,"HTTP timeout");this._logger.debug("request(): calling HttpInterface.makeRequest"),this._httpInterface.makeRequest(a,b,c,d,f,g)}}),H=a.Logger=function(a,b,c,d,e){this._loggingInterface=a,this._timeInterface=b,this._settings=c,this._logBuffer=d,this._packageName=e,this.debug=function(a){this.log(a,f.LogLevel.DEBUG)},this.info=function(a){this.log(a,f.LogLevel.INFO)},this.warning=function(a){this.log(a,f.LogLevel.WARNING)},this.error=function(a){this.log(a,f.LogLevel.ERROR)},this.log=function(a,b){var c=this.formatMessage(a,b);this._logBuffer.add(c),this._settings.logLevel<=b&&this._loggingInterface.consoleLog(c,b)},this.prependModuleName=function(a){var b=a;return b="["+this._moduleName+"] "+b},this.prependPackageName=function(a){var b=a;return b="["+this._packageName+"] "+b},this.prependConvivaNamespace=function(a){var b=a;return b="[Conviva] "+b},this.prependTime=function(a){var b=this._timeInterface.getEpochTimeMs(),c=(b/1e3).toFixed(3).toString();return"["+c+"] "+a},this.prependLogLevel=function(a,b){var c=H.getLogLevelString(b),d=a;return d="["+c+"] "+d},this.prependSessionId=function(a){var b=a;return null!=this._sessionId&&(b="sid="+this._sessionId+" "+b),b},this.setSessionId=function(a){this._sessionId=a},this.setModuleName=function(a){this._moduleName=a},this.formatMessage=function(a,b){return this.prependConvivaNamespace(this.prependTime(this.prependLogLevel(this.prependPackageName(this.prependModuleName(this.prependSessionId(a))),b)))}};H.getLogLevelString=function(a){var b;switch(a){case f.LogLevel.ERROR:b="ERROR";break;case f.LogLevel.WARNING:b="WARNING";break;case f.LogLevel.INFO:b="INFO";break;case f.LogLevel.DEBUG:b="DEBUG"}return b};var I=a.Storage=function(a,b,c,d){this._logger=a,this._logger.setModuleName("Storage"),this._storageInterface=b,this._callbackWithTimeout=c,this._systemSettings=d,this.load=function(a,b){var c=this._callbackWithTimeout.getWrapperCallback(b,1e3*this._systemSettings.storageTimeout,"storage load timeout");this._logger.debug("load(): calling StorageInterface.loadData"),this._storageInterface.loadData(I.STORAGE_SPACE,a,c)},this.save=function(a,b,c){var d=this._callbackWithTimeout.getWrapperCallback(c,1e3*this._systemSettings.storageTimeout,"storage save timeout");this._logger.debug("save(): calling StorageInterface.saveData"),this._storageInterface.saveData(I.STORAGE_SPACE,a,b,d)}};I.STORAGE_SPACE="Conviva";var J=a.SystemMetadata=function(a,c,d){this._logger=a,this._logger.setModuleName("SystemMetadata"),this._metadataInterface=c,this._exceptionCatcher=d,this._cachedMetadata=null,this.get=function(){return this._cachedMetadata||this.retrieve(),this._cachedMetadata},this.retrieve=function(){function a(a,b){d._exceptionCatcher.runProtected("Session.getSystemMetadataSchema(): "+a,function(){var c=b[a];b[a]=c.call(d._metadataInterface)})}var c={};c[J.BROWSER_NAME]=this._metadataInterface.getBrowserName,c[J.BROWSER_VERSION]=this._metadataInterface.getBrowserVersion,c[J.DEVICE_BRAND]=this._metadataInterface.getDeviceBrand,c[J.DEVICE_MANUFACTURER]=this._metadataInterface.getDeviceManufacturer,c[J.DEVICE_MODEL]=this._metadataInterface.getDeviceModel,c[J.DEVICE_TYPE]=this._metadataInterface.getDeviceType,c[J.DEVICE_VERSION]=this._metadataInterface.getDeviceVersion,c[J.FRAMEWORK_NAME]=this._metadataInterface.getFrameworkName,c[J.FRAMEWORK_VERSION]=this._metadataInterface.getFrameworkVersion,c[J.OPERATING_SYSTEM_NAME]=this._metadataInterface.getOperatingSystemName,c[J.OPERATING_SYSTEM_VERSION]=this._metadataInterface.getOperatingSystemVersion;var d=this;this._logger.debug("retrieve(): calling MetadataInterface methods");for(var e in c)a(e,c),B.isValidString(c[e])||delete c[e];c[J.DEVICE_TYPE]!==b.DeviceType.DESKTOP&&c[J.DEVICE_TYPE]!==b.DeviceType.CONSOLE&&c[J.DEVICE_TYPE]!==b.DeviceType.SETTOP&&c[J.DEVICE_TYPE]!==b.DeviceType.MOBILE&&c[J.DEVICE_TYPE]!==b.DeviceType.TABLET&&c[J.DEVICE_TYPE]!==b.DeviceType.SMARTTV&&delete c[J.DEVICE_TYPE],this._cachedMetadata=B.ObjectShallowCopyOmitNull(c)}};J.BROWSER_NAME="browserName",J.BROWSER_VERSION="browserVersion",J.DEVICE_BRAND="deviceBrand",J.DEVICE_MANUFACTURER="deviceManufacturer",J.DEVICE_MODEL="deviceModel",J.DEVICE_TYPE="deviceType",J.DEVICE_VERSION="deviceVersion",J.FRAMEWORK_NAME="frameworkName",J.FRAMEWORK_VERSION="frameworkVersion",J.OPERATING_SYSTEM_NAME="operatingSystemName",J.OPERATING_SYSTEM_VERSION="operatingSystemVersion";var K=a.Time=function(a,b){this._timeInterface=a,this._logger=b,this._logger.setModuleName("Time"),this.current=function(){var a=this._timeInterface.getEpochTimeMs();return B.isInteger(a)||this._logger.error("current(): TimeInterface.getEpochTimeMs() did not return an integer ("+a+")"),a}},L=a.Timer=function(a,b,c){var d=this;this._logger=a,this._logger.setModuleName("Timer"),this._timerInterface=b,this._exceptionCatcher=c,this.create=function(a,b,c){var e=function(){d._exceptionCatcher.runProtected(c,function(){a()})},f=this.createTimer(e,b,c);return f},this.createOnce=function(a,b,c){var e={cancel:null},f=function(){d._exceptionCatcher.runProtected(c,function(){e&&"function"==typeof e.cancel&&(e.cancel(),e.cancel=null,e=null),a()})},g=this.createTimer(f,b,c);return e.cancel=g,g},this.createTimer=function(a,b,c){return this._logger.debug("createTimer(): calling TimerInterface.create"),this._timerInterface.createTimer(a,b,c)}}}(),Conviva.Client=a.Client,Conviva.ContentMetadata=a.ContentMetadata,Conviva.PlayerStateManager=a.PlayerStateManager,Conviva.SystemSettings=a.SystemSettings,Conviva.ClientSettings=a.ClientSettings,Conviva.SystemInterface=a.SystemInterface,Conviva.HttpInterface=a.HttpInterface,Conviva.TimeInterface=a.TimeInterface,Conviva.TimerInterface=a.TimerInterface,Conviva.LoggingInterface=a.LoggingInterface,Conviva.MetadataInterface=a.MetadataInterface,Conviva.StorageInterface=a.StorageInterface,Conviva.SystemFactory=a.SystemFactory}})();module.exports=Conviva},function(module,exports){var _0xe786=["getDeviceManufacturer","getDeviceModel","getDeviceType","getDeviceVersion","HTML5-castlabs","getFrameworkVersion","getOperatingSystemName","getOperatingSystemVersion","saveData","loadData","getEpochTimeMs","POLL_STREAMER_INTERVAL_MS","SystemInterface","object","exports","function","amd","clpp_conviva","definePlugin","registerPlugin","client","_sessionFactory","getVideoSession","sessionKey","_playerStateManager","playerStateManager","detachPlayer","getAdPodInfo","getAdId","getDuration","getTotalAds","getPodIndex","Pre-roll","podIndex","podPosition","Post-roll","Mid-roll","absoluteIndex","stringifyValuesIgnoreNull","Conviva","SystemSettings","Html5SystemInterfaceFactory","SystemFactory","ClientSettings","customerKey","gatewayUrl","serviceUrl","conviva plugin","onInit","getConvivaOptions","createConvivaMetadata","getPlayerStateManager","createSession","debug","scrubbing","paused","currentTime","html5PlayerInterface","onLoadedMetaData","updateContentMetadata","msg","sendError","ErrorSeverity","FATAL","onStop","onPlay","onPlaying","sendCustomEvent","onAdStarted","Conviva.PodStart","isAdFirstPart","adStart","AdStream","SEPARATE","Client","PREROLL","onAdFinished","Conviva.PodEnd","adEnd","onAdPaused","AD.PAUSED","onAdResumed","AD.RESUMED","onAdClicked","AD.CLICKED","onBitrateChanged","debugTime","getTime","onDestroy","setTimeout","cleanup","start","cl_$d","Html5PlayerInterface._constr()","Html5PlayerInterface: playerStateManager argument cannot be null.","cl_eh","cl_ih","cl_nh","cl_rh","cl_sh","cl_oh","cl_ah","cl_ch","cl_uh","cl_dh","cl_hh","cl_lh","cl_th","push","el_","ended","cl_fh","pause","playing","emptied","waiting","error","CLPPError","instanceof","code","cl__h","cl_gh","seeking","isSeekStarted","player is seeeking","setPlayerSeekEnd","cl_yh","length","cl_ph","readyState","cl_mh","undefined","PlayerStateManager","PlayerState","cl_Ah","STOPPED","PAUSED","PLAYING","cl_vh","Received HTML5 event: ",". Mapped to Conviva player state: ","getPlayerState","setPlayerState","BUFFERING","UNKNOWN","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_UNKNOWN"," message=","duration","setDuration","cl_Sh","cl_Eh","cl_bh","createTimer","cl_Ph","cl_wh","cl_kh","cl_Ih","now","cl_Rh","PAUSED_STATE_ON_CONSTANT_PHT_POLL_COUNT","PLAY_STATE_ON_MOVING_PHT_POLL_COUNT","buffered","end","min","slice","PHT_PLAY_EXPECTED_SPEED","PHT_PLAY_TOLERANCE","playbackRate","prototype","toString","call","HTMLElement","indexOf","Constructor","abs","Adjusting Conviva player state to: PLAYING","PHT_PAUSED_EXPECTED_SPEED","Adjusting Conviva player state to: PAUSED","Adjusting Conviva player state to: BUFFERING","cl_Lh","[Html5PlayerInterface] ","consoleLog","apply","makeRequest","makeRequestStandard","open","overrideMimeType","setRequestHeader","timeout","ontimeout","onreadystatechange","timeout after "," ms","responseText","http status ","status","send","release","log","DEBUG","LogLevel","INFO","warn","ERROR","getBrowserName","getBrowserVersion","getDeviceBrand"];(function(_0x1c34e8,_0x5bc5fa){var _0x41ff2d=function(_0x26312d){while(--_0x26312d){_0x1c34e8["push"](_0x1c34e8["shift"]())}};_0x41ff2d(++_0x5bc5fa)})(_0xe786,223);var _0x6e78=function(_0x102c0a,_0x3a7884){_0x102c0a=_0x102c0a-0;var _0x437305=_0xe786[_0x102c0a];return _0x437305};!function(e,t){"object"==typeof exports&&_0x6e78("0x0")==typeof module?module[_0x6e78("0x1")]=t():_0x6e78("0x2")==typeof define&&define[_0x6e78("0x3")]?define([],t):_0x6e78("0x0")==typeof exports?exports[_0x6e78("0x4")]=t():e[_0x6e78("0x4")]=t()}(this,function(){return webpackJsonpclpp__name_([10],{0:function(e,t,i){var n,r,s,o,a,c=i(34),u=i(17),d=i(1),h=i(118),l=_0x6e78("0x4");d[_0x6e78("0x5")](l,t),t[_0x6e78("0x6")]=function(e,t){function i(e){e[_0x6e78("0x7")][_0x6e78("0x8")][_0x6e78("0x9")](e[_0x6e78("0xa")])[_0x6e78("0xb")]||e[_0x6e78("0x7")]["attachPlayer"](e[_0x6e78("0xa")],e[_0x6e78("0xc")])}function l(e){e[_0x6e78("0x7")]["_sessionFactory"][_0x6e78("0x9")](e[_0x6e78("0xa")])[_0x6e78("0xb")]&&e[_0x6e78("0x7")][_0x6e78("0xd")](e[_0x6e78("0xa")])}function p(e){var t=e["getAd"](),i=t[_0x6e78("0xe")](),n={id:t[_0x6e78("0xf")](),title:t["getTitle"](),podDuration:t[_0x6e78("0x10")]()};if(i[_0x6e78("0x11")]()>1&&(n["podDuration"]=0),i){var r=i[_0x6e78("0x12")]();0===r?(n["podPosition"]=_0x6e78("0x13"),n[_0x6e78("0x14")]=1):r===-1?(n[_0x6e78("0x15")]=_0x6e78("0x16"),n[_0x6e78("0x14")]=3):(n["podPosition"]=_0x6e78("0x17"),n[_0x6e78("0x14")]=2)}return n[_0x6e78("0x18")]=g,u[_0x6e78("0x19")](n)}function f(e){n||(n=new(d["w"][_0x6e78("0x1a")][_0x6e78("0x1b")]),r=(new(h[_0x6e78("0x1c")]))["build"](),s=new(d["w"][_0x6e78("0x1a")][_0x6e78("0x1d")])(r,n),o=new(d["w"][_0x6e78("0x1a")][_0x6e78("0x1e")])(e[_0x6e78("0x1f")]),o[_0x6e78("0x20")]=e[_0x6e78("0x21")],a=new(d["w"][_0x6e78("0x1a")]["Client"])(o,s))}var _=new c(_0x6e78("0x22"),t),g=0;_[_0x6e78("0x23")](function(e,t,i){g=0;var n=u[_0x6e78("0x24")](i);f(n);var r=u[_0x6e78("0x25")](d["w"][_0x6e78("0x1a")],t,i),s=a[_0x6e78("0x26")](),o=a[_0x6e78("0x27")](r),c={client:a,playerStateManager:s,sessionKey:o};return c}),_["onVideoAttached"](function(e,t,n,r){var s=new h["Html5PlayerInterface"](e[_0x6e78("0xc")],n,r[_0x6e78("0x28")],function(e){!n[_0x6e78("0x29")]()&&n["paused"]()?e():setTimeout(function(){!n["scrubbing"]()&&n[_0x6e78("0x2a")]()&&e()},50)},function(e){var t=n[_0x6e78("0x2b")]();setTimeout(function(){t===n[_0x6e78("0x2b")]()&&e()},150)});e[_0x6e78("0x2c")]=s,i(e)}),_[_0x6e78("0x2d")](function(e,t,i,n,r,s){var o=u[_0x6e78("0x25")](d["w"]["Conviva"],n,r,s);return e["client"][_0x6e78("0x2e")](e[_0x6e78("0xa")],o),r["autoplay"]===!1&&l(e),o}),_["onError"](function(e,t,i,n){n=n||{};var r=n[_0x6e78("0x2f")];return e[_0x6e78("0xc")][_0x6e78("0x30")](r,d["w"][_0x6e78("0x1a")]["Client"][_0x6e78("0x31")][_0x6e78("0x32")]),r}),_[_0x6e78("0x33")](function(e){l(e)}),_[_0x6e78("0x34")](function(e){i(e)}),_[_0x6e78("0x35")](function(){}),_["onCustomEventRequested"](function(e,t,i,n,r,s){return s=u[_0x6e78("0x19")](s),e[_0x6e78("0x7")][_0x6e78("0x36")](e[_0x6e78("0xa")],r,s),{eventName:r,eventAttributes:s}}),_[_0x6e78("0x37")](function(e,t,i,n){var r=_0x6e78("0x38");if(u[_0x6e78("0x39")](n)){g++,l(e);var s=p(n);return"1"===s[_0x6e78("0x14")]&&e[_0x6e78("0x7")][_0x6e78("0x3a")](e[_0x6e78("0xa")],d["w"][_0x6e78("0x1a")]["Client"][_0x6e78("0x3b")][_0x6e78("0x3c")],d["w"]["Conviva"][_0x6e78("0x3d")][_0x6e78("0x3b")]["SEPARATE"],d["w"][_0x6e78("0x1a")][_0x6e78("0x3d")]["AdPosition"][_0x6e78("0x3e")]),e["client"][_0x6e78("0x36")](e["sessionKey"],r,s),{eventName:r,eventAttributes:s}}}),_[_0x6e78("0x3f")](function(e,t,n,r){var s=_0x6e78("0x40");if(u["isAdLastPart"](r)){var o=p(r);return"1"===o[_0x6e78("0x14")]&&e[_0x6e78("0x7")][_0x6e78("0x41")](e[_0x6e78("0xa")]),e[_0x6e78("0x7")][_0x6e78("0x36")](e[_0x6e78("0xa")],s,o),i(e),{eventName:s,eventAttributes:o}}}),_[_0x6e78("0x42")](function(e,t,i,n){var r=_0x6e78("0x43"),s=p(n);return e[_0x6e78("0x7")][_0x6e78("0x36")](e[_0x6e78("0xa")],r,s),{eventName:r,eventAttributes:s}}),_[_0x6e78("0x44")](function(e,t,i,n){var r=_0x6e78("0x45"),s=p(n);return e[_0x6e78("0x7")][_0x6e78("0x36")](e[_0x6e78("0xa")],r,s),{eventName:r,eventAttributes:s}}),_[_0x6e78("0x46")](function(e,t,i,n){var r=_0x6e78("0x47"),s=p(n);return e["client"][_0x6e78("0x36")](e[_0x6e78("0xa")],r,s),{eventName:r,eventAttributes:s}}),_[_0x6e78("0x48")](function(e,t,i,n,r){var s;return s=Math["round"](r/1e3),e[_0x6e78("0xc")]["setBitrateKbps"](s),r}),_[_0x6e78("0x49")]=function(){return"["+(new Date)[_0x6e78("0x4a")]()/1e3+"]"},_[_0x6e78("0x4b")](function(e){window[_0x6e78("0x4c")](function(){e[_0x6e78("0x2c")]&&e[_0x6e78("0x2c")][_0x6e78("0x4d")](),e[_0x6e78("0x7")]["cleanupSession"](e["sessionKey"])},1)}),_[_0x6e78("0x4e")]()}},118:function(e,t){function i(e,t,n,s,o){function a(e,t){if(this[_0x6e78("0x4f")](_0x6e78("0x50")),!e)throw new Error(_0x6e78("0x51"));if(!t)throw new Error("Html5PlayerInterface: videoJSElement argument cannot be null.");this[_0x6e78("0xb")]=e,this[_0x6e78("0x52")]=t,this["cl_th"]=[],this[_0x6e78("0x53")](),this[_0x6e78("0x54")](),this[_0x6e78("0x55")](),this[_0x6e78("0x56")]()}var u=this;u[_0x6e78("0x57")]=[],this[_0x6e78("0x58")]=new c,this[_0x6e78("0x59")]=new r,this[_0x6e78("0x5a")]=n,this[_0x6e78("0x5b")]=s,this[_0x6e78("0x5c")]=o,this[_0x6e78("0x5d")]=function(e,t,i){u[_0x6e78("0x5e")][_0x6e78("0x5f")]([e,t,i]),i?i["on"](e,t):u[_0x6e78("0x52")]["on"](e,t)},this["cl_ph"]=function(e,t,i){i?i["off"](e,t):u[_0x6e78("0x52")][_0x6e78("0x60")]&&u[_0x6e78("0x52")]["off"](e,t)},this[_0x6e78("0x53")]=function(){u[_0x6e78("0x5d")](_0x6e78("0x61"),function(){u[_0x6e78("0x62")](_0x6e78("0x61"))}),u[_0x6e78("0x5d")](_0x6e78("0x63"),function(){u[_0x6e78("0x5b")](function(){u[_0x6e78("0x62")]("pause")})}),u[_0x6e78("0x5d")](_0x6e78("0x64"),function(){u["cl_fh"](_0x6e78("0x64"))}),u[_0x6e78("0x5d")](_0x6e78("0x65"),function(){u[_0x6e78("0x62")](_0x6e78("0x65"))}),u[_0x6e78("0x5d")](_0x6e78("0x66"),function(){u["cl_hh"](function(){u[_0x6e78("0x62")](_0x6e78("0x66"))})}),u[_0x6e78("0x5d")]("error",function(){if(u[_0x6e78("0x52")]["error"]()){var e=u[_0x6e78("0x52")][_0x6e78("0x67")]()||{};if(_0x6e78("0x68")===!e[_0x6e78("0x69")]){var t=e[_0x6e78("0x6a")];u[_0x6e78("0x6b")](t)}}}),u[_0x6e78("0x5d")]("loadedmetadata",u[_0x6e78("0x6c")]),u[_0x6e78("0x5d")](_0x6e78("0x6d"),function(){u[_0x6e78("0x6e")]||(u[_0x6e78("0x4f")](_0x6e78("0x6f")),u[_0x6e78("0x6e")]=!0,u[_0x6e78("0xb")]["setPlayerSeekStart"](-1))}),u[_0x6e78("0x5d")]("seeked",function(){u[_0x6e78("0x4f")]("player is seeked"),u[_0x6e78("0x6e")]=!1,u[_0x6e78("0xb")][_0x6e78("0x70")]()})},this[_0x6e78("0x71")]=function(){for(var e=0;e<u[_0x6e78("0x5e")][_0x6e78("0x72")];e++){var t=u[_0x6e78("0x5e")][e];u[_0x6e78("0x73")](t[0],t[1],t[2])}u[_0x6e78("0x5e")]=[]},this["cl_sh"]=function(){var e=u[_0x6e78("0x52")][_0x6e78("0x74")]();u[_0x6e78("0x75")]=e,0===e||_0x6e78("0x76")==typeof e?u["cl_Ah"](Conviva[_0x6e78("0x77")][_0x6e78("0x78")]["STOPPED"]):u[_0x6e78("0x52")][_0x6e78("0x61")]()?u[_0x6e78("0x79")](Conviva[_0x6e78("0x77")][_0x6e78("0x78")][_0x6e78("0x7a")]):u[_0x6e78("0x52")][_0x6e78("0x2a")]()||u[_0x6e78("0x52")][_0x6e78("0x6d")]()?u["cl_Ah"](Conviva[_0x6e78("0x77")][_0x6e78("0x78")][_0x6e78("0x7b")]):u["cl_Ah"](Conviva[_0x6e78("0x77")][_0x6e78("0x78")][_0x6e78("0x7c")]),e>=1&&u[_0x6e78("0x6c")]()},this[_0x6e78("0x62")]=function(e){var t=u[_0x6e78("0x7d")](e);u["cl_$d"](_0x6e78("0x7e")+e+_0x6e78("0x7f")+t),u[_0x6e78("0x79")](t)},this["cl_Ah"]=function(e){u[_0x6e78("0xb")][_0x6e78("0x80")]()!==e&&(u[_0x6e78("0x4f")]("Changing Conviva player state to: "+e),u[_0x6e78("0xb")][_0x6e78("0x81")](e),u[_0x6e78("0x54")](),u["cl_Th"]=!0)},this[_0x6e78("0x7d")]=function(e){switch(e){case"playing":return Conviva["PlayerStateManager"][_0x6e78("0x78")][_0x6e78("0x7c")];case _0x6e78("0x66"):return Conviva["PlayerStateManager"]["PlayerState"][_0x6e78("0x82")];case _0x6e78("0x61"):case"stopped":return Conviva[_0x6e78("0x77")][_0x6e78("0x78")][_0x6e78("0x7a")];case _0x6e78("0x63"):return Conviva[_0x6e78("0x77")]["PlayerState"][_0x6e78("0x7b")];default:return Conviva[_0x6e78("0x77")]["PlayerState"][_0x6e78("0x83")]}},this["cl__h"]=function(e){var t;switch(e){case 1:t="MEDIA_ERR_ABORTED";break;case 2:t=_0x6e78("0x84");break;case 3:t=_0x6e78("0x85");break;case 4:t=_0x6e78("0x86");break;default:t=_0x6e78("0x87")}u[_0x6e78("0x4f")]("Reporting error: code="+e+_0x6e78("0x88")+t);var i=Conviva["Client"][_0x6e78("0x31")][_0x6e78("0x32")];u[_0x6e78("0xb")][_0x6e78("0x30")](t,i)},this["cl_gh"]=function(){var e=u[_0x6e78("0x52")][_0x6e78("0x89")]();isNaN(e)||e==1/0||u[_0x6e78("0xb")][_0x6e78("0x8a")](e)},this[_0x6e78("0x55")]=function(){this[_0x6e78("0x8b")]=0,this[_0x6e78("0x8c")]=0,this[_0x6e78("0x8d")]=0,this["cl_Ch"]=this[_0x6e78("0x58")][_0x6e78("0x8e")](this[_0x6e78("0x8f")],500,"Html5PlayerInterface._poll()")},this[_0x6e78("0x8f")]=function(){u[_0x6e78("0x90")](),u[_0x6e78("0x91")](),u[_0x6e78("0x92")]()},this["cl_wh"]=function(){u["cl_Sh"]=u["cl_Eh"],u[_0x6e78("0x8c")]=u[_0x6e78("0x52")][_0x6e78("0x2b")]();var e=Date[_0x6e78("0x93")]();if(u[_0x6e78("0x94")]>0&&e>u[_0x6e78("0x94")]){var t=(u[_0x6e78("0x8c")]-u[_0x6e78("0x8b")])/(e-u[_0x6e78("0x94")])*1e3;u[_0x6e78("0x57")][_0x6e78("0x5f")](t)}u[_0x6e78("0x94")]=e,u[_0x6e78("0x57")]["length"]>Math["max"](i[_0x6e78("0x95")],i[_0x6e78("0x96")])&&u["cl_oh"]["shift"](),u[_0x6e78("0xb")]["setPlayheadTime"](1e3*u[_0x6e78("0x8c")])},this[_0x6e78("0x91")]=function(){var e=u[_0x6e78("0x52")][_0x6e78("0x97")]();if(void 0!==e){for(var t=0,i=0;i<e[_0x6e78("0x72")];i++){var n=e[_0x6e78("0x4e")](i),r=e[_0x6e78("0x98")](i);n<=u[_0x6e78("0x8c")]&&u["cl_Eh"]<r&&(t+=r-u["cl_Eh"])}u[_0x6e78("0x8d")]=t,u[_0x6e78("0xb")]["setBufferLength"](1e3*u["cl_bh"])}},this["cl_Ih"]=function(){var e=u[_0x6e78("0x57")][_0x6e78("0x72")];if(e>=Math[_0x6e78("0x99")](i["PLAY_STATE_ON_MOVING_PHT_POLL_COUNT"],i[_0x6e78("0x95")])){for(var t=0,n=u[_0x6e78("0x57")][_0x6e78("0x9a")](),r=0;r<n[_0x6e78("0x72")];r++){var s=n[r];t+=s}t/=e;var o=i[_0x6e78("0x9b")],a=i[_0x6e78("0x9c")],c=u[_0x6e78("0x52")][_0x6e78("0x9d")]();if(!isNaN(c)&&c!=1/0&&c>0){var d=Object[_0x6e78("0x9e")][_0x6e78("0x9f")][_0x6e78("0xa0")](window[_0x6e78("0xa1")])[_0x6e78("0xa2")](_0x6e78("0xa3"))>0;d&&c<.5&&(c=.5),o*=c,a*=c}var h=u["_playerStateManager"][_0x6e78("0x80")]();if(h!=Conviva["PlayerStateManager"][_0x6e78("0x78")][_0x6e78("0x7c")]&&e>=i["PLAY_STATE_ON_MOVING_PHT_POLL_COUNT"]&&Math[_0x6e78("0xa4")](t-o)<a)return u[_0x6e78("0x4f")](_0x6e78("0xa5")),void u["cl_Ah"](Conviva[_0x6e78("0x77")]["PlayerState"][_0x6e78("0x7c")]);h==Conviva[_0x6e78("0x77")][_0x6e78("0x78")][_0x6e78("0x7c")]&&e>=i[_0x6e78("0x95")]&&t==i[_0x6e78("0xa6")]&&(u[_0x6e78("0x52")][_0x6e78("0x2a")]()?(u["cl_$d"](_0x6e78("0xa7")),u[_0x6e78("0x79")](Conviva["PlayerStateManager"]["PlayerState"][_0x6e78("0x7b")])):u[_0x6e78("0x52")][_0x6e78("0x6d")]()||(u[_0x6e78("0x4f")](_0x6e78("0xa8")),u[_0x6e78("0x79")](Conviva["PlayerStateManager"]["PlayerState"][_0x6e78("0x82")])))}},this[_0x6e78("0xa9")]=function(){this["cl_Ch"]()},this["cl_nh"]=function(){u[_0x6e78("0x57")]=[],u["cl_Sh"]=-1,u[_0x6e78("0x94")]=0},this[_0x6e78("0x26")]=function(){return this[_0x6e78("0xb")]},this[_0x6e78("0x4f")]=function(e){var t=_0x6e78("0xaa")+e;this["cl_uh"]&&this[_0x6e78("0x59")][_0x6e78("0xab")](t,Conviva[_0x6e78("0x1b")]["LogLevel"]["DEBUG"])},a["apply"](this,arguments),this[_0x6e78("0x4d")]=function(){this[_0x6e78("0x4f")]("Html5PlayerInterface.cleanup()"),this[_0x6e78("0xa9")](),this[_0x6e78("0x71")](),this[_0x6e78("0x52")],
this[_0x6e78("0xb")]=null}}function n(){function e(){}e[_0x6e78("0xac")](this,arguments),this[_0x6e78("0xad")]=function(){return this[_0x6e78("0xae")][_0x6e78("0xac")](this,arguments)},this[_0x6e78("0xae")]=function(e,t,i,n,r,s){var o=new XMLHttpRequest;return o[_0x6e78("0xaf")](e,t,!0),n&&o[_0x6e78("0xb0")]&&(o["overrideMimeType"]=n),n&&o[_0x6e78("0xb1")]&&o[_0x6e78("0xb1")]("Content-Type",n),r>0&&(o[_0x6e78("0xb2")]=r,o[_0x6e78("0xb3")]=function(){o["ontimeout"]=o[_0x6e78("0xb4")]=null,s&&s(!1,_0x6e78("0xb5")+r+_0x6e78("0xb6"))}),o[_0x6e78("0xb4")]=function(){4===o[_0x6e78("0x74")]&&(o[_0x6e78("0xb3")]=o[_0x6e78("0xb4")]=null,200==o["status"]?s&&s(!0,o[_0x6e78("0xb7")]):s&&s(!1,_0x6e78("0xb8")+o[_0x6e78("0xb9")]))},o[_0x6e78("0xba")](i),null},this[_0x6e78("0xbb")]=function(){}}function r(){function e(){}e[_0x6e78("0xac")](this,arguments),this[_0x6e78("0xab")]=function(e,t){_0x6e78("0x76")!=typeof console&&(console[_0x6e78("0xbc")]&&t===Conviva["SystemSettings"]["LogLevel"][_0x6e78("0xbd")]||t===Conviva[_0x6e78("0x1b")][_0x6e78("0xbe")][_0x6e78("0xbf")]?console["log"](e):console[_0x6e78("0xc0")]&&t===Conviva[_0x6e78("0x1b")][_0x6e78("0xbe")]["WARNING"]?console[_0x6e78("0xc0")](e):console[_0x6e78("0x67")]&&t===Conviva[_0x6e78("0x1b")][_0x6e78("0xbe")][_0x6e78("0xc1")]&&console[_0x6e78("0x67")](e))},this[_0x6e78("0xbb")]=function(){}}function s(){function e(){}e["apply"](this,arguments),this[_0x6e78("0xc2")]=function(){return null},this[_0x6e78("0xc3")]=function(){return null},this[_0x6e78("0xc4")]=function(){return null},this[_0x6e78("0xc5")]=function(){return null},this[_0x6e78("0xc6")]=function(){return null},this[_0x6e78("0xc7")]=function(){return null},this[_0x6e78("0xc8")]=function(){return null},this["getFrameworkName"]=function(){return _0x6e78("0xc9")},this[_0x6e78("0xca")]=function(){return null},this[_0x6e78("0xcb")]=function(){return null},this[_0x6e78("0xcc")]=function(){return null},this["release"]=function(){}}function o(){function e(){}e[_0x6e78("0xac")](this,arguments),this[_0x6e78("0xcd")]=function(e,t,i,n){var r=e+"."+t;try{localStorage["setItem"](r,i),n(!0,null)}catch(e){n(!1,e["toString"]())}},this[_0x6e78("0xce")]=function(e,t,i){var n=e+"."+t;try{var r=localStorage["getItem"](n);i(!0,r)}catch(e){i(!1,e[_0x6e78("0x9f")]())}},this[_0x6e78("0xbb")]=function(){}}function a(){function e(){}e[_0x6e78("0xac")](this,arguments),this[_0x6e78("0xcf")]=function(){var e=new Date;return e[_0x6e78("0x4a")]()},this[_0x6e78("0xbb")]=function(){}}function c(){function e(){}e[_0x6e78("0xac")](this,arguments),this["createTimer"]=function(e,t){var i=setInterval(e,t),n=function(){i!==-1&&(clearInterval(i),i=-1)};return n},this[_0x6e78("0xbb")]=function(){}}i[_0x6e78("0xd0")]=500,i[_0x6e78("0x95")]=4e3/i[_0x6e78("0xd0")],i["PLAY_STATE_ON_MOVING_PHT_POLL_COUNT"]=2e3/i["POLL_STREAMER_INTERVAL_MS"],i[_0x6e78("0x9b")]=1,i["PHT_PAUSED_EXPECTED_SPEED"]=0,i[_0x6e78("0x9c")]=.25;var u=function(){this["build"]=function(){return new(Conviva[_0x6e78("0xd1")])(new a,new c,new n,new o,new s,new r)}};t[_0x6e78("0x1c")]=u,t["Html5PlayerInterface"]=i}})})}])});
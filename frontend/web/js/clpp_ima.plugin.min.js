/*! @castlabs/prestoplay 5.1.2, 15-11-2017 Copyright (c) 2017 castLabs GmbH, All Rights reserved */

(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory(require("clpp"));else if(typeof define==="function"&&define.amd)define(["clpp"],factory);else if(typeof exports==="object")exports["clpp_ima"]=factory(require("clpp"));else root["clpp_ima"]=factory(root["clpp"])})(this,function(__WEBPACK_EXTERNAL_MODULE_1__){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="/";return __webpack_require__(0)}([function(module,exports,__webpack_require__){__webpack_require__(1);module.exports=__webpack_require__(25).init(function(){__webpack_require__(26);__webpack_require__(30);__webpack_require__(31);__webpack_require__(33)})},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_1__},,,,,,,,,,,,,,,,,,,,,,,,function(module,exports){var _0x4b47=["selectText","isChromecast","chromecast","ima","analytics","browser","IS_IOS","videojs","IS_ANDROID","cl_Qd","cl_Zd","ads","tech_","el_","getAttribute","merge","autoplay","pause","adsready","cl_Le","play","adsManager","addEventListener","AdEvent","CONTENT_RESUME_REQUESTED","VIDEO_STOP","requestAds","uon","VIDEO_PLAYED_AGAIN","FORCE_DESTROY","off","adsActive","vjsControls","show","player","adsLoader","contentComplete","allAdsCompleted","destroy","parentNode","cl_qr","then","cl_Hr","bind","adend","info","ads-ended","adstart","ads-started","playAdBreak","errorThatCannotBeRecovered","cl_gt","resize","querySelectorAll","video","forEach","Logger","nopreroll","adscanceled","adskip","object","exports","function","clpp_ima","init","google","types","PLAYER_ATTACH_AFTER","trigger","EVENTS","ANALYTICS","Google ima NOT loaded","definePlugin","document","querySelector","#vid_ima-ad-container div","iframe","getElementById","cl_Qr","clientHeight","clientWidth","style","width","height","videojs_","one","concat","playing"];(function(_0x26e3fe,_0x3f2a9d){var _0x48473a=function(_0x2cf19c){while(--_0x2cf19c){_0x26e3fe["push"](_0x26e3fe["shift"]())}};_0x48473a(++_0x3f2a9d)})(_0x4b47,500);var _0x74b4=function(_0x5e0ae4,_0xd219f9){_0x5e0ae4=_0x5e0ae4-0;var _0x102192=_0x4b47[_0x5e0ae4];return _0x102192};!function(e,t){_0x74b4("0x0")==typeof exports&&_0x74b4("0x0")==typeof module?module[_0x74b4("0x1")]=t():_0x74b4("0x2")==typeof define&&define["amd"]?define([],t):_0x74b4("0x0")==typeof exports?exports["clpp_ima"]=t():e[_0x74b4("0x3")]=t()}(this,function(){return webpackJsonpclpp__name_([9],{0:function(e,t,i){var n=i(1),r=i(126),s=_0x74b4("0x3");t[_0x74b4("0x4")]=function(e){var t={registerPlugin:function(t,i){return n["w"][_0x74b4("0x5")]?(e(),void t["addInterceptor"](t[_0x74b4("0x6")][_0x74b4("0x7")],r)):(setTimeout(function(){i[_0x74b4("0x8")](i[_0x74b4("0x9")][_0x74b4("0xa")]["IMA_FAILED_AD_BLOCKER"])},0),void console["error"](_0x74b4("0xb")))}};return n[_0x74b4("0xc")](s,t),t}},126:function(e,t,i){function n(){try{var e=d["w"][_0x74b4("0xd")][_0x74b4("0xe")](_0x74b4("0xf"));if(!e)return;var t=e[_0x74b4("0xe")](_0x74b4("0x10")),i=d["w"][_0x74b4("0xd")][_0x74b4("0x11")](this[_0x74b4("0x12")]),n=i[_0x74b4("0x13")],r=i[_0x74b4("0x14")];e[_0x74b4("0x15")]["height"]=n+"px",e[_0x74b4("0x15")][_0x74b4("0x16")]=r+"px",t[_0x74b4("0x15")][_0x74b4("0x17")]=n+"px",t[_0x74b4("0x15")][_0x74b4("0x16")]=r+"px"}catch(e){f["error"](e)}}function r(e,t){var i=e[_0x74b4("0x18")]&&e[_0x74b4("0x18")]["tech_"]["cl_ut"]("text");i>=0&&t[_0x74b4("0x19")](["adend"][_0x74b4("0x1a")](A),function(){t[_0x74b4("0x19")](_0x74b4("0x1b"),function(){e[_0x74b4("0x1c")](i)})})}function s(e,t,i){var n;if(u=T[_0x74b4("0x1d")](),S=u,n=u?i[_0x74b4("0x1e")][_0x74b4("0x1f")]:(i[_0x74b4("0x20")]||{})[_0x74b4("0x1f")],g=!1,m=!1,y=!1,!(d["videojs"][_0x74b4("0x21")][_0x74b4("0x22")]||d[_0x74b4("0x23")][_0x74b4("0x21")][_0x74b4("0x24")]&&!u)&&(_0x74b4("0x2")==typeof t[_0x74b4("0x1f")]&&(d[_0x74b4("0x25")]=t[_0x74b4("0x1f")],d[_0x74b4("0x26")]=t[_0x74b4("0x27")]),d[_0x74b4("0x25")]&&n)){t[_0x74b4("0x27")]=d[_0x74b4("0x26")],t["ima"]=d["cl_Qd"];var r;(u||S)&&(r=t[_0x74b4("0x28")][_0x74b4("0x29")][_0x74b4("0x2a")]("id")),t[_0x74b4("0x1f")](l[_0x74b4("0x2b")]({},n,{id:r,autoPlayAdBreaks:!1})),i[_0x74b4("0x2c")]!==!1&&t[_0x74b4("0x2d")]();var o=!1;t[_0x74b4("0x19")](t["tech_"]["el_"],_0x74b4("0x1b"),function(){y=!0}),t[_0x74b4("0x19")]([_0x74b4("0x2e")][_0x74b4("0x1a")](A),function(){e[_0x74b4("0x2f")][_0x74b4("0x8")](e["cl_Le"]["EVENTS"]["ANALYTICS"]["IMA_READY"],t["ima"],e),i[_0x74b4("0x2c")]!==!1&&t[_0x74b4("0x30")]()}),t["one"](A,function(){o=!0}),e["videojs_"][_0x74b4("0x28")]["cl_st"](function(){return new Promise(function(i,n){try{_=!0,o?i():t[_0x74b4("0x1f")][_0x74b4("0x31")][_0x74b4("0x32")](d["w"][_0x74b4("0x5")][_0x74b4("0x1f")][_0x74b4("0x33")]["Type"][_0x74b4("0x34")],function(){e["videojs_"][_0x74b4("0x27")]["cancelPlayTimeout"]=!0,setTimeout(function(){e["videojs_"]["ads"]["cancelPlayTimeout"]=!1},100),i()})}catch(e){n(e)}})}),t["ima"]["setAdBreakReadyListener"](function(){e[_0x74b4("0x2f")][_0x74b4("0x8")](e[_0x74b4("0x2f")]["EVENTS"][_0x74b4("0xa")][_0x74b4("0x35")]),_&&c(t,e)}),t[_0x74b4("0x1f")][_0x74b4("0x36")](),e[_0x74b4("0x2f")][_0x74b4("0x37")](e[_0x74b4("0x2f")]["EVENTS"][_0x74b4("0xa")][_0x74b4("0x38")],function(){s(e,t,i)},e),e[_0x74b4("0x2f")][_0x74b4("0x37")](e[_0x74b4("0x2f")][_0x74b4("0x9")][_0x74b4("0xa")][_0x74b4("0x39")],function(){t[_0x74b4("0x3a")]([_0x74b4("0x2e"),"adend"][_0x74b4("0x1a")](A)),t[_0x74b4("0x1f")]["playerDisposedListener"](),t[_0x74b4("0x1f")][_0x74b4("0x3b")]=!1,t["ima"]["adPlaying"]=!1,t["ima"][_0x74b4("0x3c")][_0x74b4("0x3d")](),t[_0x74b4("0x1f")][_0x74b4("0x3e")][_0x74b4("0x27")]["endLinearAdMode"](),t[_0x74b4("0x1f")]["adsLoader"]&&!t[_0x74b4("0x1f")]["contentComplete"]&&t["ima"][_0x74b4("0x3f")]["contentComplete"](),t[_0x74b4("0x1f")][_0x74b4("0x40")]=!1,t[_0x74b4("0x1f")][_0x74b4("0x41")]=!1,t[_0x74b4("0x1f")][_0x74b4("0x3f")]&&t[_0x74b4("0x1f")][_0x74b4("0x3f")][_0x74b4("0x42")]();var e=t[_0x74b4("0x1f")]["adContainerDiv"];e&&e["parentNode"]&&e[_0x74b4("0x43")]["removeChild"](e)},e)}}function o(e,t){t=t||function(){},S&&_0x74b4("0x2")==typeof e[_0x74b4("0x28")][_0x74b4("0x44")]?e[_0x74b4("0x28")]["cl_qr"]()[_0x74b4("0x45")](t,t):t()}function a(e,t){t=t||function(){},S&&_0x74b4("0x2")==typeof e[_0x74b4("0x28")][_0x74b4("0x46")]?e[_0x74b4("0x28")][_0x74b4("0x46")]()[_0x74b4("0x45")](t,o[_0x74b4("0x47")](null,e,t)):t()}function c(e,t){function i(){m||(m=!0,r(t,e),a(e,function(){e[_0x74b4("0x19")]([_0x74b4("0x48")][_0x74b4("0x1a")](A),function(){f[_0x74b4("0x49")](_0x74b4("0x4a")),o(e)});var t=setTimeout(o[_0x74b4("0x47")](null,e),v);e[_0x74b4("0x19")]([_0x74b4("0x4b")][_0x74b4("0x1a")](A),function(){clearTimeout(t)}),f[_0x74b4("0x49")](_0x74b4("0x4c")),e[_0x74b4("0x1f")][_0x74b4("0x4d")]()}))}function s(i){g||l["isAutoPlayBlocked"](i)&&(g=!0,t[_0x74b4("0x18")]["tech_"]["cl_st"](function(){c(e,t)}))}g=!1,m=!1;var u=e[_0x74b4("0x28")]||{},d=l[_0x74b4("0x4e")](u[_0x74b4("0x4f")],u["cl_me"]);d||(h[_0x74b4("0x37")](window,_0x74b4("0x50"),n,t),y?i():e["el_"][_0x74b4("0x51")](_0x74b4("0x52"))[_0x74b4("0x53")](function(e){e[_0x74b4("0x30")]()[_0x74b4("0x45")](i,s)}),n["call"](t))}var u,d=i(1),h=i(37),l=i(3),p=i(4),f=new(p[_0x74b4("0x54")])("clpp_ima.plugin"),_=!1,g=!1,m=!1,y=!1,A=[_0x74b4("0x55"),"adserror",_0x74b4("0x56"),_0x74b4("0x57")],v=5e3,T=i(8),S=!1;e[_0x74b4("0x1")]=s}})})},function(module,exports,__webpack_require__){var content=__webpack_require__(27);if(typeof content==="string")content=[[module.id,content,""]];var update=__webpack_require__(29)(content,{});if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../css-loader/index.js!./videojs.ads.css",function(){var newContent=require("!!../../css-loader/index.js!./videojs.ads.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(28)();exports.push([module.id,".vjs-ad-playing.vjs-ad-playing .vjs-progress-control{pointer-events:none}.vjs-ad-playing.vjs-ad-playing .vjs-play-progress{background-color:#ffe400}.vjs-ad-playing.vjs-ad-loading .vjs-loading-spinner{display:block}.vjs-ad-playing .vjs-audio-button,.vjs-ad-playing .vjs-captions-button{display:none}",""])},function(module,exports){module.exports=function(){var list=[];list.toString=function toString(){var result=[];for(var i=0;i<this.length;i++){var item=this[i];if(item[2]){result.push("@media "+item[2]+"{"+item[1]+"}")}else{result.push(item[1])}}return result.join("")};list.i=function(modules,mediaQuery){if(typeof modules==="string")modules=[[null,modules,""]];var alreadyImportedModules={};for(var i=0;i<this.length;i++){var id=this[i][0];if(typeof id==="number")alreadyImportedModules[id]=true}for(i=0;i<modules.length;i++){var item=modules[i];if(typeof item[0]!=="number"||!alreadyImportedModules[item[0]]){if(mediaQuery&&!item[2]){item[2]=mediaQuery}else if(mediaQuery){item[2]="("+item[2]+") and ("+mediaQuery+")"}list.push(item)}}};return list}},function(module,exports,__webpack_require__){var stylesInDom={},memoize=function(fn){var memo;return function(){if(typeof memo==="undefined")memo=fn.apply(this,arguments);return memo}},isOldIE=memoize(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),getHeadElement=memoize(function(){return document.head||document.getElementsByTagName("head")[0]}),singletonElement=null,singletonCounter=0,styleElementsInsertedAtTop=[];module.exports=function(list,options){if(false){if(typeof document!=="object")throw new Error("The style-loader cannot be used in a non-browser environment")}options=options||{};if(typeof options.singleton==="undefined")options.singleton=isOldIE();if(typeof options.insertAt==="undefined")options.insertAt="bottom";var styles=listToStyles(list);addStylesToDom(styles,options);return function update(newList){var mayRemove=[];for(var i=0;i<styles.length;i++){var item=styles[i];var domStyle=stylesInDom[item.id];domStyle.refs--;mayRemove.push(domStyle)}if(newList){var newStyles=listToStyles(newList);addStylesToDom(newStyles,options)}for(var i=0;i<mayRemove.length;i++){var domStyle=mayRemove[i];if(domStyle.refs===0){for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j]();delete stylesInDom[domStyle.id]}}}};function addStylesToDom(styles,options){for(var i=0;i<styles.length;i++){var item=styles[i];var domStyle=stylesInDom[item.id];if(domStyle){domStyle.refs++;for(var j=0;j<domStyle.parts.length;j++){domStyle.parts[j](item.parts[j])}for(;j<item.parts.length;j++){domStyle.parts.push(addStyle(item.parts[j],options))}}else{var parts=[];for(var j=0;j<item.parts.length;j++){parts.push(addStyle(item.parts[j],options))}stylesInDom[item.id]={id:item.id,refs:1,parts:parts}}}}function listToStyles(list){var styles=[];var newStyles={};for(var i=0;i<list.length;i++){var item=list[i];var id=item[0];var css=item[1];var media=item[2];var sourceMap=item[3];var part={css:css,media:media,sourceMap:sourceMap};if(!newStyles[id])styles.push(newStyles[id]={id:id,parts:[part]});else newStyles[id].parts.push(part)}return styles}function insertStyleElement(options,styleElement){var head=getHeadElement();var lastStyleElementInsertedAtTop=styleElementsInsertedAtTop[styleElementsInsertedAtTop.length-1];if(options.insertAt==="top"){if(!lastStyleElementInsertedAtTop){head.insertBefore(styleElement,head.firstChild)}else if(lastStyleElementInsertedAtTop.nextSibling){head.insertBefore(styleElement,lastStyleElementInsertedAtTop.nextSibling)}else{head.appendChild(styleElement)}styleElementsInsertedAtTop.push(styleElement)}else if(options.insertAt==="bottom"){head.appendChild(styleElement)}else{throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.")}}function removeStyleElement(styleElement){styleElement.parentNode.removeChild(styleElement);var idx=styleElementsInsertedAtTop.indexOf(styleElement);if(idx>=0){styleElementsInsertedAtTop.splice(idx,1)}}function createStyleElement(options){var styleElement=document.createElement("style");styleElement.type="text/css";insertStyleElement(options,styleElement);return styleElement}function createLinkElement(options){var linkElement=document.createElement("link");linkElement.rel="stylesheet";insertStyleElement(options,linkElement);return linkElement}function addStyle(obj,options){var styleElement,update,remove;if(options.singleton){var styleIndex=singletonCounter++;styleElement=singletonElement||(singletonElement=createStyleElement(options));update=applyToSingletonTag.bind(null,styleElement,styleIndex,false);remove=applyToSingletonTag.bind(null,styleElement,styleIndex,true)}else if(obj.sourceMap&&typeof URL==="function"&&typeof URL.createObjectURL==="function"&&typeof URL.revokeObjectURL==="function"&&typeof Blob==="function"&&typeof btoa==="function"){styleElement=createLinkElement(options);update=updateLink.bind(null,styleElement);remove=function(){removeStyleElement(styleElement);if(styleElement.href)URL.revokeObjectURL(styleElement.href)}}else{styleElement=createStyleElement(options);update=applyToTag.bind(null,styleElement);remove=function(){removeStyleElement(styleElement)}}update(obj);return function updateStyle(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap)return;update(obj=newObj)}else{remove()}}}var replaceText=function(){var textStore=[];return function(index,replacement){textStore[index]=replacement;return textStore.filter(Boolean).join("\n")}}();function applyToSingletonTag(styleElement,index,remove,obj){var css=remove?"":obj.css;if(styleElement.styleSheet){styleElement.styleSheet.cssText=replaceText(index,css)}else{var cssNode=document.createTextNode(css);var childNodes=styleElement.childNodes;if(childNodes[index])styleElement.removeChild(childNodes[index]);if(childNodes.length){styleElement.insertBefore(cssNode,childNodes[index])}else{styleElement.appendChild(cssNode)}}}function applyToTag(styleElement,obj){var css=obj.css;var media=obj.media;if(media){styleElement.setAttribute("media",media)}if(styleElement.styleSheet){styleElement.styleSheet.cssText=css}else{while(styleElement.firstChild){styleElement.removeChild(styleElement.firstChild)}styleElement.appendChild(document.createTextNode(css))}}function updateLink(linkElement,obj){var css=obj.css;var sourceMap=obj.sourceMap;if(sourceMap){css+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))+" */"}var blob=new Blob([css],{type:"text/css"});var oldSrc=linkElement.href;linkElement.href=URL.createObjectURL(blob);if(oldSrc)URL.revokeObjectURL(oldSrc)}},function(module,exports){(function(){var require=undefined;var module=undefined;var exports=undefined;var define=undefined;!function e(t,n,a){function d(i,s){if(!n[i]){if(!t[i]){var r="function"==typeof require&&require;if(!s&&r)return r(i,!0);if(o)return o(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[i]={exports:{}};t[i][0].call(l.exports,function(e){var n=t[i][1][e];return d(n||e)},l,l.exports,e,t,n,a)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<a.length;i++)d(a[i]);return d}({1:[function(e,t,n){(function(t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function d(e){if(!e.ads.cancelPlayTimeout){if(l["default"].browser.IS_IOS&&l["default"].browser.IS_IPHONE&&!e.el_.hasAttribute("playsinline")){var t=e.currentWidth?e.currentWidth():e.width(),n=e.currentHeight?e.currentHeight():e.height(),a=i["default"].getComputedStyle(e.el_).position,d=i["default"].getComputedStyle(e.el_).top,o=r["default"].createElement("div");o.style.width=t+"px",o.style.height=n+"px",o.style.background="black",o.style.position=a,o.style.top=d,e.el_.parentNode.insertBefore(o,e.el_),e.el_.style.display="none",e.one(["adstart","adtimeout","adserror","adscanceled","adskip","playing"],function(){e.el_.style.display="block",o.remove()}),e.on("fullscreenchange",function(){o&&!e.isFullscreen()&&(e.el_.style.display="block",o.remove())})}e.ads.cancelPlayTimeout=i["default"].setTimeout(function(){e.ads.cancelPlayTimeout=null,e.paused()||e.pause(),e.ads.cancelledPlay=!0},1)}}n.__esModule=!0,n["default"]=d;var o=e(9),i=a(o),s=e(8),r=a(s),u="undefined"!=typeof window?window.videojs:void 0!==t?t.videojs:null,l=a(u)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";function a(e){e.ads.contentSrc=e.currentSrc();var t=function(){if("ad-playback"!==e.ads.state){var t=e.currentSrc();t!==e.ads.contentSrc&&(e.trigger({type:"contentupdate",oldValue:e.ads.contentSrc,newValue:t}),e.ads.contentSrc=t)}};e.on("loadstart",t),o["default"].setTimeout(t,1)}n.__esModule=!0,n["default"]=a;var d=e(9),o=function(e){return e&&e.__esModule?e:{default:e}}(d)},{}],3:[function(e,t,n){(function(e){"use strict";function t(e,t){var n=e.textTracks(),a=function(n){"metadata"===n.kind&&(e.ads.cueTextTracks.setMetadataTrackMode(n),t(e,n))};if(n.length>0)for(var d=0;d<n.length;d++){var o=n[d];a(o)}else n.addEventListener("addtrack",function(e){var t=e.track;a(t)})}function a(e){}function d(e,t){return t}function o(e,t){return t.id}function i(e,t,n,a){e.ads.includedCues={};for(var d=0;d<t.length;d++){var o=t[d],i=this.getSupportedAdCue(e,o);if(-1===i)return void r["default"].log.warn("Skipping as this is not a supported ad cue.",o);var s=this.getCueId(e,o),c=o.startTime;if(u(e,s))return void r["default"].log("Skipping ad already seen with ID "+s);n(e,i,s,c),l(e,s),a!==undefined&&a(e,i)}}n.__esModule=!0,n.processMetadataTracks=t,n.setMetadataTrackMode=a,n.getSupportedAdCue=d,n.getCueId=o,n.processAdTrack=i;var s="undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null,r=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(e,t){return t!==undefined&&e.ads.includedCues[t]},l=function(e,t){t!==undefined&&""!==t&&(e.ads.includedCues[t]=!0)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,n){(function(t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n){t===undefined&&(t=!1);var a={};n!==undefined&&(a=n),a["{player.id}"]=this.options_["data-player"],a["{mediainfo.id}"]=this.mediainfo?this.mediainfo.id:"",a["{mediainfo.name}"]=this.mediainfo?this.mediainfo.name:"",a["{mediainfo.description}"]=this.mediainfo?this.mediainfo.description:"",a["{mediainfo.tags}"]=this.mediainfo?this.mediainfo.tags:"",a["{mediainfo.reference_id}"]=this.mediainfo?this.mediainfo.reference_id:"",a["{mediainfo.duration}"]=this.mediainfo?this.mediainfo.duration:"",a["{mediainfo.ad_keys}"]=this.mediainfo?this.mediainfo.ad_keys:"",a["{player.duration}"]=this.duration(),a["{timestamp}"]=(new Date).getTime(),a["{document.referrer}"]=u["default"].referrer,a["{window.location.href}"]=s["default"].location.href,a["{random}"]=Math.floor(1e12*Math.random()),p(this.mediainfo,a,"custom_fields"),p(this.mediainfo,a,"customFields");for(var d in a)e=e.split(d).join(f(a[d],t));return e=e.replace(/{pageVariable\.([^}]+)}/g,function(e,n){for(var a=void 0,d=s["default"],i=n.split("."),r=0;r<i.length;r++)r===i.length-1?a=d[i[r]]:d=d[i[r]];var u=void 0===a?"undefined":o(a);return null===a?"null":a===undefined?(c["default"].log.warn('Page variable "'+n+'" not found'),""):"string"!==u&&"number"!==u&&"boolean"!==u?(c["default"].log.warn('Page variable "'+n+'" is not a supported type'),""):f(String(a),t)})}n.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n["default"]=d;var i=e(9),s=a(i),r=e(8),u=a(r),l="undefined"!=typeof window?window.videojs:void 0!==t?t.videojs:null,c=a(l),f=function(e,t){return t?encodeURIComponent(e):e},p=function(e,t,n){if(e&&e[n])for(var a=e[n],d=Object.keys(a),o=0;o<d.length;o++){var i="{mediainfo."+n+"."+d[o]+"}";t[i]=a[d[o]]}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t,n){"use strict";function a(e){if("playing"===e.type&&"preroll?"===this.ads.state)o(this,"ad",e);else if("playing"!==e.type||"ad-playback"!==this.ads.state||this.ads.videoElementRecycled())if("playing"===e.type&&"ads-ready?"===this.ads.state)o(this,"ad",e);else{if("playing"===e.type&&"ad-playback"===this.ads.state&&this.ads.videoElementRecycled())return void d(this,e);if("ad-playback"===this.ads.state)(this.ads.videoElementRecycled()||this.ads.stitchedAds())&&o(this,"ad",e);else if("content-playback"===this.ads.state&&"ended"===e.type)o(this,"content",e);else if("content-resuming"===this.ads.state){if(this.ads.snapshot&&this.currentSrc()!==this.ads.snapshot.currentSrc){if("loadstart"===e.type)return;return o(this,"content",e)}if(this.ads.snapshot&&this.ads.snapshot.ended){if("pause"===e.type||"ended"===e.type)return;return o(this,"content",e)}"playing"!==e.type&&o(this,"content",e)}}else o(this,"ad",e)}n.__esModule=!0,n["default"]=a;var d=function(e,t){t.isImmediatePropagationStopped=function(){return!0},t.cancelBubble=!0,t.isPropagationStopped=function(){return!0}},o=function(e,t,n){d(e,n),e.trigger({type:t+n.type,state:e.ads.state,originalEvent:n})}},{}],6:[function(e,t,n){(function(t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function d(e){var t=void 0;t=u["default"].browser.IS_IOS&&e.ads.isLive(e)&&e.seekable().length>0?e.currentTime()-e.seekable().end(0):e.currentTime();var n=e.$(".vjs-tech"),a=e.remoteTextTracks?e.remoteTextTracks():[],d=e.textTracks?e.textTracks():[],o=[],i=[],s={ended:e.ended(),currentSrc:e.currentSrc(),src:e.tech_.src(),currentTime:t,type:e.currentType()};n&&(s.nativePoster=n.poster,s.style=n.getAttribute("style"));for(var r=0;r<a.length;r++){var l=a[r];o.push({track:l,mode:l.mode}),l.mode="disabled"}s.suppressedRemoteTracks=o;for(var c=0;c<d.length;c++){var f=d[c];i.push({track:f,mode:f.mode}),f.mode="disabled"}return s.suppressedTracks=i,s}function o(e,t){if(!0===e.ads.disableNextSnapshotRestore)return void(e.ads.disableNextSnapshotRestore=!1);var n=e.$(".vjs-tech"),a=20,d=t.suppressedRemoteTracks,o=t.suppressedTracks,i=void 0,r=function(){for(var e=0;e<d.length;e++)i=d[e],i.track.mode=i.mode;for(var t=0;t<o.length;t++)i=o[t],i.track.mode=i.mode},l=function(){var n=void 0;u["default"].browser.IS_IOS&&e.ads.isLive(e)?t.currentTime<0&&(n=e.seekable().length>0?e.seekable().end(0)+t.currentTime:e.currentTime(),e.currentTime(n)):t.ended?e.currentTime(e.duration()):e.currentTime(t.currentTime),t.ended||e.play()},c=function f(){if(e.off("contentcanplay",f),e.ads.tryToResumeTimeout_&&(e.clearTimeout(e.ads.tryToResumeTimeout_),e.ads.tryToResumeTimeout_=null),n=e.el().querySelector(".vjs-tech"),n.readyState>1)return l();if(n.seekable===undefined)return l();if(n.seekable.length>0)return l();if(a--)s["default"].setTimeout(f,50);else try{l()}catch(t){u["default"].log.warn("Failed to resume the content after an advertisement",t)}};t.nativePoster&&(n.poster=t.nativePoster),"style"in t&&n.setAttribute("style",t.style||""),e.ads.videoElementRecycled()?(e.one("contentloadedmetadata",r),e.src({src:t.currentSrc,type:t.type}),e.load(),e.one("contentcanplay",c),e.ads.tryToResumeTimeout_=e.setTimeout(c,2e3)):e.ended()&&t.ended||(r(),e.play())}n.__esModule=!0,n.getPlayerSnapshot=d,n.restorePlayerSnapshot=o;var i=e(9),s=a(i),r="undefined"!=typeof window?window.videojs:void 0!==t?t.videojs:null,u=a(r)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(e,t,n){},{}],8:[function(e,t,n){(function(n){var a,d=void 0!==n?n:"undefined"!=typeof window?window:{},o=e(7);"undefined"!=typeof document?a=document:(a=d["__GLOBAL_DOCUMENT_CACHE@4"])||(a=d["__GLOBAL_DOCUMENT_CACHE@4"]=o),t.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(e,t,n){(function(e){var n;n="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],10:[function(e,t,n){(function(t){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{default:e}}var d=e(9),o=a(d),i="undefined"!=typeof window?window.videojs:void 0!==t?t.videojs:null,s=a(i),r=e(5),u=a(r),l=e(6),c=n(l),f=e(2),p=a(f),y=e(1),m=a(y),h=e(4),v=a(h),g=e(3),T=n(g),b=s["default"].getTech("Html5").Events,_=function(e){var t=e.$(".vjs-tech");t&&t.removeAttribute("poster")},w={timeout:5e3,prerollTimeout:100,postrollTimeout:100,debug:!1,stitchedAds:!1},k=function(e){var t=this,n=s["default"].mergeOptions(w,e),a=b.concat(["firstplay","loadedalldata","playing"]);t.on(a,u["default"]),t.on("ended",function(){t.hasClass("vjs-has-started")||t.addClass("vjs-has-started")}),t.on(["addurationchange","adcanplay"],function(){t.currentSrc()!==t.ads.snapshot.currentSrc&&t.play()}),t.on("nopreroll",function(){t.ads.nopreroll_=!0}),t.on("nopostroll",function(){t.ads.nopostroll_=!0}),t.on(["ads-ad-started","playing"],function(){t.removeClass("vjs-ad-loading")}),t.ads={state:"content-set",disableNextSnapshotRestore:!1,_contentHasEnded:!1,adType:null,VERSION:"4.2.8",reset:function(){t.ads.disableNextSnapshotRestore=!1,t.ads._contentHasEnded=!1,t.ads.snapshot=null,t.ads.adType=null},startLinearAdMode:function(){"preroll?"!==t.ads.state&&"content-playback"!==t.ads.state&&"postroll?"!==t.ads.state||t.trigger("adstart")},endLinearAdMode:function(){"ad-playback"===t.ads.state&&(t.trigger("adend"),t.removeClass("vjs-ad-loading"))},skipLinearAdMode:function(){"ad-playback"!==t.ads.state&&t.trigger("adskip")},stitchedAds:function(e){return e!==undefined&&(this._stitchedAds=!!e),this._stitchedAds},videoElementRecycled:function(){if(t.ads.shouldPlayContentBehindAd(t))return!1;if(!this.snapshot)throw new Error("You cannot use videoElementRecycled while there is no snapshot.");var e=t.tech_.src()!==this.snapshot.src,n=t.currentSrc()!==this.snapshot.currentSrc;return e||n},isLive:function(e){return e.duration()===Infinity||"8"===s["default"].browser.IOS_VERSION&&0===e.duration()},shouldPlayContentBehindAd:function(e){return!s["default"].browser.IS_IOS&&!s["default"].browser.IS_ANDROID&&e.duration()===Infinity}},t.ads.stitchedAds(n.stitchedAds),t.ads.cueTextTracks=T,t.ads.adMacroReplacement=v["default"].bind(t),(0,p["default"])(t),t.on("contentupdate",t.ads.reset);var d={"content-set":{events:{adscanceled:function(){this.state="content-playback"},adsready:function(){this.state="ads-ready"},play:function(){this.state="ads-ready?",(0,m["default"])(t),_(t)},adserror:function(){this.state="content-playback"},adskip:function(){this.state="content-playback"}}},"ads-ready":{events:{play:function(){this.state="preroll?",(0,m["default"])(t)},adskip:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"}}},"preroll?":{enter:function(){t.ads.nopreroll_?(t.trigger("readyforpreroll"),o["default"].setTimeout(function(){t.trigger("nopreroll")},1)):(t.addClass("vjs-ad-loading"),t.ads.adTimeoutTimeout=o["default"].setTimeout(function(){t.trigger("adtimeout")},n.prerollTimeout),t.trigger("readyforpreroll"))},leave:function(){o["default"].clearTimeout(t.ads.adTimeoutTimeout)},events:{play:function(){(0,m["default"])(t)},adstart:function(){this.state="ad-playback",t.ads.adType="preroll"},adskip:function(){this.state="content-playback"},adtimeout:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"},nopreroll:function(){this.state="content-playback"}}},"ads-ready?":{enter:function(){t.addClass("vjs-ad-loading"),t.ads.adTimeoutTimeout=o["default"].setTimeout(function(){t.trigger("adtimeout")},n.timeout)},leave:function(){o["default"].clearTimeout(t.ads.adTimeoutTimeout),t.removeClass("vjs-ad-loading")},events:{play:function(){(0,m["default"])(t)},adscanceled:function(){this.state="content-playback"},adsready:function(){this.state="preroll?"},adskip:function(){this.state="content-playback"},adtimeout:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"}}},"ad-playback":{enter:function(){t.ads.shouldPlayContentBehindAd(t)||(this.snapshot=c.getPlayerSnapshot(t)),t.ads.shouldPlayContentBehindAd(t)&&(this.preAdVolume_=t.volume(),t.volume(0)),t.addClass("vjs-ad-playing"),t.hasClass("vjs-live")&&t.removeClass("vjs-live"),_(t),t.ads.cancelPlayTimeout&&o["default"].setTimeout(function(){o["default"].clearTimeout(t.ads.cancelPlayTimeout),t.ads.cancelPlayTimeout=null},1)},leave:function(){t.removeClass("vjs-ad-playing"),t.ads.isLive(t)&&t.addClass("vjs-live"),t.ads.shouldPlayContentBehindAd(t)||c.restorePlayerSnapshot(t,this.snapshot),t.ads.shouldPlayContentBehindAd(t)&&t.volume(this.preAdVolume_)},events:{adend:function(){this.state="content-resuming",t.ads.adType=null},adserror:function(){this.state="content-resuming",t.trigger("adend")}}},"content-resuming":{enter:function(){this._contentHasEnded&&(o["default"].clearTimeout(t.ads._fireEndedTimeout),t.ads._fireEndedTimeout=o["default"].setTimeout(function(){t.trigger("ended")},1e3))},leave:function(){o["default"].clearTimeout(t.ads._fireEndedTimeout)},events:{contentupdate:function(){this.state="content-set"},contentresumed:function(){this.state="content-playback"},playing:function(){this.state="content-playback"},ended:function(){this.state="content-playback"}}},"postroll?":{enter:function(){this.snapshot=c.getPlayerSnapshot(t),t.ads.nopostroll_?o["default"].setTimeout(function(){t.ads.state="content-resuming",t.trigger("ended")},1):(t.addClass("vjs-ad-loading"),t.ads.adTimeoutTimeout=o["default"].setTimeout(function(){t.trigger("adtimeout")},n.postrollTimeout))},leave:function(){o["default"].clearTimeout(t.ads.adTimeoutTimeout),t.removeClass("vjs-ad-loading")},events:{adstart:function(){this.state="ad-playback",t.ads.adType="postroll"},adskip:function(){this.state="content-resuming",o["default"].setTimeout(function(){t.trigger("ended")},1)},adtimeout:function(){this.state="content-resuming",o["default"].setTimeout(function(){t.trigger("ended")},1)},adserror:function(){this.state="content-resuming",o["default"].setTimeout(function(){t.trigger("ended")},1)},contentupdate:function(){this.state="ads-ready?"}}},"content-playback":{enter:function(){t.ads.cancelPlayTimeout&&(o["default"].clearTimeout(t.ads.cancelPlayTimeout),t.ads.cancelPlayTimeout=null),t.trigger({type:"contentplayback",triggerevent:t.ads.triggerevent}),t.ads.cancelledPlay&&(t.ads.cancelledPlay=!1,t.paused()&&t.play())},events:{adsready:function(){t.trigger("readyforpreroll")},adstart:function(){this.state="ad-playback","preroll"!==t.ads.adType&&(t.ads.adType="midroll")},contentupdate:function(){t.ads.shouldPlayContentBehindAd(t)||(0,m["default"])(t),t.paused()?this.state="content-set":this.state="ads-ready?"},contentended:function(){if(this._contentHasEnded)return void(this.state="content-resuming");this._contentHasEnded=!0,this.state="postroll?"}}}},i=function(e){var a=t.ads.state,o=d[a].events;if(o){var i=o[e.type];i&&i.apply(t.ads)}if(a!==t.ads.state){var r=a,u=t.ads.state;t.ads.triggerevent=e.type,d[r].leave&&d[r].leave.apply(t.ads),d[u].enter&&d[u].enter.apply(t.ads),n.debug&&s["default"].log("ads",t.ads.triggerevent+" triggered: "+r+" -> "+u);
}};t.on(b.concat(["adtimeout","contentupdate","contentplaying","contentended","contentresumed","adstart","adend","adskip","adsready","adserror","adscanceled","nopreroll"]),i),t.on("dispose",function(){t.ads.adTimeoutTimeout&&o["default"].clearTimeout(t.ads.adTimeoutTimeout),t.ads._fireEndedTimeout&&o["default"].clearTimeout(t.ads._fireEndedTimeout),t.ads.cancelPlayTimeout&&o["default"].clearTimeout(t.ads.cancelPlayTimeout),t.ads.tryToResumeTimeout_&&t.clearTimeout(t.ads.tryToResumeTimeout_)}),t.paused()||i({type:"play"})};(s["default"].registerPlugin||s["default"].plugin)("ads",k)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])}).call(window)},function(module,exports,__webpack_require__){var content=__webpack_require__(32);if(typeof content==="string")content=[[module.id,content,""]];var update=__webpack_require__(29)(content,{});if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../css-loader/index.js!./videojs.ima.css",function(){var newContent=require("!!../../../css-loader/index.js!./videojs.ima.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(28)();exports.push([module.id,'.ima-ad-container{top:0;position:absolute;display:block;width:100%;height:100%}.video-js.vjs-playing .bumpable-ima-ad-container{margin-top:-50px}.video-js.vjs-user-inactive.vjs-playing .bumpable-ima-ad-container{margin-top:0}.video-js.vjs-paused .bumpable-ima-ad-container,.video-js.vjs-playing:hover .bumpable-ima-ad-container,.video-js.vjs-user-active.vjs-playing .bumpable-ima-ad-container{margin-top:-50px}.vjs-ima-non-linear .vjs-big-play-button,.vjs-ima-non-linear .vjs-control-bar,.vjs-ima-non-linear .vjs-info-overlay,.vjs-ima-non-linear .vjs-menu.vjs-settings-menu,.vjs-ima-non-linear .vjs-modal-overlay{z-index:1112}.ima-controls-div{bottom:0;height:37px;position:absolute;overflow:hidden;display:none;opacity:1;background-color:rgba(7,20,30,.7);background:linear-gradient(0deg,rgba(7,20,30,.7) 0,rgba(7,20,30,0));filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#0007141E",endColorstr="#07141E",GradientType=0)}.ima-countdown-div{height:10px;color:#fff;text-shadow:0 0 .2em #000;cursor:default}.ima-seek-bar-div{top:12px;height:3px;position:absolute;background:hsla(0,0%,100%,.4)}.ima-progress-div{width:0;height:3px;background-color:#ecc546}.ima-fullscreen-div,.ima-mute-div,.ima-play-pause-div,.ima-slider-div{width:35px;height:20px;top:11px;left:0;position:absolute;color:#ccc;font-size:1.5em;line-height:2;text-align:center;font-family:VideoJS;cursor:pointer}.ima-mute-div{left:auto;right:85px}.ima-slider-div{left:auto;right:35px;width:50px;height:10px;top:20px;background-color:#555}.ima-slider-level-div{width:100%;height:10px;background-color:#ecc546}.ima-fullscreen-div{left:auto;right:0}.ima-playing:before{content:"\\F103"}.ima-paused:before{content:"\\F101"}.ima-paused:hover:before,.ima-playing:hover:before{text-shadow:0 0 1em #fff}.ima-non-muted:before{content:"\\F107"}.ima-muted:before{content:"\\F104"}.ima-muted:hover:before,.ima-non-muted:hover:before{text-shadow:0 0 1em #fff}.ima-non-fullscreen:before{content:"\\F108"}.ima-fullscreen:before{content:"\\F109"}.ima-fullscreen:hover:before,.ima-non-fullscreen:hover:before{text-shadow:0 0 1em #fff}.video-js.vjs-ad-playing .vjs-control-bar{z-index:1112}.video-js.vjs-ad-playing .vjs-control-bar .vjs-progress-control{pointer-events:none}.video-js.vjs-ad-playing .vjs-control-bar .vjs-mouse-display-tooltip,.video-js.vjs-ad-playing .vjs-control-bar .vjs-play-progress:before,.video-js.vjs-ad-playing .vjs-control-bar .vjs-progress-control .vjs-load-progress,.video-js.vjs-ad-playing .vjs-control-bar .vjs-progress-control .vjs-mouse-display,.video-js.vjs-ad-playing .vjs-control-bar .vjs-progress-control:before,.video-js.vjs-ad-playing .vjs-control-bar>:not(.vjs-play-control):not(.vjs-volume-menu-button):not(.vjs-time-control):not(.vjs-progress-control):not(.vjs-spacer):not(.vjs-fullscreen-control):not(.vjs-gradient):not(.ima-countdown-div){display:none}.video-js.vjs-ad-playing .vjs-control-bar{transition:height .1s ease}.video-js.vjs-ad-playing.vjs-user-inactive:not(.vjs-ad-paused) .vjs-control-bar{opacity:1;height:0}.video-js.vjs-ad-playing.vjs-user-inactive:not(.vjs-ad-paused) .vjs-control-bar .vjs-progress-holder{margin:0}.video-js.vjs-ad-playing .vjs-control-bar>:not(.vjs-progress-control):not(.ima-countdown-div){transition:opacity .1s ease,visibility .1s ease}.video-js.vjs-ad-playing .vjs-control-bar>:not(.vjs-progress-control):not(.ima-countdown-div) div{transition:line-height .1s ease}.video-js.vjs-ad-playing.vjs-user-inactive:not(.vjs-ad-paused) .vjs-control-bar>:not(.vjs-progress-control):not(.ima-countdown-div){opacity:0;visibility:hidden;overflow:hidden}.video-js.vjs-ad-playing.vjs-user-inactive:not(.vjs-ad-paused) .vjs-control-bar>:not(.vjs-progress-control):not(.ima-countdown-div) div{line-height:.01em}.video-js.vjs-ad-playing .vjs-control-bar .vjs-progress-control .vjs-thumbnail,.video-js.vjs-ad-playing .vjs-control-bar .vjs-progress-control .vjs-thumbnail-holder{display:none!important}.video-js.vjs-ad-playing .vjs-control-bar .vjs-progress-control .vjs-progress-holder{cursor:auto;box-shadow:none;font-size:100%;margin:0 1em}.video-js .vjs-control-bar .ima-countdown-div{display:none;z-index:1}.video-js.vjs-ad-playing .vjs-control-bar .ima-countdown-div{display:block;position:absolute;margin-top:-2em;left:2em;font-size:1.2em}',""])},function(module,exports){(function(){var require=undefined;var module=undefined;var exports=undefined;var define=undefined;(function(factory){if(typeof define==="function"&&define["amd"]){define(["video.js","videojs-contrib-ads"],function(videojs){factory(window,document,videojs)})}else if(typeof exports==="object"&&typeof module==="object"){var vjs=require("video.js");require("videojs-contrib-ads");factory(window,document,vjs)}else{factory(window,document,videojs)}})(function(window,document,videojs){"use strict";var extend=function(obj){var arg;var index;var key;for(index=1;index<arguments.length;index++){arg=arguments[index];for(key in arg){if(arg.hasOwnProperty(key)){obj[key]=arg[key]}}}return obj};var ima_defaults={debug:false,timeout:5e3,prerollTimeout:100,adLabel:"Advertisement",showControlsForAds:true,showControlsForJSAds:true,adsRenderingSettings:{uiElements:[]}};var eventTypes=videojs.browser.IS_ANDROID||videojs.browser.IS_IOS?{click:"touchend",mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"}:{click:"click",mousedown:"mousedown",mouseup:"mouseup",mousemove:"mousemove"};var init=function(options,readyCallback){this.ima=new ImaPlugin(this,options,readyCallback)};var ImaPlugin=function(player,options,readyCallback){this.player=player;var assignControlAttributes_=function(element,controlName){element.id=this.controlPrefix+controlName;element.className=this.controlPrefix+controlName+" "+controlName}.bind(this);var getClassRegexp_=function(className){return new RegExp("(^|[^A-Za-z-])"+className+"((?![A-Za-z-])|$)","gi")};var addClass_=function(element,classToAdd){if(getClassRegexp_(classToAdd).test(element.className)){return element}return element.className=element.className.trim()+" "+classToAdd};var removeClass_=function(element,classToRemove){var classRegexp=getClassRegexp_(classToRemove);if(!classRegexp.test(element.className)){return element}return element.className=element.className.trim().replace(classRegexp,"")};var createAdContainer_=function(){this.vjsControls=this.player.getChild("controlBar");this.adContainerDiv=this.vjsControls.el().parentNode.appendChild(document.createElement("div"));assignControlAttributes_(this.adContainerDiv,"ima-ad-container");this.adContainerDiv.style.position="absolute";this.adContainerDiv.style.zIndex=1111;this.adContainerDiv.addEventListener("mouseenter",showAdControls_,false);this.adContainerDiv.addEventListener("mouseleave",hideAdControls_,false);createControls_();this.adDisplayContainer=new google.ima.AdDisplayContainer(this.adContainerDiv,this.contentPlayer);this.showAdContainer(!this.settings.manual)}.bind(this);var createControls_=function(){this.controlsDiv=document.createElement("div");assignControlAttributes_(this.controlsDiv,"ima-controls-div");this.controlsDiv.style.width="100%";this.countdownDiv=document.createElement("div");assignControlAttributes_(this.countdownDiv,"ima-countdown-div");this.countdownDiv.innerHTML=this.settings.adLabel;this.countdownDiv.style.display=this.showCountdown?"":"none";this.seekBarDiv=document.createElement("div");assignControlAttributes_(this.seekBarDiv,"ima-seek-bar-div");this.seekBarDiv.style.width="100%";this.progressDiv=document.createElement("div");assignControlAttributes_(this.progressDiv,"ima-progress-div");this.playPauseDiv=document.createElement("div");assignControlAttributes_(this.playPauseDiv,"ima-play-pause-div");addClass_(this.playPauseDiv,"ima-playing");this.playPauseDiv.addEventListener(eventTypes.click,onAdPlayPauseClick_,false);this.muteDiv=document.createElement("div");assignControlAttributes_(this.muteDiv,"ima-mute-div");addClass_(this.muteDiv,"ima-non-muted");this.muteDiv.addEventListener(eventTypes.click,onAdMuteClick_,false);this.sliderDiv=document.createElement("div");assignControlAttributes_(this.sliderDiv,"ima-slider-div");this.sliderDiv.addEventListener(eventTypes.mousedown,onAdVolumeSliderMouseDown_,false);this.sliderLevelDiv=document.createElement("div");assignControlAttributes_(this.sliderLevelDiv,"ima-slider-level-div");this.fullscreenDiv=document.createElement("div");assignControlAttributes_(this.fullscreenDiv,"ima-fullscreen-div");addClass_(this.fullscreenDiv,"ima-non-fullscreen");this.fullscreenDiv.addEventListener(eventTypes.click,onAdFullscreenClick_,false);this.adContainerDiv.appendChild(this.controlsDiv);this.controlsDiv.appendChild(this.seekBarDiv);this.controlsDiv.appendChild(this.playPauseDiv);this.controlsDiv.appendChild(this.muteDiv);this.controlsDiv.appendChild(this.sliderDiv);this.controlsDiv.appendChild(this.fullscreenDiv);this.seekBarDiv.appendChild(this.progressDiv);this.sliderDiv.appendChild(this.sliderLevelDiv);if(this.settings.vjsControls){this.initVjsControls();this.controlsDiv.style.display="none";this.vjsControls.el().appendChild(this.countdownDiv)}else{this.controlsDiv.appendChild(this.countdownDiv)}}.bind(this);this.showAdContainer=function(show){this.adContainerDiv.style.display=show?"block":"none";this.player.toggleClass("vjs-ima-ad",show)}.bind(this);this.initializeAdDisplayContainer=function(){this.adDisplayContainerInitialized=true;this.adDisplayContainer.initialize()}.bind(this);this.requestAds=function(){if(!this.adDisplayContainerInitialized){this.adDisplayContainer.initialize()}var adsRequest=new google.ima.AdsRequest;if(this.settings.adTagUrl){adsRequest.adTagUrl=this.settings.adTagUrl}else{adsRequest.adsResponse=this.settings.adsResponse}if(this.settings.forceNonLinearFullSlot){adsRequest.forceNonLinearFullSlot=true}adsRequest.linearAdSlotWidth=this.getPlayerWidth();adsRequest.linearAdSlotHeight=this.getPlayerHeight();adsRequest.nonLinearAdSlotWidth=this.settings.nonLinearWidth||this.getPlayerWidth();adsRequest.nonLinearAdSlotHeight=this.settings.nonLinearHeight||this.getPlayerHeight()/3;this.adsLoader.requestAds(adsRequest)}.bind(this);var onAdsManagerLoaded_=function(adsManagerLoadedEvent){this.adsManager=adsManagerLoadedEvent.getAdsManager(this.contentPlayheadTracker,this.adsRenderingSettings);this.adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,onAdError_);this.adsManager.addEventListener(google.ima.AdEvent.Type.AD_BREAK_READY,onAdBreakReady_);this.adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,this.onContentPauseRequested_);this.adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,this.onContentResumeRequested_);this.adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,onAllAdsCompleted_);this.adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,onAdLoaded_);this.adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,onAdStarted_);this.adsManager.addEventListener(google.ima.AdEvent.Type.CLICK,onAdPlayPauseClick_);this.adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,this.onAdComplete_);this.adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED,this.onAdComplete_);this.adsManager.addEventListener(google.ima.AdEvent.Type.PAUSED,this.onAdPaused_);this.adsManager.addEventListener(google.ima.AdEvent.Type.RESUMED,this.onAdResumed_);var eventsMap={load:google.ima.AdEvent.Type.LOADED,"ad-started":google.ima.AdEvent.Type.STARTED,click:google.ima.AdEvent.Type.CLICK,"ad-ended":google.ima.AdEvent.Type.COMPLETE,"ad-skipped":google.ima.AdEvent.Type.SKIPPED,"first-quartile":google.ima.AdEvent.Type.FIRST_QUARTILE,midpoint:google.ima.AdEvent.Type.MIDPOINT,"third-quartile":google.ima.AdEvent.Type.THIRD_QUARTILE,impression:google.ima.AdEvent.Type.IMPRESSION,pause:google.ima.AdEvent.Type.PAUSED,play:google.ima.AdEvent.Type.RESUMED,mute:google.ima.AdEvent.Type.VOLUME_MUTED};Object.keys(eventsMap).forEach(function(event){this.adsManager.addEventListener(eventsMap[event],function(){this.player.trigger("ads-"+event)}.bind(this))}.bind(this));if(!this.autoPlayAdBreaks){try{var initWidth=this.getPlayerWidth();var initHeight=this.getPlayerHeight();this.adsManagerDimensions.width=initWidth;this.adsManagerDimensions.height=initHeight;this.adsManager.init(initWidth,initHeight,google.ima.ViewMode.NORMAL);this.adsManager.setVolume(this.player.muted()?0:this.player.volume())}catch(adError){onAdError_(adError)}}var cuepoints=this.adsManager.getCuePoints();var foundpreroll=!cuepoints.length;var foundpostroll=false;cuepoints.forEach(function(offset){if(!offset)foundpreroll=true;else if(offset==-1)foundpostroll=true});if(!foundpreroll)this.player.trigger("nopreroll");if(!foundpostroll)this.player.trigger("nopostroll");if(cuepoints.length)this.player.trigger("ads-cuepoints",cuepoints);this.player.trigger("adsready")}.bind(this);this.start=function(){window.console.log("WARNING: player.ima.start is deprecated. Use "+"player.ima.startFromReadyCallback instead.")};this.startFromReadyCallback=function(){if(this.autoPlayAdBreaks&&this.adsManager){try{this.adsManager.init(this.getPlayerWidth(),this.getPlayerHeight(),google.ima.ViewMode.NORMAL);this.adsManager.setVolume(this.player.muted()?0:this.player.volume());this.adsManager.start()}catch(adError){onAdError_(adError)}}}.bind(this);var onAdsLoaderError_=function(event){window.console.log("AdsLoader error: "+event.getError());this.showAdContainer(false);if(this.adsManager){this.adsManager.destroy()}this.player.trigger({type:"adserror",data:{AdError:event.getError(),AdErrorEvent:event}})}.bind(this);var onAdError_=function(adErrorEvent){var errorMessage=adErrorEvent.getError!==undefined?adErrorEvent.getError():adErrorEvent.stack;window.console.log("Ad error: "+errorMessage);this.vjsControls.show();this.adsManager.destroy();this.showAdContainer(false);this.updateVjsControls();this.player.trigger({type:"adserror",data:{AdError:errorMessage,AdErrorEvent:adErrorEvent}})}.bind(this);var onAdBreakReady_=function(adEvent){this.adBreakReadyListener(adEvent)}.bind(this);this.playAdBreak=function(){if(!this.autoPlayAdBreaks){this.adsManager.start()}}.bind(this);this.resetLoop=function(){this.contentLoop=this.contentPlayer&&this.contentPlayer.loop;if(this.contentLoop){this.contentPlayer.loop=false}}.bind(this);this.restoreLoop=function(){if(this.contentLoop){this.contentPlayer.loop=true;this.contentLoop=false}}.bind(this);this.onContentPauseRequested_=function(adEvent){this.contentSource=this.player.currentSrc();this.resetLoop();this.player.off("contentended",this.localContentEndedListener);this.player.ads.startLinearAdMode();this.showAdContainer(true);var contentType=adEvent.getAd().getContentType();if(!this.settings.vjsControls||!this.settings.showControlsForAds){if(!this.settings.showControlsForAds||contentType==="application/javascript"&&!this.settings.showControlsForJSAds){this.controlsDiv.style.display="none"}else{this.controlsDiv.style.display="block"}this.vjsControls.hide()}showPlayButton();this.player.pause();this.adsActive=true;this.adPlaying=true;this.updateVjsControls()}.bind(this);this.onContentResumeRequested_=function(adEvent){this.contentResumeTimer=clearTimeout(this.contentResumeTimer);this.restoreLoop();this.adsActive=false;this.adPlaying=false;this.player.on("contentended",this.localContentEndedListener);if(this.currentAd==null||this.currentAd.isLinear()){this.showAdContainer(false)}this.vjsControls.show();this.player.ads.endLinearAdMode();this.countdownDiv.innerHTML="";this.updateVjsControls()}.bind(this);var onAllAdsCompleted_=function(adEvent){this.allAdsCompleted=true;this.showAdContainer(false);if(this.contentComplete==true){if(this.contentPlayer.src&&!/^blob:/.test(this.contentPlayer.src)&&this.contentSource&&this.contentPlayer.src!=this.contentSource){this.player.src(this.contentSource)}for(var index in this.contentAndAdsEndedListeners){this.contentAndAdsEndedListeners[index]()}}}.bind(this);var onAdLoaded_=function(adEvent){if(!adEvent.getAd().isLinear()&&!this.player.ended()){this.player.ads.endLinearAdMode();this.player.play()}}.bind(this);var onAdStarted_=function(adEvent){this.currentAd=adEvent.getAd();if(this.currentAd.isLinear()){this.adTrackingTimer=setInterval(onAdPlayheadTrackerInterval_,250);removeClass_(this.adContainerDiv,"bumpable-ima-ad-container")}else{addClass_(this.adContainerDiv,"bumpable-ima-ad-container");this.player.addClass("vjs-ima-non-linear");this.showAdContainer(true)}}.bind(this);this.onAdComplete_=function(adEvent){if(this.currentAd.isLinear()){clearInterval(this.adTrackingTimer);var pod=this.currentAd.getAdPodInfo();if(pod&&pod.getAdPosition()<pod.getTotalAds())return;this.contentResumeTimer=setTimeout(function(){this.onContentResumeRequested_(null)}.bind(this),1e3)}else{this.player.removeClass("vjs-ima-non-linear")}}.bind(this);this.onAdPaused_=function(adEvent){showPauseButton();this.adPlaying=false}.bind(this);this.onAdResumed_=function(adEvent){showPlayButton();this.adPlaying=true}.bind(this);var formatTime=function(time){var m=Math.floor(time/60);var s=Math.floor(time%60);if(s.toString().length<2){s="0"+s}return m+":"+s};var onAdPlayheadTrackerInterval_=function(){var remainingTime=this.adsManager.getRemainingTime();var duration=this.currentAd.getDuration();var currentTime=duration-remainingTime;currentTime=currentTime>0?currentTime:0;var isPod=false;var totalAds=0;var adPosition;if(this.currentAd.getAdPodInfo()){isPod=true;adPosition=this.currentAd.getAdPodInfo().getAdPosition();totalAds=this.currentAd.getAdPodInfo().getTotalAds()}var podCount=": ";if(isPod&&totalAds>1){podCount=" ("+adPosition+" of "+totalAds+"): "}this.countdownDiv.innerHTML=this.settings.adLabel+podCount+formatTime(remainingTime);var playProgressRatio=currentTime/duration;var playProgressPercent=playProgressRatio*100;this.progressDiv.style.width=playProgressPercent+"%";this.updateVjsControls()}.bind(this);this.getPlayerWidth=function(){var retVal=parseInt(getComputedStyle(this.player.el()).width,10)||this.player.width();return retVal}.bind(this);this.getPlayerHeight=function(){var retVal=parseInt(getComputedStyle(this.player.el()).height,10)||this.player.height();return retVal}.bind(this);var hideAdControls_=function(){this.controlsDiv.style.height="14px";this.playPauseDiv.style.display="none";this.muteDiv.style.display="none";this.sliderDiv.style.display="none";this.fullscreenDiv.style.display="none"}.bind(this);var showAdControls_=function(){this.controlsDiv.style.height="37px";this.playPauseDiv.style.display="block";this.muteDiv.style.display="block";this.sliderDiv.style.display="block";this.fullscreenDiv.style.display="block"}.bind(this);var showPauseButton=function(){addClass_(this.playPauseDiv,"ima-paused");removeClass_(this.playPauseDiv,"ima-playing")}.bind(this);var showPlayButton=function(){addClass_(this.playPauseDiv,"ima-playing");removeClass_(this.playPauseDiv,"ima-paused")}.bind(this);var onAdPlayPauseClick_=function(){if(this.adPlaying){showPauseButton();this.adsManager.pause();this.adPlaying=false}else{showPlayButton();this.adsManager.resume();this.adPlaying=true}}.bind(this);var onAdMuteClick_=function(){if(this.adMuted){addClass_(this.muteDiv,"ima-non-muted");removeClass_(this.muteDiv,"ima-muted");this.adsManager.setVolume(1);this.player.muted(false);this.adMuted=false;this.sliderLevelDiv.style.width=this.player.volume()*100+"%"}else{addClass_(this.muteDiv,"ima-muted");removeClass_(this.muteDiv,"ima-non-muted");this.adsManager.setVolume(0);this.player.muted(true);this.adMuted=true;this.sliderLevelDiv.style.width="0%"}}.bind(this);var onAdVolumeSliderMouseDown_=function(){document.addEventListener(eventTypes.mouseup,onMouseUp_,false);document.addEventListener(eventTypes.mousemove,onMouseMove_,false)};var onMouseMove_=function(event){setVolumeSlider_(event)};var onMouseUp_=function(event){setVolumeSlider_(event);document.removeEventListener(eventTypes.mousemove,onMouseMove_);document.removeEventListener(eventTypes.mouseup,onMouseUp_)};var setVolumeSlider_=function(event){var clientX=event.changedTouches?event.changedTouches[0].clientX:event.clientX;var percent=(clientX-this.sliderDiv.getBoundingClientRect().left)/this.sliderDiv.offsetWidth;percent*=100;percent=Math.min(Math.max(percent,0),100);this.sliderLevelDiv.style.width=percent+"%";this.player.volume(percent/100);this.adsManager.setVolume(percent/100);if(this.player.volume()==0){addClass_(this.muteDiv,"ima-muted");removeClass_(this.muteDiv,"ima-non-muted");this.player.muted(true);this.adMuted=true}else{addClass_(this.muteDiv,"ima-non-muted");removeClass_(this.muteDiv,"ima-muted");this.player.muted(false);this.adMuted=false}}.bind(this);var onAdFullscreenClick_=function(){if(this.player.isFullscreen()){this.player.exitFullscreen()}else{this.player.requestFullscreen()}}.bind(this);var onFullscreenChange_=function(){if(this.player.isFullscreen()){addClass_(this.fullscreenDiv,"ima-fullscreen");removeClass_(this.fullscreenDiv,"ima-non-fullscreen");if(this.adsManager){this.adsManager.resize(window.screen.width,window.screen.height,google.ima.ViewMode.FULLSCREEN)}}else{addClass_(this.fullscreenDiv,"ima-non-fullscreen");removeClass_(this.fullscreenDiv,"ima-fullscreen");if(this.adsManager){this.adsManager.resize(this.getPlayerWidth(),this.getPlayerHeight(),google.ima.ViewMode.NORMAL)}}}.bind(this);var onVolumeChange_=function(){var newVolume=this.player.muted()?0:this.player.volume();if(this.adsManager){this.adsManager.setVolume(newVolume)}if(newVolume==0){this.adMuted=true;addClass_(this.muteDiv,"ima-muted");removeClass_(this.muteDiv,"ima-non-muted");this.sliderLevelDiv.style.width="0%"}else{this.adMuted=false;addClass_(this.muteDiv,"ima-non-muted");removeClass_(this.muteDiv,"ima-muted");this.sliderLevelDiv.style.width=newVolume*100+"%"}}.bind(this);var seekContentToZero_=function(){this.player.off("loadedmetadata",seekContentToZero_);this.player.currentTime(0)}.bind(this);var playContentFromZero_=function(){this.player.off("loadedmetadata",playContentFromZero_);this.player.currentTime(0);this.player.play()}.bind(this);var resetIMA_=function(){this.adsActive=false;this.adPlaying=false;this.restoreLoop();this.player.on("contentended",this.localContentEndedListener);if(this.currentAd&&this.currentAd.isLinear()){this.showAdContainer(false)}this.vjsControls.show();this.player.ads.endLinearAdMode();this.updateVjsControls();if(this.adTrackingTimer){clearInterval(this.adTrackingTimer)}if(this.adsManager){this.adsManager.destroy();this.adsManager=null}if(this.adsLoader&&!this.contentComplete){this.adsLoader.contentComplete()}this.contentComplete=false;this.allAdsCompleted=false}.bind(this);this.addEventListener=function(event,callback){if(this.adsManager){this.adsManager.addEventListener(event,callback)}}.bind(this);this.getAdsManager=function(){return this.adsManager}.bind(this);this.setContent=function(contentSrc,adTag,playOnLoad){window.console.log("WARNING: player.ima.setContent is deprecated. Use "+"player.ima.setContentWithAdTag instead.");this.setContentWithAdTag(contentSrc,adTag,playOnLoad)}.bind(this);this.setContentWithAdTag=function(contentSrc,adTag,playOnLoad){resetIMA_();this.settings.adTagUrl=adTag?adTag:this.settings.adTagUrl;changeSource_(contentSrc,playOnLoad)}.bind(this);this.setContentWithAdsResponse=function(contentSrc,adsResponse,playOnLoad){resetIMA_();this.settings.adsResponse=adsResponse?adsResponse:this.settings.adsResponse;changeSource_(contentSrc,playOnLoad)}.bind(this);this.playAd=function(adTag){resetIMA_();this.settings.adTagUrl=adTag?adTag:this.settings.adTagUrl;this.showAdContainer(true);this.requestAds()}.bind(this);var changeSource_=function(contentSrc,playOnLoad){if(!!this.player.currentSrc()){this.player.currentTime(0);this.player.pause()}if(contentSrc){this.player.src(contentSrc)}if(playOnLoad){this.player.on("loadedmetadata",playContentFromZero_)}else{this.player.on("loadedmetadata",seekContentToZero_)}}.bind(this);this.addContentEndedListener=function(listener){this.contentEndedListeners.push(listener)}.bind(this);this.addContentAndAdsEndedListener=function(listener){this.contentAndAdsEndedListeners.push(listener)}.bind(this);this.setAdBreakReadyListener=function(listener){this.adBreakReadyListener=listener}.bind(this);this.pauseAd=function(){if(this.adsActive&&this.adPlaying){showPauseButton();this.adsManager.pause();this.adPlaying=false}}.bind(this);this.resumeAd=function(){if(this.adsActive&&!this.adPlaying){showPlayButton();this.adsManager.resume();this.adPlaying=true}}.bind(this);var setUpPlayerIntervals_=function(){this.updateTimeIntervalHandle=setInterval(updateCurrentTime_,this.seekCheckInterval);this.seekCheckIntervalHandle=setInterval(checkForSeeking_,this.seekCheckInterval);this.resizeCheckIntervalHandle=setInterval(checkForResize_,this.resizeCheckInterval)}.bind(this);var updateStartTime_=function(){var cur=this.player.currentTime();if(!cur||this.player.ads.state!="content-playback")return;if(cur<1)cur=0;this.contentPlayheadTracker.startTime=cur;this.player.off("timeupdate",updateStartTime_)}.bind(this);var updateCurrentTime_=function(){if(this.player.ads.state=="content-playback"&&!this.contentPlayheadTracker.seeking&&this.contentPlayheadTracker.startTime>=0){this.contentPlayheadTracker.currentTime=this.player.currentTime()-this.contentPlayheadTracker.startTime}}.bind(this);var checkForSeeking_=function(){if(this.player.ads.state!="content-playback")return;var tempCurrentTime=this.player.currentTime();var diff=(tempCurrentTime-this.contentPlayheadTracker.previousTime)*1e3;if(Math.abs(diff)>this.seekCheckInterval+this.seekThreshold){this.contentPlayheadTracker.seeking=true}else{this.contentPlayheadTracker.seeking=false}this.contentPlayheadTracker.previousTime=this.player.currentTime()}.bind(this);var checkForResize_=function(){var currentWidth=this.getPlayerWidth();var currentHeight=this.getPlayerHeight();if(this.adsManager&&(currentWidth!=this.adsManagerDimensions.width||currentHeight!=this.adsManagerDimensions.height)){this.adsManagerDimensions.width=currentWidth;this.adsManagerDimensions.height=currentHeight;this.adsManager.resize(currentWidth,currentHeight,google.ima.ViewMode.NORMAL)}}.bind(this);this.setShowCountdown=function(showCountdownIn){this.showCountdown=showCountdownIn;this.countdownDiv.style.display=this.showCountdown?"":"none"}.bind(this);this.VERSION="0.2.0";this.settings;this.controlPrefix;this.contentPlayer;this.showCountdown;this.autoPlayAdBreaks;this.vjsControls;this.adContainerDiv;this.controlsDiv;this.countdownDiv;this.seekBarDiv;this.progressDiv;this.playPauseDiv;this.muteDiv;this.sliderDiv;this.sliderLevelDiv;this.fullscreenDiv;this.adDisplayContainer;this.adDisplayContainerInitialized=false;this.adsLoader;this.adsManager;this.adsRenderingSettings=null;this.adTagUrl;this.adsResponse;this.currentAd;this.contentTrackingTimer;this.adTrackingTimer;this.adsActive=false;this.adPlaying=false;this.adMuted=false;this.contentComplete=false;this.allAdsCompleted=false;this.updateTimeIntervalHandle;this.seekCheckIntervalHandle;this.seekCheckInterval=1e3;this.resizeCheckIntervalHandle;this.resizeCheckInterval=250;this.seekThreshold=100;this.contentPlayheadTracker={currentTime:0,previousTime:0,seeking:false,duration:0,startTime:-1};this.adPlayheadTracker={currentTime:0,duration:0,isPod:false,adPosition:0,totalAds:0};this.adsManagerDimensions={width:0,height:0};this.contentEndedListeners=[];this.contentAndAdsEndedListeners=[];this.adBreakReadyListener=undefined;this.contentSource="";this.localContentEndedListener=function(){if(this.adsLoader&&!this.contentComplete){this.adsLoader.contentComplete();this.contentComplete=true}for(var index in this.contentEndedListeners){this.contentEndedListeners[index]()}if(this.allAdsCompleted){for(var index in this.contentAndAdsEndedListeners){this.contentAndAdsEndedListeners[index]()}}clearInterval(this.updateTimeIntervalHandle);clearInterval(this.seekCheckIntervalHandle);clearInterval(this.resizeCheckIntervalHandle);if(this.player.el()){this.player.one("play",setUpPlayerIntervals_)}}.bind(this);this.playerDisposedListener=function(){this.contentEndedListeners,this.contentAndAdsEndedListeners=[],[];this.contentComplete=true;this.player.off("contentended",this.localContentEndedListener);this.player.off("timeupdate",updateStartTime_);if(this.player.ads.adTimeoutTimeout){clearTimeout(this.player.ads.adTimeoutTimeout)}var intervalsToClear=[this.updateTimeIntervalHandle,this.seekCheckIntervalHandle,this.adTrackingTimer,this.resizeCheckIntervalHandle];for(var index in intervalsToClear){var interval=intervalsToClear[index];if(interval){clearInterval(interval)}}if(this.adsManager){this.adsManager.destroy();this.adsManager=null}}.bind(this);this.initVjsControls=function(){var _this=this;var override=function(cls,obj,method,fn,always){var orig=cls.prototype[method];return obj[method]=function(){return _this.adsActive||always?fn&&fn.apply(this,arguments):orig&&orig.apply(this,arguments)}};var overrideHandler=function(cls,obj,target,event,method,fn,always){var orig=cls.prototype[method];var handler=override(cls,obj,method,fn);if(target){obj.off(target,event,orig);obj.on(target,event,handler)}else{obj.off(event,orig);obj.on(event,handler)}};var PlayToggle=videojs.getComponent("PlayToggle");var playToggle=this.vjsControls.playToggle;overrideHandler(PlayToggle,playToggle,null,["tap","click"],"handleClick",function(){onAdPlayPauseClick_();if(_this.adPlaying){this.handlePlay()}else{this.handlePause()}});override(PlayToggle,playToggle,"update",function(){var paused=_this.adsActive?!_this.adPlaying:player.paused();this.toggleClass("vjs-play-control-ad",_this.adsActive);this.toggleClass("vjs-paused",paused);this.toggleClass("vjs-playing",!paused);var text=paused?"Play":"Pause";if(text!=this.controlText())this.controlText(text)},true);overrideHandler(PlayToggle,playToggle,player,"play","handlePlay",function(){this.update()},true);overrideHandler(PlayToggle,playToggle,player,"pause","handlePause",function(){this.update()},true);var SeekBar=videojs.getComponent("SeekBar");var DvrSeekBar=videojs.getComponent("DvrSeekBar");var seekBar=this.vjsControls.progressControl.seekBar;var getPercent=function(){var duration=_this.currentAd&&_this.currentAd.getDuration();if(!duration||duration<0){return 0}var remainingTime=_this.adsManager.getRemainingTime();var currentTime=Math.max(duration-remainingTime,0);return currentTime/duration};override(SeekBar,seekBar,"getPercent",getPercent);if(DvrSeekBar){override(DvrSeekBar,seekBar,"getPercent",getPercent)}overrideHandler(SeekBar,seekBar,null,["mousedown","touchstart"],"handleMouseDown",null);overrideHandler(SeekBar,seekBar,null,"focus","handleFocus",null);
var DurationDisplay=videojs.getComponent("DurationDisplay");var durationDisplay=this.vjsControls.durationDisplay;overrideHandler(DurationDisplay,durationDisplay,player,["timeupdate","loadedmetadata"],"updateContent",function(){var duration=_this.currentAd&&_this.currentAd.getDuration();if(duration&&duration!=this.duration_){this.duration_=duration;this.contentEl_.innerHTML='<span class="vjs-control-text">'+this.localize("Duration Time")+"</span> "+formatTime(duration)}});var CurrentTimeDisplay=videojs.getComponent("CurrentTimeDisplay");var currentTimeDisplay=this.vjsControls.currentTimeDisplay;overrideHandler(CurrentTimeDisplay,currentTimeDisplay,player,["timeupdate","loadedmetadata"],"updateContent",function(){var duration=_this.currentAd&&_this.currentAd.getDuration();if(!duration){return}var time=duration-_this.adsManager.getRemainingTime();var formattedTime=formatTime(time);if(formattedTime!==this.formattedTime_){this.formattedTime_=formattedTime;this.contentEl_.innerHTML='<span class="vjs-control-text">'+this.localize("Current Time")+"</span> "+formattedTime}})}.bind(this);this.updateVjsControls=function(){if(!this.settings.vjsControls){return}this.player.toggleClass("vjs-ad-paused",this.adsActive&&!this.adPlaying);var controls=this.vjsControls;controls.playToggle.update();controls.progressControl.seekBar.update();controls.durationDisplay.updateContent();controls.currentTimeDisplay.updateContent();var duration=this.currentAd&&this.currentAd.getDuration();var display=!this.adsActive||duration&&duration>=0?"":"none";controls.durationDisplay.el().style.display=display;controls.currentTimeDisplay.el().style.display=display;controls.timeDivider.el().style.display=display}.bind(this);var getPosition=function(el){var box=el.getBoundingClientRect();var docEl=document.documentElement;var body=document.body;var clientLeft=docEl.clientLeft||body.clientLeft||0;var scrollLeft=window.pageXOffset||body.scrollLeft;var left=box.left+scrollLeft-clientLeft;var clientTop=docEl.clientTop||body.clientTop||0;var scrollTop=window.pageYOffset||body.scrollTop;var top=box.top+scrollTop-clientTop;return{left:left,top:top,width:box.width,height:box.height}};this.proxyClickEvents=function(){var events=videojs.browser.IS_ANDROID||videojs.browser.IS_IOS?["touchstart","touchend"]:["click","dblclick","mousedown","mouseup"];var player=this.player,el=player.el(),_this=this;events.forEach(function(eventName){el.addEventListener(eventName,function(e){var ad=_this.currentAd,t=e.target;if(!ad||ad.isLinear()||t.nodeName!="IFRAME"||e.isTrusted){return}var adWidth=ad.getWidth()||ad.getVastMediaWidth();var adHeight=ad.getHeight()||ad.getVastMediaHeight();var pos=getPosition(t);var touch=e.touches&&e.touches[0];var x=touch?touch.pageX:e.clientX;var y=touch?touch.pageY:e.clientY;var adRight=pos.left+pos.width-(pos.width-adWidth)/2;var adTop=pos.top+pos.height-adHeight-4;if(x<adRight&&x>adRight-40&&y>adTop&&y<adTop+30){return}if(x>pos.left+pos.width/2-15&&x<pos.left+pos.width/2+15&&y>pos.top+pos.height-15){return}var newEvent;var opt={};for(var key in e){opt[key]=e[key]}opt.bubbles=false;try{newEvent=new e.constructor(e.type,opt)}catch(err){newEvent=document.createEvent("MouseEvent");newEvent.initMouseEvent(e.type,opt.bubbles,opt.cancelable,opt.view,opt.detail,opt.screenX,opt.screenY,opt.clientX,opt.clientY,opt.ctrlKey,opt.altKey,opt.shiftKey,opt.metaKey,opt.button,null)}newEvent.stopPropagation();player.tech_.trigger(newEvent)})})}.bind(this);this.settings=extend({},ima_defaults,options||{});this.settings.adLabel=this.player.localize(this.settings.adLabel);if(!this.settings["id"]){window.console.log("Error: must provide id of video.js div");return}this.controlPrefix=this.settings.id+"_"||"";this.contentPlayer=this.player.$(".vjs-tech");this.showCountdown=true;if(this.settings["showCountdown"]==false){this.showCountdown=false}this.autoPlayAdBreaks=true;if(this.settings["autoPlayAdBreaks"]==false){this.autoPlayAdBreaks=false}var contrib_ads_defaults={debug:this.settings.debug,timeout:this.settings.timeout,prerollTimeout:this.settings.prerollTimeout};var ads_plugin_settings=extend({},contrib_ads_defaults,options["contribAdsSettings"]||{});player.ads(ads_plugin_settings);player.one("play",setUpPlayerIntervals_);player.on("contentended",this.localContentEndedListener);player.on("dispose",this.playerDisposedListener);player.on("timeupdate",updateStartTime_);this.adsRenderingSettings=new google.ima.AdsRenderingSettings;this.adsRenderingSettings.restoreCustomPlaybackStateOnAdBreakComplete=true;if(this.settings["adsRenderingSettings"]){for(var setting in this.settings["adsRenderingSettings"]){this.adsRenderingSettings[setting]=this.settings["adsRenderingSettings"][setting]}}if(this.settings["locale"]){google.ima.settings.setLocale(this.settings["locale"])}createAdContainer_();this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer);this.adsLoader.getSettings().setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED);if(this.settings.vpaidAllowed==false){this.adsLoader.getSettings().setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.DISABLED)}if(this.settings.vpaidMode){this.adsLoader.getSettings().setVpaidMode(this.settings.vpaidMode)}if(this.settings.locale){this.adsLoader.getSettings().setLocale(this.settings.locale)}if(this.settings.numRedirects){this.adsLoader.getSettings().setNumRedirects(this.settings.numRedirects)}this.adsLoader.getSettings().setPlayerType("videojs-ima");this.adsLoader.getSettings().setPlayerVersion(this.VERSION);this.adsLoader.getSettings().setAutoPlayAdBreaks(this.autoPlayAdBreaks);this.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,onAdsManagerLoaded_,false);this.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,onAdsLoaderError_,false);if(!readyCallback){readyCallback=this.startFromReadyCallback}player.on("readyforpreroll",readyCallback);player.ready(function(){player.on("fullscreenchange",onFullscreenChange_);player.on("volumechange",onVolumeChange_)});this.proxyClickEvents()};videojs.plugin("ima",init)})}).call(window)}])});